angular.module("ticketSystem",["ngRoute","textAngular","yangular-grid","yg-modal","ngFlash","ui.router","yg-notification"]).service("authInterceptor",["$q","$injector","Authentication","HelperFactory",function(t,e,r,l){return{request:function(t){return l.setLoading(!0),t},response:function(e){return l.setLoading(!1),401===e.status&&r.clearUser(),e||t.when(e)},responseError:function(s){return l.setLoading(!1),401===s.status&&(r.clearUser(),e.get("$state").go("users-login.login")),403===s.status&&e.get("$state").go("ticket.my-tickets"),t.reject(s)}}}]).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(t,e,r){r.otherwise("/ticket/my-tickets"),e.state("ticket",{url:"/ticket",controller:"TicketsCtrl",templateUrl:"templates/tickets/tickets.html"}).state("ticket.my-tickets",{url:"/my-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-my-tickets.html"}).state("ticket.to-me-tickets",{url:"/tome-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-tome-tickets.html"}).state("ticket.all-tickets",{url:"/all-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-all-tickets.html"}).state("dashboard",{url:"/ticket/dashboard",controller:"DashboardCtrl",templateUrl:"templates/tickets/dashboard.html"}).state("ticket-new",{url:"/ticket/new",controller:"NewTicketCtrl",templateUrl:"templates/tickets/new-ticket.html"}).state("ticket-view",{url:"/ticket/view/:id",controller:"ViewTicketCtrl",templateUrl:"templates/tickets/view-ticket.html"}).state("ticket-edit",{url:"/ticket/edit/:id",controller:"EditTicketCtrl",templateUrl:"templates/tickets/edit-ticket.html"}).state("users-login",{url:"/users",controller:"MainLoginCtrl",templateUrl:"templates/users/user-login.html"}).state("users-login.login",{url:"/login",controller:"LoginCtrl",templateUrl:"templates/users/login.html"}).state("users-login.register",{url:"/register",controller:"RegisterCtrl",templateUrl:"templates/users/register.html"}).state("users-profile",{url:"/users/profile",controller:"ProfileCtrl",templateUrl:"templates/users/profile.html"}).state("change-password",{url:"/users/profile/change-password/:id",controller:"ChangePasswordCtrl",templateUrl:"templates/users/change-password.html"}).state("users-register",{url:"/users/register",controller:"RegisterCtrl",templateUrl:"templates/users/register.html"}).state("admin-user-management",{url:"/admin/user-management",controller:"UsersListCtrl",templateUrl:"templates/admin/manage-users.html"}).state("auth-google",{url:"/auth/google/:id/:email",controller:"SetUserCtrl",templateUrl:"templates/users/set-username.html"}).state("admin-edit",{url:"/admin/edit/:username",controller:"EditUsersCtrl",templateUrl:"templates/admin/edit-user.html"}).state("admin-reset-password",{url:"/admin/reset-password/:id",controller:"ChangeUsersPasswordCtrl",templateUrl:"templates/admin/reset-password.html"}),t.interceptors.push("authInterceptor")}]);
angular.module("ticketSystem").directive("ygToggle",function(){return{restrict:"E",scope:{toggle:"="},replace:!0,template:'<div ng-show="loaded" class="toggle-button"><div class="toggle"></div></div>',link:function(e,t,i){var l=function(i){e.loaded=!0,i?t.addClass("is-active"):t.removeClass("is-active")};e.$watch("toggle.value",function(e,t){"undefined"!=typeof e&&l(e)}),t.on("click",function(){e.toggle.value=!e.toggle.value,l(e.toggle.value)})}}}).directive("ygSpinner",["HelperFactory",function(e){return{restrict:"E",template:'<div class="loading" ng-show="loading()"></div>',scope:{},link:function(t,i,l,n){t.loading=e.getLoading}}}]);
angular.module("ticketSystem").factory("TicketFactory",["$http",function(t){var e={};return e.createNewTicket=function(e){return t.post("tickets/new",e)},e.updateTicket=function(e,i){return t.put("tickets/"+e,i)},e.getTicketById=function(e){return t.get("tickets/"+e)},e.getInitialTicketData=function(e){return t.get("tickets/edit-ticket/initial-load/"+e)},e.getDashboardData=function(){return t.get("admin/dashboard")},e}]);
angular.module("ticketSystem").factory("CommonFactory",["$http",function(t){var e={};return e.getInitialStaticData=function(){return t.get("tickets/static-data")},e}]).filter("reverse",function(){return function(t){if(t)return t.slice().reverse()}});
angular.module("ticketSystem").factory("UserFactory",["$http",function(e){var t={};return t.login=function(t,r,n){return e.post("accounts/login",{username:t,password:r,remember:n})},t.logout=function(){return e.get("accounts/logout")},t.registerUser=function(t){return e.post("accounts/register",t)},t.getUserByUsername=function(t){return e.get("users/profile/"+t)},t.updateProfile=function(t){return e.post("users/profile/"+t.username,t)},t.setUsername=function(t){return e.post("accounts/set-username",t)},t.changePassword=function(t,r){return e.post("users/profile/change-password/"+t,r)},t.getAllUserDetails=function(){return e.get("admin/users-details")},t.getUserDetails=function(t){return e.get("admin/user-details/"+t)},t.updateUserDetails=function(t,r){return e.post("admin/update-user/"+t,r)},t.resetPassword=function(t,r){return e.post("admin/reset-password/"+t,r)},t}]);
angular.module("ticketSystem").factory("Authentication",function(){var t={};return t.getIsAuthenticated=function(){if(localStorage.getItem("ticketSystemUser"))return!0},t.setUser=function(t){localStorage.setItem("ticketSystemUser",JSON.stringify(t))},t.clearUser=function(){localStorage.removeItem("ticketSystemUser")},t.getUser=function(){return JSON.parse(localStorage.getItem("ticketSystemUser"))},t});
angular.module("ticketSystem").factory("HelperFactory",["Authentication",function(r){var e={},n={};return n.loading=!1,e.createFlashMessage=function(r,e){return r.data.errors?r.data.errors.map(function(r){return{message:r.error,class:"danger"}}):e?[{message:e,class:"success"}]:[]},e.getAllUsersButSelf=function(e){var n=r.getUser().username;return e.filter(function(r){return r.username!==n})},e.removeUserFromUsers=function(r,e){return r.filter(function(r){var n=e.indexOf(r.username)===-1;return n})},e.isCurrentUserAdmin=function(){var e=r.getUser();return e.role.indexOf("Admin")>-1},e.isCurrentUserSupport=function(){var e=r.getUser();return e.role.indexOf("Support")>-1},e.isCurrentUserAdminOrSupport=function(){return e.isCurrentUserAdmin()||e.isCurrentUserAdmin()},e.stripHtml=function(r){return r?String(r).replace(/<[^>]+>/gm,""):""},e.getLoading=function(){return n.loading},e.setLoading=function(r){n.loading=r},e}]);
angular.module("ticketSystem").factory("ActionFactory",["$http","$q",function(t,e){var n,o={};return o.setTask=function(t){n=t},o.getTask=function(){return n},o.getAssignees=function(){return t.get("static/all-users")},o.getAllowedStatus=function(e){return t.get("static/allowed-status/"+e)},o.getAllowedButtons=function(n){var o=e.defer();return t.get("static/action-buttons/"+n).then(function(t){var e={};e.assign=t.data.actionButtons.assign,e.comment=t.data.actionButtons.comment,e.changeStatus=t.data.actionButtons.changeStatus,e.reopen=t.data.actionButtons.reopen,e.close=t.data.actionButtons.close,e.acknowledge=t.data.actionButtons.acknowledge,e.awaitingUserResponse=t.data.actionButtons.awaitingUserResponse,e.assignToSelf=t.data.actionButtons.assignToSelf,o.resolve(e)}).catch(function(t){o.reject(t)}),o.promise},o.assign=function(e,n,o){return t.post("tickets/assign/"+e,{assignee:n,comment:o})},o.changeStatus=function(e,n,o){return t.post("tickets/change-status/"+e,{status:n,comment:o})},o.awaitingUserResponse=function(e,n){return t.post("tickets/awaiting-user-response/"+e,{comment:n})},o.reopen=function(e,n){return t.post("tickets/re-open/"+e,{comment:n})},o.close=function(e,n){return t.post("tickets/close/"+e,{comment:n})},o.addComment=function(e,n){return t.post("tickets/addComment/"+e,{comment:n})},o.deleteComment=function(e,n){return t.delete("tickets/deleteComment/"+e._id+"?commentId="+n._id)},o.acknowledgeTicket=function(e,n){return t.post("tickets/acknowledge/"+e,{comment:n})},o}]);
angular.module("ticketSystem").controller("MainCtrl",["$scope","$state","Authentication","UserFactory","$window","YgNotify","HelperFactory",function(e,t,i,n,o,r,s){var g=function(){var t=i.getUser();t.role.indexOf("Admin")>-1?e.isAdmin=!0:e.isAdmin=!1,e.isRegularUser=!0,(i.getUser().role.indexOf("Support")>-1||i.getUser().role.indexOf("Admin")>-1)&&(e.isRegularUser=!1)};e.init=function(){var t=i.getUser();t&&(t.role.indexOf("Admin")>-1?e.isAdmin=!0:e.isAdmin=!1)},e.getUser=i.getUser,e.isAuthenticated=i.getIsAuthenticated,e.logout=function(){n.logout().then(function(){i.clearUser(),t.go("users-login.login")})},e.$on("successful-login",g),e.getProfile=function(){t.go("users-profile")},o.app={},o.app.auth=function(e,n){""!==e?r.alert("danger",e.toString(),5e3):n.username&&""!==n.username?n&&(i.setUser(n),g(),t.go("ticket.my-tickets")):t.go("auth-google",{id:n._id.toString(),email:n.email})}}]);
angular.module("ticketSystem").controller("NavCtrl",["$scope",function(a){a.navClass="",a.toggleNav=function(s){var e=angular.element(s.target);e.hasClass("is-open")?a.navClass="is-close":a.navClass="is-open"},a.navClick=function(s){a.navClass="a"===s.target.tagName.toLowerCase()?"is-close":a.navClass}}]);
angular.module("ticketSystem").controller("UsersListCtrl",["$scope","$state","$stateParams","HelperFactory","YgNotify",function(e,s,a,r,t){var i=function(){return""},n=function(e){return e===!0?"fa fa-check":"fa fa-remove"},o=function(){return""},c=function(e){return e.indexOf("Admin")>-1?"fa fa-check":"fa fa-remove"};e.config={},e.config.url="/admin/users-details",e.config.columns=[],e.config.columns.push({key:"username",name:"Username",cssClass:"col-md-6"}),e.config.columns.push({key:"isActive",name:"Is Active",cssClass:"col-md-3",render:i,renderClass:n}),e.config.columns.push({key:"role",name:"Is Admin",cssClass:"col-md-3",render:o,renderClass:c}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.objectName="users",e.config.onRowClick=function(e){s.go("admin-edit",{username:e.username})}}]).controller("EditUsersCtrl",["$scope","$state","$stateParams","HelperFactory","UserFactory","YgNotify",function(e,s,a,r,t,i){e.isActive={},e.isAdmin={},e.userDetails={};var n=a.username;t.getUserDetails(n).then(function(s){e.userDetails.username=s.data.user.username,e.userDetails.firstname=s.data.user.firstname,e.userDetails.lastname=s.data.user.lastname,e.userDetails.id=s.data.user._id;var a=s.data.user.role;a.indexOf("Admin")>-1?e.userDetails.isAdmin=!0:e.userDetails.isAdmin=!1,e.userDetails.isActive=s.data.user.isActive,e.userDetails.email=s.data.user.email,e.isActive.key="isActive",e.isActive.value=e.userDetails.isActive,e.isAdmin.key="isAdmin",e.isAdmin.value=e.userDetails.isAdmin}).catch(function(e){i.alert("danger","There was some error trying to fetch user details. Please try again after some time.",5e3)}),e.userDetails.update=function(){return e.editUserForm.$invalid?(e.editUserForm.firstname.$touched=!0,e.editUserForm.lastname.$touched=!0,void(e.editUserForm.email.$touched=!0)):(e.userDetails.isAdmin=e.isAdmin.value,e.userDetails.isActive=e.isActive.value,void t.updateUserDetails(e.userDetails.username,e.userDetails).then(function(e){r.createFlashMessage(e,"User details updated successfully").forEach(function(e){i.alert(e.class,e.message,5e3)})}).catch(function(e){i.alert("danger","There was some error trying to update user details. Please try again after some time.",5e3)}))}}]).controller("ChangeUsersPasswordCtrl",["$scope","$state","$stateParams","HelperFactory","UserFactory","YgNotify",function(e,s,a,r,t,i){e.changePassword={},e.changePassword.title="Reset Password",e.changePassword.saveTitle="Reset",e.changePassword.cancelHref="#/admin/user-management",e.changePassword.save=function(s){if(s.$invalid)return s.password2.$touched=!0,void(s.password1.$touched=!0);var n=a.id;t.resetPassword(n,e.changePassword).then(function(e){r.createFlashMessage(e,"Password has been reset successfully").forEach(function(e){i.alert(e.class,e.message,5e3)})}).catch(function(e){i.alert("danger","The request could not ben made successfully. Please try later",5e3)})}}]);
angular.module("ticketSystem").controller("DashboardCtrl",["$scope","$state","YgNotify","TicketFactory",function(e,n,s,t){var o=function(e){return new Date(Date.parse(e)).toLocaleDateString()},c=function(e){return e?String(e).replace(/<[^>]+>/gm,""):""},i=function(e){return e?e:"Unassigned"};e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:c}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"assignee",name:"Assignee",cssClass:"col-md-2",render:i}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:o}),e.config.columns.push({key:"createdBy",name:"Created By",cssClass:"col-md-2"}),e.config.url="/admin/open-within-day",e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){n.go("ticket-view",{id:e.id})},e.config.objectName="tickets",t.getDashboardData().then(function(n){var s=n.data.tickets;e.new={},e.open={},e.inProgress={},e.awaitingUserResponse={},e.new.ticket=s.new.ticket,e.new.count=s.new.count,e.open.ticket=s.open.ticket,e.open.count=s.open.count,e.inProgress.ticket=s.inProgress.ticket,e.inProgress.count=s.inProgress.count,e.awaitingUserResponse.ticket=s.awaitingUserResponse.ticket,e.awaitingUserResponse.count=s.awaitingUserResponse.count}).catch(function(e){s.alert("danger","An error occurred while trying to fetch the dashboard data. Please try again later.",5e3)})}]);
angular.module("ticketSystem").controller("DeleteCommentCtrl",["$scope","YgNotify","HelperFactory","YgModal","ActionFactory",function(e,t,n,o,r){var c=function(o,c){return function(){r.deleteComment(o,c).then(function(o){n.createFlashMessage(o,"The comment was deleted successfully").forEach(function(e){t.alert(e.class,e.message,5e3)}),o.data.errors||(e.ticket.comments=o.data.comments)}).catch(function(e){t.alert("danger","An error occurred while trying to delete comment. Please try again later.",5e3)})}};e.deleteComment=function(e,t){o.confirm(c(e,t)),o.open("Are you sure you want to do this?","This will delete the comment permanently")}}]);
angular.module("ticketSystem").controller("EditTicketCtrl",["$scope","$stateParams","$state","TicketFactory","YgNotify","HelperFactory","Authentication",function(t,e,a,r,i,c,n){t.toolbarConfig=[["h1","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],[],["insertLink"]],t.cancel=function(){a.go("ticket-view",{id:t.ticket.id})},t.renderDate=function(t){return new Date(Date.parse(t)).toLocaleDateString()},r.getTicketById(e.id).then(function(e){if(e.data.errors){a.go("ticket.my-tickets");var o=c.createErrorMessage(e.data.errors);o.forEach(function(t){i.alert("danger",t,5e3)})}else t.ticket=e.data.ticket,t.ticket.currentUser=n.getUser().username,r.getInitialTicketData(t.ticket.status).then(function(e){t.priorities=e.data.priorities.values,t.types=e.data.types.values,t.users=e.data.users,t.statuses=e.data.statuses}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to fetch the static data.",5e3)})}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to get ticket details. Please try again later.",5e3)}),t.update=function(){r.updateTicket(t.ticket._id,t.ticket).then(function(e){t.ticket=e.data,i.alert("success","Ticket updated successfully.",5e3),a.go("ticket-view",{id:e.data.id})}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to update ticket details. Please try again later.",5e3)})}}]);
angular.module("ticketSystem").controller("NewTicketCtrl",["$scope","$state","TicketFactory","YgNotify","CommonFactory","HelperFactory",function(e,t,i,c,n,o){n.getInitialStaticData().then(function(t){e.newTicket.types=t.data.types.values,e.newTicket.type=e.newTicket.types[0].value}),e.newTicket={},e.toolbarConfig=[["h1","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],[],["insertLink"]],e.save=function(){return e.newTicketForm.$invalid?(e.newTicketForm.title.$touched=!0,void(e.newTicketForm.description.$touched=!0)):void i.createNewTicket({title:e.newTicket.title,description:e.newTicket.description,type:e.newTicket.type}).then(function(e){o.createFlashMessage(e,"The ticket has been created successfully").forEach(function(e){c.alert(e.class,e.message,5e3)}),e.data.id&&t.go("ticket-view",{id:e.data.id})},function(e){c.alert("danger","An error occurred while trying to create new ticket. Please try again later.",5e3),console.log(e)})}}]);

angular.module("ticketSystem").controller("TicketsCtrl",["$scope","$state","agSortFactory","HelperFactory",function(e,t,n,i){e.isSupport=!1;var c=JSON.parse(localStorage.getItem("ticketSystemUser"));c&&(c.role.indexOf("Admin")>-1||c.role.indexOf("Support")>-1)&&(e.isSupport=!0);var s=function(e){return new Date(Date.parse(e)).toLocaleDateString()},o=function(e){return e?String(e).replace(/<[^>]+>/gm,""):""},r=function(e){return e?e:"Unassigned"};e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:o}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"assignee",name:"Assignee",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:s}),e.config.columns.push({key:"createdBy",name:"Created By",cssClass:"col-md-2"}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){t.go("ticket-view",{id:e.id})},e.config.objectName="tickets",e.initiateAllTicket=function(){e.config.url="/tickets/all",e.$parent.active="all"},e.initiateMyTicket=function(){e.config.url="/tickets/my",e.$parent.active="my"},e.initiateToMeTicket=function(){e.config.url="/tickets/to-me",e.$parent.active="tome"}}]);
angular.module("ticketSystem").controller("ViewTicketCtrl",["$scope","$stateParams","$state","TicketFactory","YgNotify","Authentication","HelperFactory",function(e,t,r,i,n,s,a){function c(e,t){switch(e=e||"",t.success=t.success||"",t.warning=t.warning||"",t.danger=t.danger||"",t.info=t.info||"",e.toLowerCase()){case t.success.toLowerCase():return"success";case t.warning.toLowerCase():return"warning";case t.danger.toLowerCase():return"danger";case t.info.toLowerCase():return"info";default:return"info"}}function o(e){return c(e,{success:"in-progress",warning:"open",info:"new",danger:"resolved"})}function u(e){return c(e,{success:"low",warning:"medium",danger:"high"})}function d(e){return e.assignee===e.currentUser||(e.createdBy===e.currentUser||(!!a.isCurrentUserAdmin()||!!a.isCurrentUserSupport()))}i.getTicketById(t.id).then(function(t){a.createFlashMessage(t).forEach(function(e){n.alert(e.class,e.message,5e3)}),t.data.errors||(e.ticket=t.data.ticket,e.ticket.description=a.stripHtml(e.ticket.description),e.ticket.assignee=e.ticket.assignee?e.ticket.assignee:"Unassigned",e.ticket.createdDate=e.renderDate(e.ticket.createdDate),e.ticket.currentUser=s.getUser().username,e.statusClass=o(e.ticket.status),e.ticket.priority=e.ticket.priority||"N.A",e.priorityClass=u(e.ticket.priority),d(e.ticket)&&(e.showEdit=!0))}).catch(function(e){n.alert("danger","An error occurred while trying to get ticket details. Please try again later.",5e3)}),e.ticket={},e.edit=function(){r.go("ticket-edit",{id:e.ticket.id})},e.renderDate=function(e){return new Date(Date.parse(e)).toLocaleDateString()}}]);
angular.module("ticketSystem").controller("ChangePasswordCtrl",["$scope","$state","$stateParams","UserFactory","HelperFactory","YgNotify",function(e,s,a,r,o,t){e.changePassword={},e.changePassword.title="Change Password",e.changePassword.saveTitle="Change Password",e.changePassword.cancelHref="#/users/profile",e.changePassword.save=function(c){if(c.$invalid)return c.password2.$touched=!0,void(c.password1.$touched=!0);var n=a.id;r.changePassword(n,e.changePassword).then(function(e){o.createFlashMessage(e,"The password has been changed successfully").forEach(function(e){t.alert(e.class,e.message,5e3)}),e.data.errors||s.go("users-profile")}).catch(function(e){t.alert("danger","The request could not ben made successfully. Please try later",5e3)})}}]);
angular.module("ticketSystem").controller("LoginCtrl",["$scope","$state","$window","UserFactory","Authentication","HelperFactory",function(e,t,o,r,i,n){i.getUser()&&t.go("ticket.my-tickets"),e.error=!1,e.message="",e.login=function(){r.login(e.username,e.password,e.remember).then(function(o){o.data.isAuthenticated?(i.setUser(o.data.user),e.$emit("successful-login"),n.isCurrentUserAdmin()?t.go("dashboard"):t.go("ticket.my-tickets")):(e.error=!0,e.message=o.data.msg)}).catch(function(t){e.error=!0,e.message="An error occurred while trying to log you in. Please try again later"})},e.googleLogin=function(){var e="accounts/auth/google",t=600,r=450,i=(window.outerHeight-r)/2,n=(window.outerWidth-t)/2;o.open(e,"facebook_login","width="+t+",height="+r+",scrollbars=0,top="+i+",left="+n)}}]);
angular.module("ticketSystem").controller("MainLoginCtrl",["$rootScope","$scope","$state",function(t,e,n){e.statename=n.current.name,t.$on("$stateChangeStart",function(t,n,a,o,r){e.statename=n.name})}]);
angular.module("ticketSystem").controller("ProfileCtrl",["$scope","$state","Authentication","UserFactory","HelperFactory","YgNotify",function(e,a,r,s,t,u){e.user={},e.init=function(){s.getUserByUsername(r.getUser().username).then(function(a){t.createFlashMessage(a).forEach(function(e){u.alert(e.class,e.message,5e3)}),a.data.errors||(e.user.firstname=a.data.user.firstname,e.user.lastname=a.data.user.lastname,e.user.username=a.data.user.username,e.user.email=a.data.user.email,e.user.userId=a.data.user._id)})},e.update=function(){return e.profileForm.$invalid?(e.profileForm.firstname.$touched=!0,e.profileForm.lastname.$touched=!0,void(e.profileForm.email.$touched=!0)):(t.setLoading(!0),void s.updateProfile(e.user).then(function(a){t.createFlashMessage(a,"User details have been updated successfully").forEach(function(e){u.alert(e.class,e.message,5e3)}),a.data.errors||(e.user.firstname=a.data.user.firstname,e.user.lastname=a.data.user.lastname,e.user.username=a.data.user.username,e.user.email=a.data.user.email,e.user.role=a.data.user.role,r.setUser(e.user))}).catch(function(e){u.alert("danger","There was some error trying to update user details. Please try again after some time.",5e3)}))}}]);
angular.module("ticketSystem").controller("RegisterCtrl",["$scope","$state","UserFactory","HelperFactory","YgNotify",function(e,r,t,s,a){e.newUser={},e.register=function(){t.registerUser(e.newUser).then(function(e){s.createFlashMessage(e,"User has been created successfully. You can now login.").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.data.errors&&r.go("users-login.login")}).catch(function(e){a.alert("danger","There was some error trying to create the user. Please try again after some time.",5e3)})}}]);
angular.module("ticketSystem").controller("SetUserCtrl",["$scope","$stateParams","$state","UserFactory","YgNotify","Authentication",function(e,s,t,a,r,n){var c=s.id,o=s.email;e.setUsername={},e.setUsername.email=o,e.saveUsername=function(){a.setUsername({id:c,username:e.setUsername.username}).then(function(s){HelperFactory.createFlashMessage(s,"Username has been set successfully.").forEach(function(e){r.alert(e.class,e.message,5e3)}),s.data.errors||(n.setUser(s.data.user),e.$emit("successful-login"),t.go("ticket.my-tickets"))}).catch(function(e){r.alert("danger","There was some error trying to set the username. Please try again after some time.",5e3)})}}]);
angular.module("ticketSystem").controller("ActionsCtrl",["$scope","ActionFactory","HelperFactory","$rootScope",function(e,t,a,s){e.getTask=t.getTask,e.task={},e.task.showTaskPanel=!1,e.task.showMainPanel=!1,t.setTask(null),e.setSaveFn=function(t){e.saveTask=t},e.cancelTask=function(){t.setTask(null),e.task.comment="",e.task.showTaskPanel=!1,e.task.showMainPanel=!1},e.setSaveBtnName=function(t){e.saveBtnName=t},e.$watch("getTask()",function(t,a){if(e.task.name=null,t)switch(e.task.showTaskPanel=!0,e.task.showMainPanel=!0,e.task.name="templates/partials/action/"+t+"-action-partial.html",t){case"comment":e.task.title="Add new comment";break;case"awaitingusersresponse":e.task.title="Awaiting users response";break;case"close":e.task.title="Close ticket";break;case"reopen":e.task.title="Reopen ticket";break;case"acknowledge":e.task.title="Acknowledge ticket";break;case"assign":e.task.title="Assign ticket";break;case"changestatus":e.task.title="Change ticket status";break;case"assigntoself":e.task.title="Assign to self"}})}]).controller("AssignActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){console.log("set assignee"),t.getAssignees().then(function(t){e.users=t.data.users,e.users=s.removeUserFromUsers(e.users,[e.ticket.createdBy,e.ticket.assignee]),e.assignee=e.users[0].username}),e.setSaveFn(function(){return e.actionForm.comment.$invalid||e.actionForm.assignee.$invalid?(e.actionForm.comment.$touched=!0,void(e.actionForm.assignee.$touched=!0)):void t.assign(e.ticket.id,e.assignee,e.task.comment).then(function(t){s.createFlashMessage(t,"The assignee has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.assignee=t.data.assignee),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to assign the ticket. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Assign Ticket")}]).controller("ChangeStatusActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){var n=e.ticket.status;t.getAllowedStatus(n).then(function(t){console.log(t.data),e.allowedStatus=t.data.status.allowed,e.newStatus=e.allowedStatus[0]}),e.setSaveFn(function(){return e.actionForm.comment.$invalid||e.actionForm.newStatus.$invalid?(e.actionForm.comment.$touched=!0,void(e.actionForm.newStatus.$touched=!0)):void t.changeStatus(e.ticket.id,e.newStatus,e.task.comment).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Change Status")}]).controller("CommentActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.addComment(e.ticket.id,e.task.comment).then(function(t){e.ticket.comments=t.data.comments,s.createFlashMessage(t,"The comment has been added successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to add comment. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Add Comment")}]).controller("CloseActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.close(e.ticket.id,e.task.comment).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Close")}]).controller("ReopenActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.reopen(e.ticket.id,e.task.comment).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Reopen")}]).controller("AwaitingActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.awaitingUserResponse(e.ticket.id,e.task.comment).then(function(t){s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.status=t.data.status),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Change Status")}]).controller("AcknowledgeActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.acknowledgeTicket(e.ticket.id,e.task.comment).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Acknowledge Ticket")}]).controller("AssignToSelfActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory","Authentication",function(e,t,a,s,n){e.setSaveFn(function(){if(e.actionForm.comment.$invalid)return void(e.actionForm.comment.$touched=!0);var c=n.getUser();console.log(c),t.assign(e.ticket.id,c.username,e.task.comment).then(function(t){s.createFlashMessage(t,"The assignee has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.assignee=t.data.assignee),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to assign the ticket. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Assign To Self")}]);
angular.module("ticketSystem").controller("ButtonGroupCtrl",["$scope","ActionFactory","HelperFactory",function(o,t,n){o.buttongroup={},o.$watchCollection("ticket",function(s){s&&s.id&&(n.isCurrentUserAdminOrSupport()?t.getAllowedButtons(s.id).then(function(t){o.buttongroup.showAssign=t.assign,o.buttongroup.showComment=t.comment,o.buttongroup.showchangeStatus=t.changeStatus,o.buttongroup.showReopen=t.reopen,o.buttongroup.showClose=t.close,o.buttongroup.showAcknowledge=t.acknowledge,o.buttongroup.showAwaitingUsersResponse=t.awaitingUserResponse,o.buttongroup.showAssignToSelf=t.assignToSelf}):(o.buttongroup.showAssign=!1,o.buttongroup.showComment=!1,o.buttongroup.showchangeStatus=!1,o.buttongroup.showReopen=!1,o.buttongroup.showClose=!1,o.buttongroup.showAcknowledge=!1,o.buttongroup.showAwaitingUsersResponse=!1,o.buttongroup.showAssignToSelf=!1))}),o.buttongroup.comment=function(){t.setTask("comment")},o.buttongroup.assign=function(){t.setTask("assign")},o.buttongroup.changeStatus=function(){t.setTask("changestatus")},o.buttongroup.close=function(){t.setTask("close")},o.buttongroup.reopen=function(){t.setTask("reopen")},o.buttongroup.acknowledge=function(){t.setTask("acknowledge")},o.buttongroup.awaitingusersresponse=function(){t.setTask("awaitingusersresponse")},o.buttongroup.assignToSelf=function(){t.setTask("assigntoself")}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiLFtcIm5nUm91dGVcIixcInRleHRBbmd1bGFyXCIsXCJ5YW5ndWxhci1ncmlkXCIsXCJ5Zy1tb2RhbFwiLFwibmdGbGFzaFwiLFwidWkucm91dGVyXCIsXCJ5Zy1ub3RpZmljYXRpb25cIl0pLnNlcnZpY2UoXCJhdXRoSW50ZXJjZXB0b3JcIixbXCIkcVwiLFwiJGluamVjdG9yXCIsXCJBdXRoZW50aWNhdGlvblwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKHQsZSxyLGwpe3JldHVybntyZXF1ZXN0OmZ1bmN0aW9uKHQpe3JldHVybiBsLnNldExvYWRpbmcoITApLHR9LHJlc3BvbnNlOmZ1bmN0aW9uKGUpe3JldHVybiBsLnNldExvYWRpbmcoITEpLDQwMT09PWUuc3RhdHVzJiZyLmNsZWFyVXNlcigpLGV8fHQud2hlbihlKX0scmVzcG9uc2VFcnJvcjpmdW5jdGlvbihzKXtyZXR1cm4gbC5zZXRMb2FkaW5nKCExKSw0MDE9PT1zLnN0YXR1cyYmKHIuY2xlYXJVc2VyKCksZS5nZXQoXCIkc3RhdGVcIikuZ28oXCJ1c2Vycy1sb2dpbi5sb2dpblwiKSksNDAzPT09cy5zdGF0dXMmJmUuZ2V0KFwiJHN0YXRlXCIpLmdvKFwidGlja2V0Lm15LXRpY2tldHNcIiksdC5yZWplY3Qocyl9fX1dKS5jb25maWcoW1wiJGh0dHBQcm92aWRlclwiLFwiJHN0YXRlUHJvdmlkZXJcIixcIiR1cmxSb3V0ZXJQcm92aWRlclwiLGZ1bmN0aW9uKHQsZSxyKXtyLm90aGVyd2lzZShcIi90aWNrZXQvbXktdGlja2V0c1wiKSxlLnN0YXRlKFwidGlja2V0XCIse3VybDpcIi90aWNrZXRcIixjb250cm9sbGVyOlwiVGlja2V0c0N0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL3RpY2tldHMuaHRtbFwifSkuc3RhdGUoXCJ0aWNrZXQubXktdGlja2V0c1wiLHt1cmw6XCIvbXktdGlja2V0c1wiLGNvbnRyb2xsZXI6XCJUaWNrZXRzQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvdmlldy1teS10aWNrZXRzLmh0bWxcIn0pLnN0YXRlKFwidGlja2V0LnRvLW1lLXRpY2tldHNcIix7dXJsOlwiL3RvbWUtdGlja2V0c1wiLGNvbnRyb2xsZXI6XCJUaWNrZXRzQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvdmlldy10b21lLXRpY2tldHMuaHRtbFwifSkuc3RhdGUoXCJ0aWNrZXQuYWxsLXRpY2tldHNcIix7dXJsOlwiL2FsbC10aWNrZXRzXCIsY29udHJvbGxlcjpcIlRpY2tldHNDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy92aWV3LWFsbC10aWNrZXRzLmh0bWxcIn0pLnN0YXRlKFwiZGFzaGJvYXJkXCIse3VybDpcIi90aWNrZXQvZGFzaGJvYXJkXCIsY29udHJvbGxlcjpcIkRhc2hib2FyZEN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL2Rhc2hib2FyZC5odG1sXCJ9KS5zdGF0ZShcInRpY2tldC1uZXdcIix7dXJsOlwiL3RpY2tldC9uZXdcIixjb250cm9sbGVyOlwiTmV3VGlja2V0Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvbmV3LXRpY2tldC5odG1sXCJ9KS5zdGF0ZShcInRpY2tldC12aWV3XCIse3VybDpcIi90aWNrZXQvdmlldy86aWRcIixjb250cm9sbGVyOlwiVmlld1RpY2tldEN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL3ZpZXctdGlja2V0Lmh0bWxcIn0pLnN0YXRlKFwidGlja2V0LWVkaXRcIix7dXJsOlwiL3RpY2tldC9lZGl0LzppZFwiLGNvbnRyb2xsZXI6XCJFZGl0VGlja2V0Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvZWRpdC10aWNrZXQuaHRtbFwifSkuc3RhdGUoXCJ1c2Vycy1sb2dpblwiLHt1cmw6XCIvdXNlcnNcIixjb250cm9sbGVyOlwiTWFpbkxvZ2luQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3VzZXJzL3VzZXItbG9naW4uaHRtbFwifSkuc3RhdGUoXCJ1c2Vycy1sb2dpbi5sb2dpblwiLHt1cmw6XCIvbG9naW5cIixjb250cm9sbGVyOlwiTG9naW5DdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvbG9naW4uaHRtbFwifSkuc3RhdGUoXCJ1c2Vycy1sb2dpbi5yZWdpc3RlclwiLHt1cmw6XCIvcmVnaXN0ZXJcIixjb250cm9sbGVyOlwiUmVnaXN0ZXJDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvcmVnaXN0ZXIuaHRtbFwifSkuc3RhdGUoXCJ1c2Vycy1wcm9maWxlXCIse3VybDpcIi91c2Vycy9wcm9maWxlXCIsY29udHJvbGxlcjpcIlByb2ZpbGVDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvcHJvZmlsZS5odG1sXCJ9KS5zdGF0ZShcImNoYW5nZS1wYXNzd29yZFwiLHt1cmw6XCIvdXNlcnMvcHJvZmlsZS9jaGFuZ2UtcGFzc3dvcmQvOmlkXCIsY29udHJvbGxlcjpcIkNoYW5nZVBhc3N3b3JkQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3VzZXJzL2NoYW5nZS1wYXNzd29yZC5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLXJlZ2lzdGVyXCIse3VybDpcIi91c2Vycy9yZWdpc3RlclwiLGNvbnRyb2xsZXI6XCJSZWdpc3RlckN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9yZWdpc3Rlci5odG1sXCJ9KS5zdGF0ZShcImFkbWluLXVzZXItbWFuYWdlbWVudFwiLHt1cmw6XCIvYWRtaW4vdXNlci1tYW5hZ2VtZW50XCIsY29udHJvbGxlcjpcIlVzZXJzTGlzdEN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy9hZG1pbi9tYW5hZ2UtdXNlcnMuaHRtbFwifSkuc3RhdGUoXCJhdXRoLWdvb2dsZVwiLHt1cmw6XCIvYXV0aC9nb29nbGUvOmlkLzplbWFpbFwiLGNvbnRyb2xsZXI6XCJTZXRVc2VyQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3VzZXJzL3NldC11c2VybmFtZS5odG1sXCJ9KS5zdGF0ZShcImFkbWluLWVkaXRcIix7dXJsOlwiL2FkbWluL2VkaXQvOnVzZXJuYW1lXCIsY29udHJvbGxlcjpcIkVkaXRVc2Vyc0N0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy9hZG1pbi9lZGl0LXVzZXIuaHRtbFwifSkuc3RhdGUoXCJhZG1pbi1yZXNldC1wYXNzd29yZFwiLHt1cmw6XCIvYWRtaW4vcmVzZXQtcGFzc3dvcmQvOmlkXCIsY29udHJvbGxlcjpcIkNoYW5nZVVzZXJzUGFzc3dvcmRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvYWRtaW4vcmVzZXQtcGFzc3dvcmQuaHRtbFwifSksdC5pbnRlcmNlcHRvcnMucHVzaChcImF1dGhJbnRlcmNlcHRvclwiKX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmRpcmVjdGl2ZShcInlnVG9nZ2xlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsc2NvcGU6e3RvZ2dsZTpcIj1cIn0scmVwbGFjZTohMCx0ZW1wbGF0ZTonPGRpdiBuZy1zaG93PVwibG9hZGVkXCIgY2xhc3M9XCJ0b2dnbGUtYnV0dG9uXCI+PGRpdiBjbGFzcz1cInRvZ2dsZVwiPjwvZGl2PjwvZGl2PicsbGluazpmdW5jdGlvbihlLHQsaSl7dmFyIGw9ZnVuY3Rpb24oaSl7ZS5sb2FkZWQ9ITAsaT90LmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpOnQucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIil9O2UuJHdhdGNoKFwidG9nZ2xlLnZhbHVlXCIsZnVuY3Rpb24oZSx0KXtcInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmbChlKX0pLHQub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7ZS50b2dnbGUudmFsdWU9IWUudG9nZ2xlLnZhbHVlLGwoZS50b2dnbGUudmFsdWUpfSl9fX0pLmRpcmVjdGl2ZShcInlnU3Bpbm5lclwiLFtcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsdGVtcGxhdGU6JzxkaXYgY2xhc3M9XCJsb2FkaW5nXCIgbmctc2hvdz1cImxvYWRpbmcoKVwiPjwvZGl2Picsc2NvcGU6e30sbGluazpmdW5jdGlvbih0LGksbCxuKXt0LmxvYWRpbmc9ZS5nZXRMb2FkaW5nfX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiVGlja2V0RmFjdG9yeVwiLFtcIiRodHRwXCIsZnVuY3Rpb24odCl7dmFyIGU9e307cmV0dXJuIGUuY3JlYXRlTmV3VGlja2V0PWZ1bmN0aW9uKGUpe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL25ld1wiLGUpfSxlLnVwZGF0ZVRpY2tldD1mdW5jdGlvbihlLGkpe3JldHVybiB0LnB1dChcInRpY2tldHMvXCIrZSxpKX0sZS5nZXRUaWNrZXRCeUlkPWZ1bmN0aW9uKGUpe3JldHVybiB0LmdldChcInRpY2tldHMvXCIrZSl9LGUuZ2V0SW5pdGlhbFRpY2tldERhdGE9ZnVuY3Rpb24oZSl7cmV0dXJuIHQuZ2V0KFwidGlja2V0cy9lZGl0LXRpY2tldC9pbml0aWFsLWxvYWQvXCIrZSl9LGUuZ2V0RGFzaGJvYXJkRGF0YT1mdW5jdGlvbigpe3JldHVybiB0LmdldChcImFkbWluL2Rhc2hib2FyZFwiKX0sZX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJDb21tb25GYWN0b3J5XCIsW1wiJGh0dHBcIixmdW5jdGlvbih0KXt2YXIgZT17fTtyZXR1cm4gZS5nZXRJbml0aWFsU3RhdGljRGF0YT1mdW5jdGlvbigpe3JldHVybiB0LmdldChcInRpY2tldHMvc3RhdGljLWRhdGFcIil9LGV9XSkuZmlsdGVyKFwicmV2ZXJzZVwiLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe2lmKHQpcmV0dXJuIHQuc2xpY2UoKS5yZXZlcnNlKCl9fSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiVXNlckZhY3RvcnlcIixbXCIkaHR0cFwiLGZ1bmN0aW9uKGUpe3ZhciB0PXt9O3JldHVybiB0LmxvZ2luPWZ1bmN0aW9uKHQscixuKXtyZXR1cm4gZS5wb3N0KFwiYWNjb3VudHMvbG9naW5cIix7dXNlcm5hbWU6dCxwYXNzd29yZDpyLHJlbWVtYmVyOm59KX0sdC5sb2dvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZS5nZXQoXCJhY2NvdW50cy9sb2dvdXRcIil9LHQucmVnaXN0ZXJVc2VyPWZ1bmN0aW9uKHQpe3JldHVybiBlLnBvc3QoXCJhY2NvdW50cy9yZWdpc3RlclwiLHQpfSx0LmdldFVzZXJCeVVzZXJuYW1lPWZ1bmN0aW9uKHQpe3JldHVybiBlLmdldChcInVzZXJzL3Byb2ZpbGUvXCIrdCl9LHQudXBkYXRlUHJvZmlsZT1mdW5jdGlvbih0KXtyZXR1cm4gZS5wb3N0KFwidXNlcnMvcHJvZmlsZS9cIit0LnVzZXJuYW1lLHQpfSx0LnNldFVzZXJuYW1lPWZ1bmN0aW9uKHQpe3JldHVybiBlLnBvc3QoXCJhY2NvdW50cy9zZXQtdXNlcm5hbWVcIix0KX0sdC5jaGFuZ2VQYXNzd29yZD1mdW5jdGlvbih0LHIpe3JldHVybiBlLnBvc3QoXCJ1c2Vycy9wcm9maWxlL2NoYW5nZS1wYXNzd29yZC9cIit0LHIpfSx0LmdldEFsbFVzZXJEZXRhaWxzPWZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0KFwiYWRtaW4vdXNlcnMtZGV0YWlsc1wiKX0sdC5nZXRVc2VyRGV0YWlscz1mdW5jdGlvbih0KXtyZXR1cm4gZS5nZXQoXCJhZG1pbi91c2VyLWRldGFpbHMvXCIrdCl9LHQudXBkYXRlVXNlckRldGFpbHM9ZnVuY3Rpb24odCxyKXtyZXR1cm4gZS5wb3N0KFwiYWRtaW4vdXBkYXRlLXVzZXIvXCIrdCxyKX0sdC5yZXNldFBhc3N3b3JkPWZ1bmN0aW9uKHQscil7cmV0dXJuIGUucG9zdChcImFkbWluL3Jlc2V0LXBhc3N3b3JkL1wiK3Qscil9LHR9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiQXV0aGVudGljYXRpb25cIixmdW5jdGlvbigpe3ZhciB0PXt9O3JldHVybiB0LmdldElzQXV0aGVudGljYXRlZD1mdW5jdGlvbigpe2lmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiKSlyZXR1cm4hMH0sdC5zZXRVc2VyPWZ1bmN0aW9uKHQpe2xvY2FsU3RvcmFnZS5zZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiLEpTT04uc3RyaW5naWZ5KHQpKX0sdC5jbGVhclVzZXI9ZnVuY3Rpb24oKXtsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpY2tldFN5c3RlbVVzZXJcIil9LHQuZ2V0VXNlcj1mdW5jdGlvbigpe3JldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiKSl9LHR9KTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJIZWxwZXJGYWN0b3J5XCIsW1wiQXV0aGVudGljYXRpb25cIixmdW5jdGlvbihyKXt2YXIgZT17fSxuPXt9O3JldHVybiBuLmxvYWRpbmc9ITEsZS5jcmVhdGVGbGFzaE1lc3NhZ2U9ZnVuY3Rpb24ocixlKXtyZXR1cm4gci5kYXRhLmVycm9ycz9yLmRhdGEuZXJyb3JzLm1hcChmdW5jdGlvbihyKXtyZXR1cm57bWVzc2FnZTpyLmVycm9yLGNsYXNzOlwiZGFuZ2VyXCJ9fSk6ZT9be21lc3NhZ2U6ZSxjbGFzczpcInN1Y2Nlc3NcIn1dOltdfSxlLmdldEFsbFVzZXJzQnV0U2VsZj1mdW5jdGlvbihlKXt2YXIgbj1yLmdldFVzZXIoKS51c2VybmFtZTtyZXR1cm4gZS5maWx0ZXIoZnVuY3Rpb24ocil7cmV0dXJuIHIudXNlcm5hbWUhPT1ufSl9LGUucmVtb3ZlVXNlckZyb21Vc2Vycz1mdW5jdGlvbihyLGUpe3JldHVybiByLmZpbHRlcihmdW5jdGlvbihyKXt2YXIgbj1lLmluZGV4T2Yoci51c2VybmFtZSk9PT0tMTtyZXR1cm4gbn0pfSxlLmlzQ3VycmVudFVzZXJBZG1pbj1mdW5jdGlvbigpe3ZhciBlPXIuZ2V0VXNlcigpO3JldHVybiBlLnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xfSxlLmlzQ3VycmVudFVzZXJTdXBwb3J0PWZ1bmN0aW9uKCl7dmFyIGU9ci5nZXRVc2VyKCk7cmV0dXJuIGUucm9sZS5pbmRleE9mKFwiU3VwcG9ydFwiKT4tMX0sZS5pc0N1cnJlbnRVc2VyQWRtaW5PclN1cHBvcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gZS5pc0N1cnJlbnRVc2VyQWRtaW4oKXx8ZS5pc0N1cnJlbnRVc2VyQWRtaW4oKX0sZS5zdHJpcEh0bWw9ZnVuY3Rpb24ocil7cmV0dXJuIHI/U3RyaW5nKHIpLnJlcGxhY2UoLzxbXj5dKz4vZ20sXCJcIik6XCJcIn0sZS5nZXRMb2FkaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIG4ubG9hZGluZ30sZS5zZXRMb2FkaW5nPWZ1bmN0aW9uKHIpe24ubG9hZGluZz1yfSxlfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuZmFjdG9yeShcIkFjdGlvbkZhY3RvcnlcIixbXCIkaHR0cFwiLFwiJHFcIixmdW5jdGlvbih0LGUpe3ZhciBuLG89e307cmV0dXJuIG8uc2V0VGFzaz1mdW5jdGlvbih0KXtuPXR9LG8uZ2V0VGFzaz1mdW5jdGlvbigpe3JldHVybiBufSxvLmdldEFzc2lnbmVlcz1mdW5jdGlvbigpe3JldHVybiB0LmdldChcInN0YXRpYy9hbGwtdXNlcnNcIil9LG8uZ2V0QWxsb3dlZFN0YXR1cz1mdW5jdGlvbihlKXtyZXR1cm4gdC5nZXQoXCJzdGF0aWMvYWxsb3dlZC1zdGF0dXMvXCIrZSl9LG8uZ2V0QWxsb3dlZEJ1dHRvbnM9ZnVuY3Rpb24obil7dmFyIG89ZS5kZWZlcigpO3JldHVybiB0LmdldChcInN0YXRpYy9hY3Rpb24tYnV0dG9ucy9cIituKS50aGVuKGZ1bmN0aW9uKHQpe3ZhciBlPXt9O2UuYXNzaWduPXQuZGF0YS5hY3Rpb25CdXR0b25zLmFzc2lnbixlLmNvbW1lbnQ9dC5kYXRhLmFjdGlvbkJ1dHRvbnMuY29tbWVudCxlLmNoYW5nZVN0YXR1cz10LmRhdGEuYWN0aW9uQnV0dG9ucy5jaGFuZ2VTdGF0dXMsZS5yZW9wZW49dC5kYXRhLmFjdGlvbkJ1dHRvbnMucmVvcGVuLGUuY2xvc2U9dC5kYXRhLmFjdGlvbkJ1dHRvbnMuY2xvc2UsZS5hY2tub3dsZWRnZT10LmRhdGEuYWN0aW9uQnV0dG9ucy5hY2tub3dsZWRnZSxlLmF3YWl0aW5nVXNlclJlc3BvbnNlPXQuZGF0YS5hY3Rpb25CdXR0b25zLmF3YWl0aW5nVXNlclJlc3BvbnNlLGUuYXNzaWduVG9TZWxmPXQuZGF0YS5hY3Rpb25CdXR0b25zLmFzc2lnblRvU2VsZixvLnJlc29sdmUoZSl9KS5jYXRjaChmdW5jdGlvbih0KXtvLnJlamVjdCh0KX0pLG8ucHJvbWlzZX0sby5hc3NpZ249ZnVuY3Rpb24oZSxuLG8pe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL2Fzc2lnbi9cIitlLHthc3NpZ25lZTpuLGNvbW1lbnQ6b30pfSxvLmNoYW5nZVN0YXR1cz1mdW5jdGlvbihlLG4sbyl7cmV0dXJuIHQucG9zdChcInRpY2tldHMvY2hhbmdlLXN0YXR1cy9cIitlLHtzdGF0dXM6bixjb21tZW50Om99KX0sby5hd2FpdGluZ1VzZXJSZXNwb25zZT1mdW5jdGlvbihlLG4pe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL2F3YWl0aW5nLXVzZXItcmVzcG9uc2UvXCIrZSx7Y29tbWVudDpufSl9LG8ucmVvcGVuPWZ1bmN0aW9uKGUsbil7cmV0dXJuIHQucG9zdChcInRpY2tldHMvcmUtb3Blbi9cIitlLHtjb21tZW50Om59KX0sby5jbG9zZT1mdW5jdGlvbihlLG4pe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL2Nsb3NlL1wiK2Use2NvbW1lbnQ6bn0pfSxvLmFkZENvbW1lbnQ9ZnVuY3Rpb24oZSxuKXtyZXR1cm4gdC5wb3N0KFwidGlja2V0cy9hZGRDb21tZW50L1wiK2Use2NvbW1lbnQ6bn0pfSxvLmRlbGV0ZUNvbW1lbnQ9ZnVuY3Rpb24oZSxuKXtyZXR1cm4gdC5kZWxldGUoXCJ0aWNrZXRzL2RlbGV0ZUNvbW1lbnQvXCIrZS5faWQrXCI/Y29tbWVudElkPVwiK24uX2lkKX0sby5hY2tub3dsZWRnZVRpY2tldD1mdW5jdGlvbihlLG4pe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL2Fja25vd2xlZGdlL1wiK2Use2NvbW1lbnQ6bn0pfSxvfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIk1haW5DdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIkF1dGhlbnRpY2F0aW9uXCIsXCJVc2VyRmFjdG9yeVwiLFwiJHdpbmRvd1wiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsaSxuLG8scixzKXt2YXIgZz1mdW5jdGlvbigpe3ZhciB0PWkuZ2V0VXNlcigpO3Qucm9sZS5pbmRleE9mKFwiQWRtaW5cIik+LTE/ZS5pc0FkbWluPSEwOmUuaXNBZG1pbj0hMSxlLmlzUmVndWxhclVzZXI9ITAsKGkuZ2V0VXNlcigpLnJvbGUuaW5kZXhPZihcIlN1cHBvcnRcIik+LTF8fGkuZ2V0VXNlcigpLnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xKSYmKGUuaXNSZWd1bGFyVXNlcj0hMSl9O2UuaW5pdD1mdW5jdGlvbigpe3ZhciB0PWkuZ2V0VXNlcigpO3QmJih0LnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xP2UuaXNBZG1pbj0hMDplLmlzQWRtaW49ITEpfSxlLmdldFVzZXI9aS5nZXRVc2VyLGUuaXNBdXRoZW50aWNhdGVkPWkuZ2V0SXNBdXRoZW50aWNhdGVkLGUubG9nb3V0PWZ1bmN0aW9uKCl7bi5sb2dvdXQoKS50aGVuKGZ1bmN0aW9uKCl7aS5jbGVhclVzZXIoKSx0LmdvKFwidXNlcnMtbG9naW4ubG9naW5cIil9KX0sZS4kb24oXCJzdWNjZXNzZnVsLWxvZ2luXCIsZyksZS5nZXRQcm9maWxlPWZ1bmN0aW9uKCl7dC5nbyhcInVzZXJzLXByb2ZpbGVcIil9LG8uYXBwPXt9LG8uYXBwLmF1dGg9ZnVuY3Rpb24oZSxuKXtcIlwiIT09ZT9yLmFsZXJ0KFwiZGFuZ2VyXCIsZS50b1N0cmluZygpLDVlMyk6bi51c2VybmFtZSYmXCJcIiE9PW4udXNlcm5hbWU/biYmKGkuc2V0VXNlcihuKSxnKCksdC5nbyhcInRpY2tldC5teS10aWNrZXRzXCIpKTp0LmdvKFwiYXV0aC1nb29nbGVcIix7aWQ6bi5faWQudG9TdHJpbmcoKSxlbWFpbDpuLmVtYWlsfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIk5hdkN0cmxcIixbXCIkc2NvcGVcIixmdW5jdGlvbihhKXthLm5hdkNsYXNzPVwiXCIsYS50b2dnbGVOYXY9ZnVuY3Rpb24ocyl7dmFyIGU9YW5ndWxhci5lbGVtZW50KHMudGFyZ2V0KTtlLmhhc0NsYXNzKFwiaXMtb3BlblwiKT9hLm5hdkNsYXNzPVwiaXMtY2xvc2VcIjphLm5hdkNsYXNzPVwiaXMtb3BlblwifSxhLm5hdkNsaWNrPWZ1bmN0aW9uKHMpe2EubmF2Q2xhc3M9XCJhXCI9PT1zLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk/XCJpcy1jbG9zZVwiOmEubmF2Q2xhc3N9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIlVzZXJzTGlzdEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsdCl7dmFyIGk9ZnVuY3Rpb24oKXtyZXR1cm5cIlwifSxuPWZ1bmN0aW9uKGUpe3JldHVybiBlPT09ITA/XCJmYSBmYS1jaGVja1wiOlwiZmEgZmEtcmVtb3ZlXCJ9LG89ZnVuY3Rpb24oKXtyZXR1cm5cIlwifSxjPWZ1bmN0aW9uKGUpe3JldHVybiBlLmluZGV4T2YoXCJBZG1pblwiKT4tMT9cImZhIGZhLWNoZWNrXCI6XCJmYSBmYS1yZW1vdmVcIn07ZS5jb25maWc9e30sZS5jb25maWcudXJsPVwiL2FkbWluL3VzZXJzLWRldGFpbHNcIixlLmNvbmZpZy5jb2x1bW5zPVtdLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwidXNlcm5hbWVcIixuYW1lOlwiVXNlcm5hbWVcIixjc3NDbGFzczpcImNvbC1tZC02XCJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImlzQWN0aXZlXCIsbmFtZTpcIklzIEFjdGl2ZVwiLGNzc0NsYXNzOlwiY29sLW1kLTNcIixyZW5kZXI6aSxyZW5kZXJDbGFzczpufSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJyb2xlXCIsbmFtZTpcIklzIEFkbWluXCIsY3NzQ2xhc3M6XCJjb2wtbWQtM1wiLHJlbmRlcjpvLHJlbmRlckNsYXNzOmN9KSxlLmNvbmZpZy5zb3J0UXVlcnlzdHJpbmdQYXJhbT1cInNvcnRcIixlLmNvbmZpZy5vcmRlclF1ZXJ5c3RyaW5nUGFyYW09XCJvcmRlclwiLGUuY29uZmlnLnBhZ2VRdWVyeXN0cmluZ1BhcmFtPVwicGFnZVwiLGUuY29uZmlnLnNpemVRdWVyeXN0cmluZ1BhcmFtPVwic2l6ZVwiLGUuY29uZmlnLm9iamVjdE5hbWU9XCJ1c2Vyc1wiLGUuY29uZmlnLm9uUm93Q2xpY2s9ZnVuY3Rpb24oZSl7cy5nbyhcImFkbWluLWVkaXRcIix7dXNlcm5hbWU6ZS51c2VybmFtZX0pfX1dKS5jb250cm9sbGVyKFwiRWRpdFVzZXJzQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkc3RhdGVQYXJhbXNcIixcIkhlbHBlckZhY3RvcnlcIixcIlVzZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsdCxpKXtlLmlzQWN0aXZlPXt9LGUuaXNBZG1pbj17fSxlLnVzZXJEZXRhaWxzPXt9O3ZhciBuPWEudXNlcm5hbWU7dC5nZXRVc2VyRGV0YWlscyhuKS50aGVuKGZ1bmN0aW9uKHMpe2UudXNlckRldGFpbHMudXNlcm5hbWU9cy5kYXRhLnVzZXIudXNlcm5hbWUsZS51c2VyRGV0YWlscy5maXJzdG5hbWU9cy5kYXRhLnVzZXIuZmlyc3RuYW1lLGUudXNlckRldGFpbHMubGFzdG5hbWU9cy5kYXRhLnVzZXIubGFzdG5hbWUsZS51c2VyRGV0YWlscy5pZD1zLmRhdGEudXNlci5faWQ7dmFyIGE9cy5kYXRhLnVzZXIucm9sZTthLmluZGV4T2YoXCJBZG1pblwiKT4tMT9lLnVzZXJEZXRhaWxzLmlzQWRtaW49ITA6ZS51c2VyRGV0YWlscy5pc0FkbWluPSExLGUudXNlckRldGFpbHMuaXNBY3RpdmU9cy5kYXRhLnVzZXIuaXNBY3RpdmUsZS51c2VyRGV0YWlscy5lbWFpbD1zLmRhdGEudXNlci5lbWFpbCxlLmlzQWN0aXZlLmtleT1cImlzQWN0aXZlXCIsZS5pc0FjdGl2ZS52YWx1ZT1lLnVzZXJEZXRhaWxzLmlzQWN0aXZlLGUuaXNBZG1pbi5rZXk9XCJpc0FkbWluXCIsZS5pc0FkbWluLnZhbHVlPWUudXNlckRldGFpbHMuaXNBZG1pbn0pLmNhdGNoKGZ1bmN0aW9uKGUpe2kuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBmZXRjaCB1c2VyIGRldGFpbHMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KSxlLnVzZXJEZXRhaWxzLnVwZGF0ZT1mdW5jdGlvbigpe3JldHVybiBlLmVkaXRVc2VyRm9ybS4kaW52YWxpZD8oZS5lZGl0VXNlckZvcm0uZmlyc3RuYW1lLiR0b3VjaGVkPSEwLGUuZWRpdFVzZXJGb3JtLmxhc3RuYW1lLiR0b3VjaGVkPSEwLHZvaWQoZS5lZGl0VXNlckZvcm0uZW1haWwuJHRvdWNoZWQ9ITApKTooZS51c2VyRGV0YWlscy5pc0FkbWluPWUuaXNBZG1pbi52YWx1ZSxlLnVzZXJEZXRhaWxzLmlzQWN0aXZlPWUuaXNBY3RpdmUudmFsdWUsdm9pZCB0LnVwZGF0ZVVzZXJEZXRhaWxzKGUudXNlckRldGFpbHMudXNlcm5hbWUsZS51c2VyRGV0YWlscykudGhlbihmdW5jdGlvbihlKXtyLmNyZWF0ZUZsYXNoTWVzc2FnZShlLFwiVXNlciBkZXRhaWxzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7aS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSl9KS5jYXRjaChmdW5jdGlvbihlKXtpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gdXBkYXRlIHVzZXIgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKX0pKX19XSkuY29udHJvbGxlcihcIkNoYW5nZVVzZXJzUGFzc3dvcmRDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiSGVscGVyRmFjdG9yeVwiLFwiVXNlckZhY3RvcnlcIixcIllnTm90aWZ5XCIsZnVuY3Rpb24oZSxzLGEscix0LGkpe2UuY2hhbmdlUGFzc3dvcmQ9e30sZS5jaGFuZ2VQYXNzd29yZC50aXRsZT1cIlJlc2V0IFBhc3N3b3JkXCIsZS5jaGFuZ2VQYXNzd29yZC5zYXZlVGl0bGU9XCJSZXNldFwiLGUuY2hhbmdlUGFzc3dvcmQuY2FuY2VsSHJlZj1cIiMvYWRtaW4vdXNlci1tYW5hZ2VtZW50XCIsZS5jaGFuZ2VQYXNzd29yZC5zYXZlPWZ1bmN0aW9uKHMpe2lmKHMuJGludmFsaWQpcmV0dXJuIHMucGFzc3dvcmQyLiR0b3VjaGVkPSEwLHZvaWQocy5wYXNzd29yZDEuJHRvdWNoZWQ9ITApO3ZhciBuPWEuaWQ7dC5yZXNldFBhc3N3b3JkKG4sZS5jaGFuZ2VQYXNzd29yZCkudGhlbihmdW5jdGlvbihlKXtyLmNyZWF0ZUZsYXNoTWVzc2FnZShlLFwiUGFzc3dvcmQgaGFzIGJlZW4gcmVzZXQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7aS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSl9KS5jYXRjaChmdW5jdGlvbihlKXtpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGUgcmVxdWVzdCBjb3VsZCBub3QgYmVuIG1hZGUgc3VjY2Vzc2Z1bGx5LiBQbGVhc2UgdHJ5IGxhdGVyXCIsNWUzKX0pfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJEYXNoYm9hcmRDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIllnTm90aWZ5XCIsXCJUaWNrZXRGYWN0b3J5XCIsZnVuY3Rpb24oZSxuLHMsdCl7dmFyIG89ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBEYXRlKERhdGUucGFyc2UoZSkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSxjPWZ1bmN0aW9uKGUpe3JldHVybiBlP1N0cmluZyhlKS5yZXBsYWNlKC88W14+XSs+L2dtLFwiXCIpOlwiXCJ9LGk9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/ZTpcIlVuYXNzaWduZWRcIn07ZS5jb25maWc9e30sZS5jb25maWcuY29sdW1ucz1bXSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImlkXCIsbmFtZTpcIklEXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJ0aXRsZVwiLG5hbWU6XCJUaXRsZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiZGVzY3JpcHRpb25cIixuYW1lOlwiRGVzY3JpcHRpb25cIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOmN9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInR5cGVcIixuYW1lOlwiVHlwZVwiLGNzc0NsYXNzOlwiY29sLW1kLTFcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiYXNzaWduZWVcIixuYW1lOlwiQXNzaWduZWVcIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOml9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImNyZWF0ZWREYXRlXCIsbmFtZTpcIkNyZWF0ZWQgRGF0ZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6b30pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZEJ5XCIsbmFtZTpcIkNyZWF0ZWQgQnlcIixjc3NDbGFzczpcImNvbC1tZC0yXCJ9KSxlLmNvbmZpZy51cmw9XCIvYWRtaW4vb3Blbi13aXRoaW4tZGF5XCIsZS5jb25maWcuc29ydFF1ZXJ5c3RyaW5nUGFyYW09XCJzb3J0XCIsZS5jb25maWcub3JkZXJRdWVyeXN0cmluZ1BhcmFtPVwib3JkZXJcIixlLmNvbmZpZy5wYWdlUXVlcnlzdHJpbmdQYXJhbT1cInBhZ2VcIixlLmNvbmZpZy5zaXplUXVlcnlzdHJpbmdQYXJhbT1cInNpemVcIixlLmNvbmZpZy5vblJvd0NsaWNrPWZ1bmN0aW9uKGUpe24uZ28oXCJ0aWNrZXQtdmlld1wiLHtpZDplLmlkfSl9LGUuY29uZmlnLm9iamVjdE5hbWU9XCJ0aWNrZXRzXCIsdC5nZXREYXNoYm9hcmREYXRhKCkudGhlbihmdW5jdGlvbihuKXt2YXIgcz1uLmRhdGEudGlja2V0cztlLm5ldz17fSxlLm9wZW49e30sZS5pblByb2dyZXNzPXt9LGUuYXdhaXRpbmdVc2VyUmVzcG9uc2U9e30sZS5uZXcudGlja2V0PXMubmV3LnRpY2tldCxlLm5ldy5jb3VudD1zLm5ldy5jb3VudCxlLm9wZW4udGlja2V0PXMub3Blbi50aWNrZXQsZS5vcGVuLmNvdW50PXMub3Blbi5jb3VudCxlLmluUHJvZ3Jlc3MudGlja2V0PXMuaW5Qcm9ncmVzcy50aWNrZXQsZS5pblByb2dyZXNzLmNvdW50PXMuaW5Qcm9ncmVzcy5jb3VudCxlLmF3YWl0aW5nVXNlclJlc3BvbnNlLnRpY2tldD1zLmF3YWl0aW5nVXNlclJlc3BvbnNlLnRpY2tldCxlLmF3YWl0aW5nVXNlclJlc3BvbnNlLmNvdW50PXMuYXdhaXRpbmdVc2VyUmVzcG9uc2UuY291bnR9KS5jYXRjaChmdW5jdGlvbihlKXtzLmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gZmV0Y2ggdGhlIGRhc2hib2FyZCBkYXRhLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLDVlMyl9KX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJEZWxldGVDb21tZW50Q3RybFwiLFtcIiRzY29wZVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixcIllnTW9kYWxcIixcIkFjdGlvbkZhY3RvcnlcIixmdW5jdGlvbihlLHQsbixvLHIpe3ZhciBjPWZ1bmN0aW9uKG8sYyl7cmV0dXJuIGZ1bmN0aW9uKCl7ci5kZWxldGVDb21tZW50KG8sYykudGhlbihmdW5jdGlvbihvKXtuLmNyZWF0ZUZsYXNoTWVzc2FnZShvLFwiVGhlIGNvbW1lbnQgd2FzIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksby5kYXRhLmVycm9yc3x8KGUudGlja2V0LmNvbW1lbnRzPW8uZGF0YS5jb21tZW50cyl9KS5jYXRjaChmdW5jdGlvbihlKXt0LmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gZGVsZXRlIGNvbW1lbnQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsNWUzKX0pfX07ZS5kZWxldGVDb21tZW50PWZ1bmN0aW9uKGUsdCl7by5jb25maXJtKGMoZSx0KSksby5vcGVuKFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRvIHRoaXM/XCIsXCJUaGlzIHdpbGwgZGVsZXRlIHRoZSBjb21tZW50IHBlcm1hbmVudGx5XCIpfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJFZGl0VGlja2V0Q3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCIkc3RhdGVcIixcIlRpY2tldEZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKHQsZSxhLHIsaSxjLG4pe3QudG9vbGJhckNvbmZpZz1bW1wiaDFcIixcInBcIixcInByZVwiLFwicXVvdGVcIl0sW1wiYm9sZFwiLFwiaXRhbGljc1wiLFwidW5kZXJsaW5lXCIsXCJzdHJpa2VUaHJvdWdoXCIsXCJ1bFwiLFwib2xcIixcInJlZG9cIixcInVuZG9cIixcImNsZWFyXCJdLFtdLFtcImluc2VydExpbmtcIl1dLHQuY2FuY2VsPWZ1bmN0aW9uKCl7YS5nbyhcInRpY2tldC12aWV3XCIse2lkOnQudGlja2V0LmlkfSl9LHQucmVuZGVyRGF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZSh0KSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LHIuZ2V0VGlja2V0QnlJZChlLmlkKS50aGVuKGZ1bmN0aW9uKGUpe2lmKGUuZGF0YS5lcnJvcnMpe2EuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKTt2YXIgbz1jLmNyZWF0ZUVycm9yTWVzc2FnZShlLmRhdGEuZXJyb3JzKTtvLmZvckVhY2goZnVuY3Rpb24odCl7aS5hbGVydChcImRhbmdlclwiLHQsNWUzKX0pfWVsc2UgdC50aWNrZXQ9ZS5kYXRhLnRpY2tldCx0LnRpY2tldC5jdXJyZW50VXNlcj1uLmdldFVzZXIoKS51c2VybmFtZSxyLmdldEluaXRpYWxUaWNrZXREYXRhKHQudGlja2V0LnN0YXR1cykudGhlbihmdW5jdGlvbihlKXt0LnByaW9yaXRpZXM9ZS5kYXRhLnByaW9yaXRpZXMudmFsdWVzLHQudHlwZXM9ZS5kYXRhLnR5cGVzLnZhbHVlcyx0LnVzZXJzPWUuZGF0YS51c2Vycyx0LnN0YXR1c2VzPWUuZGF0YS5zdGF0dXNlc30pLmNhdGNoKGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKHQpLGkuYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBmZXRjaCB0aGUgc3RhdGljIGRhdGEuXCIsNWUzKX0pfSkuY2F0Y2goZnVuY3Rpb24odCl7Y29uc29sZS5sb2codCksaS5hbGVydChcImRhbmdlclwiLFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGdldCB0aWNrZXQgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpfSksdC51cGRhdGU9ZnVuY3Rpb24oKXtyLnVwZGF0ZVRpY2tldCh0LnRpY2tldC5faWQsdC50aWNrZXQpLnRoZW4oZnVuY3Rpb24oZSl7dC50aWNrZXQ9ZS5kYXRhLGkuYWxlcnQoXCJzdWNjZXNzXCIsXCJUaWNrZXQgdXBkYXRlZCBzdWNjZXNzZnVsbHkuXCIsNWUzKSxhLmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5kYXRhLmlkfSl9KS5jYXRjaChmdW5jdGlvbih0KXtjb25zb2xlLmxvZyh0KSxpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gdXBkYXRlIHRpY2tldCBkZXRhaWxzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiTmV3VGlja2V0Q3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCJUaWNrZXRGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiQ29tbW9uRmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxpLGMsbixvKXtuLmdldEluaXRpYWxTdGF0aWNEYXRhKCkudGhlbihmdW5jdGlvbih0KXtlLm5ld1RpY2tldC50eXBlcz10LmRhdGEudHlwZXMudmFsdWVzLGUubmV3VGlja2V0LnR5cGU9ZS5uZXdUaWNrZXQudHlwZXNbMF0udmFsdWV9KSxlLm5ld1RpY2tldD17fSxlLnRvb2xiYXJDb25maWc9W1tcImgxXCIsXCJwXCIsXCJwcmVcIixcInF1b3RlXCJdLFtcImJvbGRcIixcIml0YWxpY3NcIixcInVuZGVybGluZVwiLFwic3RyaWtlVGhyb3VnaFwiLFwidWxcIixcIm9sXCIsXCJyZWRvXCIsXCJ1bmRvXCIsXCJjbGVhclwiXSxbXSxbXCJpbnNlcnRMaW5rXCJdXSxlLnNhdmU9ZnVuY3Rpb24oKXtyZXR1cm4gZS5uZXdUaWNrZXRGb3JtLiRpbnZhbGlkPyhlLm5ld1RpY2tldEZvcm0udGl0bGUuJHRvdWNoZWQ9ITAsdm9pZChlLm5ld1RpY2tldEZvcm0uZGVzY3JpcHRpb24uJHRvdWNoZWQ9ITApKTp2b2lkIGkuY3JlYXRlTmV3VGlja2V0KHt0aXRsZTplLm5ld1RpY2tldC50aXRsZSxkZXNjcmlwdGlvbjplLm5ld1RpY2tldC5kZXNjcmlwdGlvbix0eXBlOmUubmV3VGlja2V0LnR5cGV9KS50aGVuKGZ1bmN0aW9uKGUpe28uY3JlYXRlRmxhc2hNZXNzYWdlKGUsXCJUaGUgdGlja2V0IGhhcyBiZWVuIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7Yy5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksZS5kYXRhLmlkJiZ0LmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5kYXRhLmlkfSl9LGZ1bmN0aW9uKGUpe2MuYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBjcmVhdGUgbmV3IHRpY2tldC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpLGNvbnNvbGUubG9nKGUpfSl9fV0pO1xuXG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiVGlja2V0c0N0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiYWdTb3J0RmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxuLGkpe2UuaXNTdXBwb3J0PSExO3ZhciBjPUpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aWNrZXRTeXN0ZW1Vc2VyXCIpKTtjJiYoYy5yb2xlLmluZGV4T2YoXCJBZG1pblwiKT4tMXx8Yy5yb2xlLmluZGV4T2YoXCJTdXBwb3J0XCIpPi0xKSYmKGUuaXNTdXBwb3J0PSEwKTt2YXIgcz1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZShlKSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LG89ZnVuY3Rpb24oZSl7cmV0dXJuIGU/U3RyaW5nKGUpLnJlcGxhY2UoLzxbXj5dKz4vZ20sXCJcIik6XCJcIn0scj1mdW5jdGlvbihlKXtyZXR1cm4gZT9lOlwiVW5hc3NpZ25lZFwifTtlLmNvbmZpZz17fSxlLmNvbmZpZy5jb2x1bW5zPVtdLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiaWRcIixuYW1lOlwiSURcIixjc3NDbGFzczpcImNvbC1tZC0xXCJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInRpdGxlXCIsbmFtZTpcIlRpdGxlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJkZXNjcmlwdGlvblwiLG5hbWU6XCJEZXNjcmlwdGlvblwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6b30pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwidHlwZVwiLG5hbWU6XCJUeXBlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJhc3NpZ25lZVwiLG5hbWU6XCJBc3NpZ25lZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6cn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZERhdGVcIixuYW1lOlwiQ3JlYXRlZCBEYXRlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwiLHJlbmRlcjpzfSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJjcmVhdGVkQnlcIixuYW1lOlwiQ3JlYXRlZCBCeVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLnNvcnRRdWVyeXN0cmluZ1BhcmFtPVwic29ydFwiLGUuY29uZmlnLm9yZGVyUXVlcnlzdHJpbmdQYXJhbT1cIm9yZGVyXCIsZS5jb25maWcucGFnZVF1ZXJ5c3RyaW5nUGFyYW09XCJwYWdlXCIsZS5jb25maWcuc2l6ZVF1ZXJ5c3RyaW5nUGFyYW09XCJzaXplXCIsZS5jb25maWcub25Sb3dDbGljaz1mdW5jdGlvbihlKXt0LmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5pZH0pfSxlLmNvbmZpZy5vYmplY3ROYW1lPVwidGlja2V0c1wiLGUuaW5pdGlhdGVBbGxUaWNrZXQ9ZnVuY3Rpb24oKXtlLmNvbmZpZy51cmw9XCIvdGlja2V0cy9hbGxcIixlLiRwYXJlbnQuYWN0aXZlPVwiYWxsXCJ9LGUuaW5pdGlhdGVNeVRpY2tldD1mdW5jdGlvbigpe2UuY29uZmlnLnVybD1cIi90aWNrZXRzL215XCIsZS4kcGFyZW50LmFjdGl2ZT1cIm15XCJ9LGUuaW5pdGlhdGVUb01lVGlja2V0PWZ1bmN0aW9uKCl7ZS5jb25maWcudXJsPVwiL3RpY2tldHMvdG8tbWVcIixlLiRwYXJlbnQuYWN0aXZlPVwidG9tZVwifX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJWaWV3VGlja2V0Q3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCIkc3RhdGVcIixcIlRpY2tldEZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJBdXRoZW50aWNhdGlvblwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxyLGksbixzLGEpe2Z1bmN0aW9uIGMoZSx0KXtzd2l0Y2goZT1lfHxcIlwiLHQuc3VjY2Vzcz10LnN1Y2Nlc3N8fFwiXCIsdC53YXJuaW5nPXQud2FybmluZ3x8XCJcIix0LmRhbmdlcj10LmRhbmdlcnx8XCJcIix0LmluZm89dC5pbmZvfHxcIlwiLGUudG9Mb3dlckNhc2UoKSl7Y2FzZSB0LnN1Y2Nlc3MudG9Mb3dlckNhc2UoKTpyZXR1cm5cInN1Y2Nlc3NcIjtjYXNlIHQud2FybmluZy50b0xvd2VyQ2FzZSgpOnJldHVyblwid2FybmluZ1wiO2Nhc2UgdC5kYW5nZXIudG9Mb3dlckNhc2UoKTpyZXR1cm5cImRhbmdlclwiO2Nhc2UgdC5pbmZvLnRvTG93ZXJDYXNlKCk6cmV0dXJuXCJpbmZvXCI7ZGVmYXVsdDpyZXR1cm5cImluZm9cIn19ZnVuY3Rpb24gbyhlKXtyZXR1cm4gYyhlLHtzdWNjZXNzOlwiaW4tcHJvZ3Jlc3NcIix3YXJuaW5nOlwib3BlblwiLGluZm86XCJuZXdcIixkYW5nZXI6XCJyZXNvbHZlZFwifSl9ZnVuY3Rpb24gdShlKXtyZXR1cm4gYyhlLHtzdWNjZXNzOlwibG93XCIsd2FybmluZzpcIm1lZGl1bVwiLGRhbmdlcjpcImhpZ2hcIn0pfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIGUuYXNzaWduZWU9PT1lLmN1cnJlbnRVc2VyfHwoZS5jcmVhdGVkQnk9PT1lLmN1cnJlbnRVc2VyfHwoISFhLmlzQ3VycmVudFVzZXJBZG1pbigpfHwhIWEuaXNDdXJyZW50VXNlclN1cHBvcnQoKSkpfWkuZ2V0VGlja2V0QnlJZCh0LmlkKS50aGVuKGZ1bmN0aW9uKHQpe2EuY3JlYXRlRmxhc2hNZXNzYWdlKHQpLmZvckVhY2goZnVuY3Rpb24oZSl7bi5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksdC5kYXRhLmVycm9yc3x8KGUudGlja2V0PXQuZGF0YS50aWNrZXQsZS50aWNrZXQuZGVzY3JpcHRpb249YS5zdHJpcEh0bWwoZS50aWNrZXQuZGVzY3JpcHRpb24pLGUudGlja2V0LmFzc2lnbmVlPWUudGlja2V0LmFzc2lnbmVlP2UudGlja2V0LmFzc2lnbmVlOlwiVW5hc3NpZ25lZFwiLGUudGlja2V0LmNyZWF0ZWREYXRlPWUucmVuZGVyRGF0ZShlLnRpY2tldC5jcmVhdGVkRGF0ZSksZS50aWNrZXQuY3VycmVudFVzZXI9cy5nZXRVc2VyKCkudXNlcm5hbWUsZS5zdGF0dXNDbGFzcz1vKGUudGlja2V0LnN0YXR1cyksZS50aWNrZXQucHJpb3JpdHk9ZS50aWNrZXQucHJpb3JpdHl8fFwiTi5BXCIsZS5wcmlvcml0eUNsYXNzPXUoZS50aWNrZXQucHJpb3JpdHkpLGQoZS50aWNrZXQpJiYoZS5zaG93RWRpdD0hMCkpfSkuY2F0Y2goZnVuY3Rpb24oZSl7bi5hbGVydChcImRhbmdlclwiLFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGdldCB0aWNrZXQgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpfSksZS50aWNrZXQ9e30sZS5lZGl0PWZ1bmN0aW9uKCl7ci5nbyhcInRpY2tldC1lZGl0XCIse2lkOmUudGlja2V0LmlkfSl9LGUucmVuZGVyRGF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZShlKSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkNoYW5nZVBhc3N3b3JkQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkc3RhdGVQYXJhbXNcIixcIlVzZXJGYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsbyx0KXtlLmNoYW5nZVBhc3N3b3JkPXt9LGUuY2hhbmdlUGFzc3dvcmQudGl0bGU9XCJDaGFuZ2UgUGFzc3dvcmRcIixlLmNoYW5nZVBhc3N3b3JkLnNhdmVUaXRsZT1cIkNoYW5nZSBQYXNzd29yZFwiLGUuY2hhbmdlUGFzc3dvcmQuY2FuY2VsSHJlZj1cIiMvdXNlcnMvcHJvZmlsZVwiLGUuY2hhbmdlUGFzc3dvcmQuc2F2ZT1mdW5jdGlvbihjKXtpZihjLiRpbnZhbGlkKXJldHVybiBjLnBhc3N3b3JkMi4kdG91Y2hlZD0hMCx2b2lkKGMucGFzc3dvcmQxLiR0b3VjaGVkPSEwKTt2YXIgbj1hLmlkO3IuY2hhbmdlUGFzc3dvcmQobixlLmNoYW5nZVBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uKGUpe28uY3JlYXRlRmxhc2hNZXNzYWdlKGUsXCJUaGUgcGFzc3dvcmQgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXt0LmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmRhdGEuZXJyb3JzfHxzLmdvKFwidXNlcnMtcHJvZmlsZVwiKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe3QuYWxlcnQoXCJkYW5nZXJcIixcIlRoZSByZXF1ZXN0IGNvdWxkIG5vdCBiZW4gbWFkZSBzdWNjZXNzZnVsbHkuIFBsZWFzZSB0cnkgbGF0ZXJcIiw1ZTMpfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkxvZ2luQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkd2luZG93XCIsXCJVc2VyRmFjdG9yeVwiLFwiQXV0aGVudGljYXRpb25cIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsbyxyLGksbil7aS5nZXRVc2VyKCkmJnQuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKSxlLmVycm9yPSExLGUubWVzc2FnZT1cIlwiLGUubG9naW49ZnVuY3Rpb24oKXtyLmxvZ2luKGUudXNlcm5hbWUsZS5wYXNzd29yZCxlLnJlbWVtYmVyKS50aGVuKGZ1bmN0aW9uKG8pe28uZGF0YS5pc0F1dGhlbnRpY2F0ZWQ/KGkuc2V0VXNlcihvLmRhdGEudXNlciksZS4kZW1pdChcInN1Y2Nlc3NmdWwtbG9naW5cIiksbi5pc0N1cnJlbnRVc2VyQWRtaW4oKT90LmdvKFwiZGFzaGJvYXJkXCIpOnQuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKSk6KGUuZXJyb3I9ITAsZS5tZXNzYWdlPW8uZGF0YS5tc2cpfSkuY2F0Y2goZnVuY3Rpb24odCl7ZS5lcnJvcj0hMCxlLm1lc3NhZ2U9XCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gbG9nIHlvdSBpbi4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlclwifSl9LGUuZ29vZ2xlTG9naW49ZnVuY3Rpb24oKXt2YXIgZT1cImFjY291bnRzL2F1dGgvZ29vZ2xlXCIsdD02MDAscj00NTAsaT0od2luZG93Lm91dGVySGVpZ2h0LXIpLzIsbj0od2luZG93Lm91dGVyV2lkdGgtdCkvMjtvLm9wZW4oZSxcImZhY2Vib29rX2xvZ2luXCIsXCJ3aWR0aD1cIit0K1wiLGhlaWdodD1cIityK1wiLHNjcm9sbGJhcnM9MCx0b3A9XCIraStcIixsZWZ0PVwiK24pfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJNYWluTG9naW5DdHJsXCIsW1wiJHJvb3RTY29wZVwiLFwiJHNjb3BlXCIsXCIkc3RhdGVcIixmdW5jdGlvbih0LGUsbil7ZS5zdGF0ZW5hbWU9bi5jdXJyZW50Lm5hbWUsdC4kb24oXCIkc3RhdGVDaGFuZ2VTdGFydFwiLGZ1bmN0aW9uKHQsbixhLG8scil7ZS5zdGF0ZW5hbWU9bi5uYW1lfSl9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiUHJvZmlsZUN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiQXV0aGVudGljYXRpb25cIixcIlVzZXJGYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUsYSxyLHMsdCx1KXtlLnVzZXI9e30sZS5pbml0PWZ1bmN0aW9uKCl7cy5nZXRVc2VyQnlVc2VybmFtZShyLmdldFVzZXIoKS51c2VybmFtZSkudGhlbihmdW5jdGlvbihhKXt0LmNyZWF0ZUZsYXNoTWVzc2FnZShhKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3UuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLGEuZGF0YS5lcnJvcnN8fChlLnVzZXIuZmlyc3RuYW1lPWEuZGF0YS51c2VyLmZpcnN0bmFtZSxlLnVzZXIubGFzdG5hbWU9YS5kYXRhLnVzZXIubGFzdG5hbWUsZS51c2VyLnVzZXJuYW1lPWEuZGF0YS51c2VyLnVzZXJuYW1lLGUudXNlci5lbWFpbD1hLmRhdGEudXNlci5lbWFpbCxlLnVzZXIudXNlcklkPWEuZGF0YS51c2VyLl9pZCl9KX0sZS51cGRhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gZS5wcm9maWxlRm9ybS4kaW52YWxpZD8oZS5wcm9maWxlRm9ybS5maXJzdG5hbWUuJHRvdWNoZWQ9ITAsZS5wcm9maWxlRm9ybS5sYXN0bmFtZS4kdG91Y2hlZD0hMCx2b2lkKGUucHJvZmlsZUZvcm0uZW1haWwuJHRvdWNoZWQ9ITApKToodC5zZXRMb2FkaW5nKCEwKSx2b2lkIHMudXBkYXRlUHJvZmlsZShlLnVzZXIpLnRoZW4oZnVuY3Rpb24oYSl7dC5jcmVhdGVGbGFzaE1lc3NhZ2UoYSxcIlVzZXIgZGV0YWlscyBoYXZlIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXt1LmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxhLmRhdGEuZXJyb3JzfHwoZS51c2VyLmZpcnN0bmFtZT1hLmRhdGEudXNlci5maXJzdG5hbWUsZS51c2VyLmxhc3RuYW1lPWEuZGF0YS51c2VyLmxhc3RuYW1lLGUudXNlci51c2VybmFtZT1hLmRhdGEudXNlci51c2VybmFtZSxlLnVzZXIuZW1haWw9YS5kYXRhLnVzZXIuZW1haWwsZS51c2VyLnJvbGU9YS5kYXRhLnVzZXIucm9sZSxyLnNldFVzZXIoZS51c2VyKSl9KS5jYXRjaChmdW5jdGlvbihlKXt1LmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gdXBkYXRlIHVzZXIgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKX0pKX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiUmVnaXN0ZXJDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIlVzZXJGYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscix0LHMsYSl7ZS5uZXdVc2VyPXt9LGUucmVnaXN0ZXI9ZnVuY3Rpb24oKXt0LnJlZ2lzdGVyVXNlcihlLm5ld1VzZXIpLnRoZW4oZnVuY3Rpb24oZSl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UoZSxcIlVzZXIgaGFzIGJlZW4gY3JlYXRlZCBzdWNjZXNzZnVsbHkuIFlvdSBjYW4gbm93IGxvZ2luLlwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLGUuZGF0YS5lcnJvcnMmJnIuZ28oXCJ1c2Vycy1sb2dpbi5sb2dpblwiKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjcmVhdGUgdGhlIHVzZXIuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiU2V0VXNlckN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiJHN0YXRlXCIsXCJVc2VyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkF1dGhlbnRpY2F0aW9uXCIsZnVuY3Rpb24oZSxzLHQsYSxyLG4pe3ZhciBjPXMuaWQsbz1zLmVtYWlsO2Uuc2V0VXNlcm5hbWU9e30sZS5zZXRVc2VybmFtZS5lbWFpbD1vLGUuc2F2ZVVzZXJuYW1lPWZ1bmN0aW9uKCl7YS5zZXRVc2VybmFtZSh7aWQ6Yyx1c2VybmFtZTplLnNldFVzZXJuYW1lLnVzZXJuYW1lfSkudGhlbihmdW5jdGlvbihzKXtIZWxwZXJGYWN0b3J5LmNyZWF0ZUZsYXNoTWVzc2FnZShzLFwiVXNlcm5hbWUgaGFzIGJlZW4gc2V0IHN1Y2Nlc3NmdWxseS5cIikuZm9yRWFjaChmdW5jdGlvbihlKXtyLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxzLmRhdGEuZXJyb3JzfHwobi5zZXRVc2VyKHMuZGF0YS51c2VyKSxlLiRlbWl0KFwic3VjY2Vzc2Z1bC1sb2dpblwiKSx0LmdvKFwidGlja2V0Lm15LXRpY2tldHNcIikpfSkuY2F0Y2goZnVuY3Rpb24oZSl7ci5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIHNldCB0aGUgdXNlcm5hbWUuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiQWN0aW9uc0N0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIkhlbHBlckZhY3RvcnlcIixcIiRyb290U2NvcGVcIixmdW5jdGlvbihlLHQsYSxzKXtlLmdldFRhc2s9dC5nZXRUYXNrLGUudGFzaz17fSxlLnRhc2suc2hvd1Rhc2tQYW5lbD0hMSxlLnRhc2suc2hvd01haW5QYW5lbD0hMSx0LnNldFRhc2sobnVsbCksZS5zZXRTYXZlRm49ZnVuY3Rpb24odCl7ZS5zYXZlVGFzaz10fSxlLmNhbmNlbFRhc2s9ZnVuY3Rpb24oKXt0LnNldFRhc2sobnVsbCksZS50YXNrLmNvbW1lbnQ9XCJcIixlLnRhc2suc2hvd1Rhc2tQYW5lbD0hMSxlLnRhc2suc2hvd01haW5QYW5lbD0hMX0sZS5zZXRTYXZlQnRuTmFtZT1mdW5jdGlvbih0KXtlLnNhdmVCdG5OYW1lPXR9LGUuJHdhdGNoKFwiZ2V0VGFzaygpXCIsZnVuY3Rpb24odCxhKXtpZihlLnRhc2submFtZT1udWxsLHQpc3dpdGNoKGUudGFzay5zaG93VGFza1BhbmVsPSEwLGUudGFzay5zaG93TWFpblBhbmVsPSEwLGUudGFzay5uYW1lPVwidGVtcGxhdGVzL3BhcnRpYWxzL2FjdGlvbi9cIit0K1wiLWFjdGlvbi1wYXJ0aWFsLmh0bWxcIix0KXtjYXNlXCJjb21tZW50XCI6ZS50YXNrLnRpdGxlPVwiQWRkIG5ldyBjb21tZW50XCI7YnJlYWs7Y2FzZVwiYXdhaXRpbmd1c2Vyc3Jlc3BvbnNlXCI6ZS50YXNrLnRpdGxlPVwiQXdhaXRpbmcgdXNlcnMgcmVzcG9uc2VcIjticmVhaztjYXNlXCJjbG9zZVwiOmUudGFzay50aXRsZT1cIkNsb3NlIHRpY2tldFwiO2JyZWFrO2Nhc2VcInJlb3BlblwiOmUudGFzay50aXRsZT1cIlJlb3BlbiB0aWNrZXRcIjticmVhaztjYXNlXCJhY2tub3dsZWRnZVwiOmUudGFzay50aXRsZT1cIkFja25vd2xlZGdlIHRpY2tldFwiO2JyZWFrO2Nhc2VcImFzc2lnblwiOmUudGFzay50aXRsZT1cIkFzc2lnbiB0aWNrZXRcIjticmVhaztjYXNlXCJjaGFuZ2VzdGF0dXNcIjplLnRhc2sudGl0bGU9XCJDaGFuZ2UgdGlja2V0IHN0YXR1c1wiO2JyZWFrO2Nhc2VcImFzc2lnbnRvc2VsZlwiOmUudGFzay50aXRsZT1cIkFzc2lnbiB0byBzZWxmXCJ9fSl9XSkuY29udHJvbGxlcihcIkFzc2lnbkFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7Y29uc29sZS5sb2coXCJzZXQgYXNzaWduZWVcIiksdC5nZXRBc3NpZ25lZXMoKS50aGVuKGZ1bmN0aW9uKHQpe2UudXNlcnM9dC5kYXRhLnVzZXJzLGUudXNlcnM9cy5yZW1vdmVVc2VyRnJvbVVzZXJzKGUudXNlcnMsW2UudGlja2V0LmNyZWF0ZWRCeSxlLnRpY2tldC5hc3NpZ25lZV0pLGUuYXNzaWduZWU9ZS51c2Vyc1swXS51c2VybmFtZX0pLGUuc2V0U2F2ZUZuKGZ1bmN0aW9uKCl7cmV0dXJuIGUuYWN0aW9uRm9ybS5jb21tZW50LiRpbnZhbGlkfHxlLmFjdGlvbkZvcm0uYXNzaWduZWUuJGludmFsaWQ/KGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwLHZvaWQoZS5hY3Rpb25Gb3JtLmFzc2lnbmVlLiR0b3VjaGVkPSEwKSk6dm9pZCB0LmFzc2lnbihlLnRpY2tldC5pZCxlLmFzc2lnbmVlLGUudGFzay5jb21tZW50KS50aGVuKGZ1bmN0aW9uKHQpe3MuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgYXNzaWduZWUgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSx0LmRhdGEuY29tbWVudHMmJihlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuYXNzaWduZWU9dC5kYXRhLmFzc2lnbmVlKSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBhc3NpZ24gdGhlIHRpY2tldC4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKSxlLmNhbmNlbFRhc2soKX0pfSksZS5zZXRTYXZlQnRuTmFtZShcIkFzc2lnbiBUaWNrZXRcIil9XSkuY29udHJvbGxlcihcIkNoYW5nZVN0YXR1c0FjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7dmFyIG49ZS50aWNrZXQuc3RhdHVzO3QuZ2V0QWxsb3dlZFN0YXR1cyhuKS50aGVuKGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKHQuZGF0YSksZS5hbGxvd2VkU3RhdHVzPXQuZGF0YS5zdGF0dXMuYWxsb3dlZCxlLm5ld1N0YXR1cz1lLmFsbG93ZWRTdGF0dXNbMF19KSxlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZHx8ZS5hY3Rpb25Gb3JtLm5ld1N0YXR1cy4kaW52YWxpZD8oZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJHRvdWNoZWQ9ITAsdm9pZChlLmFjdGlvbkZvcm0ubmV3U3RhdHVzLiR0b3VjaGVkPSEwKSk6dm9pZCB0LmNoYW5nZVN0YXR1cyhlLnRpY2tldC5pZCxlLm5ld1N0YXR1cyxlLnRhc2suY29tbWVudCkudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJDaGFuZ2UgU3RhdHVzXCIpfV0pLmNvbnRyb2xsZXIoXCJDb21tZW50QWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuYWRkQ29tbWVudChlLnRpY2tldC5pZCxlLnRhc2suY29tbWVudCkudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBjb21tZW50IGhhcyBiZWVuIGFkZGVkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLGUuY2FuY2VsVGFzaygpfSkuY2F0Y2goZnVuY3Rpb24odCl7YS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGFkZCBjb21tZW50LiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQWRkIENvbW1lbnRcIil9XSkuY29udHJvbGxlcihcIkNsb3NlQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuY2xvc2UoZS50aWNrZXQuaWQsZS50YXNrLmNvbW1lbnQpLnRoZW4oZnVuY3Rpb24odCl7ZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLGUudGlja2V0LnN0YXR1cz10LmRhdGEuc3RhdHVzLHMuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgc3RhdHVzIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7YS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksZS5jYW5jZWxUYXNrKCl9KS5jYXRjaChmdW5jdGlvbih0KXthLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gY2hhbmdlIHRoZSB0aWNrZXQgc3RhdHVzLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQ2xvc2VcIil9XSkuY29udHJvbGxlcihcIlJlb3BlbkFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtyZXR1cm4gZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQ/dm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk6dm9pZCB0LnJlb3BlbihlLnRpY2tldC5pZCxlLnRhc2suY29tbWVudCkudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJSZW9wZW5cIil9XSkuY29udHJvbGxlcihcIkF3YWl0aW5nQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuYXdhaXRpbmdVc2VyUmVzcG9uc2UoZS50aWNrZXQuaWQsZS50YXNrLmNvbW1lbnQpLnRoZW4oZnVuY3Rpb24odCl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSx0LmRhdGEuY29tbWVudHMmJihlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMpLGUuY2FuY2VsVGFzaygpfSkuY2F0Y2goZnVuY3Rpb24odCl7YS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGNoYW5nZSB0aGUgdGlja2V0IHN0YXR1cy4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKSxlLmNhbmNlbFRhc2soKX0pfSksZS5zZXRTYXZlQnRuTmFtZShcIkNoYW5nZSBTdGF0dXNcIil9XSkuY29udHJvbGxlcihcIkFja25vd2xlZGdlQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuYWNrbm93bGVkZ2VUaWNrZXQoZS50aWNrZXQuaWQsZS50YXNrLmNvbW1lbnQpLnRoZW4oZnVuY3Rpb24odCl7ZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLGUudGlja2V0LnN0YXR1cz10LmRhdGEuc3RhdHVzLHMuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgc3RhdHVzIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7YS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksZS5jYW5jZWxUYXNrKCl9KS5jYXRjaChmdW5jdGlvbih0KXthLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gY2hhbmdlIHRoZSB0aWNrZXQgc3RhdHVzLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQWNrbm93bGVkZ2UgVGlja2V0XCIpfV0pLmNvbnRyb2xsZXIoXCJBc3NpZ25Ub1NlbGZBY3Rpb25DdHJsXCIsW1wiJHNjb3BlXCIsXCJBY3Rpb25GYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiSGVscGVyRmFjdG9yeVwiLFwiQXV0aGVudGljYXRpb25cIixmdW5jdGlvbihlLHQsYSxzLG4pe2Uuc2V0U2F2ZUZuKGZ1bmN0aW9uKCl7aWYoZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQpcmV0dXJuIHZvaWQoZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJHRvdWNoZWQ9ITApO3ZhciBjPW4uZ2V0VXNlcigpO2NvbnNvbGUubG9nKGMpLHQuYXNzaWduKGUudGlja2V0LmlkLGMudXNlcm5hbWUsZS50YXNrLmNvbW1lbnQpLnRoZW4oZnVuY3Rpb24odCl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBhc3NpZ25lZSBoYXMgYmVlbiBjaGFuZ2VkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLHQuZGF0YS5jb21tZW50cyYmKGUudGlja2V0LmNvbW1lbnRzPXQuZGF0YS5jb21tZW50cyxlLnRpY2tldC5hc3NpZ25lZT10LmRhdGEuYXNzaWduZWUpLGUuY2FuY2VsVGFzaygpfSkuY2F0Y2goZnVuY3Rpb24odCl7YS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGFzc2lnbiB0aGUgdGlja2V0LiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQXNzaWduIFRvIFNlbGZcIil9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiQnV0dG9uR3JvdXBDdHJsXCIsW1wiJHNjb3BlXCIsXCJBY3Rpb25GYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24obyx0LG4pe28uYnV0dG9uZ3JvdXA9e30sby4kd2F0Y2hDb2xsZWN0aW9uKFwidGlja2V0XCIsZnVuY3Rpb24ocyl7cyYmcy5pZCYmKG4uaXNDdXJyZW50VXNlckFkbWluT3JTdXBwb3J0KCk/dC5nZXRBbGxvd2VkQnV0dG9ucyhzLmlkKS50aGVuKGZ1bmN0aW9uKHQpe28uYnV0dG9uZ3JvdXAuc2hvd0Fzc2lnbj10LmFzc2lnbixvLmJ1dHRvbmdyb3VwLnNob3dDb21tZW50PXQuY29tbWVudCxvLmJ1dHRvbmdyb3VwLnNob3djaGFuZ2VTdGF0dXM9dC5jaGFuZ2VTdGF0dXMsby5idXR0b25ncm91cC5zaG93UmVvcGVuPXQucmVvcGVuLG8uYnV0dG9uZ3JvdXAuc2hvd0Nsb3NlPXQuY2xvc2Usby5idXR0b25ncm91cC5zaG93QWNrbm93bGVkZ2U9dC5hY2tub3dsZWRnZSxvLmJ1dHRvbmdyb3VwLnNob3dBd2FpdGluZ1VzZXJzUmVzcG9uc2U9dC5hd2FpdGluZ1VzZXJSZXNwb25zZSxvLmJ1dHRvbmdyb3VwLnNob3dBc3NpZ25Ub1NlbGY9dC5hc3NpZ25Ub1NlbGZ9KTooby5idXR0b25ncm91cC5zaG93QXNzaWduPSExLG8uYnV0dG9uZ3JvdXAuc2hvd0NvbW1lbnQ9ITEsby5idXR0b25ncm91cC5zaG93Y2hhbmdlU3RhdHVzPSExLG8uYnV0dG9uZ3JvdXAuc2hvd1Jlb3Blbj0hMSxvLmJ1dHRvbmdyb3VwLnNob3dDbG9zZT0hMSxvLmJ1dHRvbmdyb3VwLnNob3dBY2tub3dsZWRnZT0hMSxvLmJ1dHRvbmdyb3VwLnNob3dBd2FpdGluZ1VzZXJzUmVzcG9uc2U9ITEsby5idXR0b25ncm91cC5zaG93QXNzaWduVG9TZWxmPSExKSl9KSxvLmJ1dHRvbmdyb3VwLmNvbW1lbnQ9ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJjb21tZW50XCIpfSxvLmJ1dHRvbmdyb3VwLmFzc2lnbj1mdW5jdGlvbigpe3Quc2V0VGFzayhcImFzc2lnblwiKX0sby5idXR0b25ncm91cC5jaGFuZ2VTdGF0dXM9ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJjaGFuZ2VzdGF0dXNcIil9LG8uYnV0dG9uZ3JvdXAuY2xvc2U9ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJjbG9zZVwiKX0sby5idXR0b25ncm91cC5yZW9wZW49ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJyZW9wZW5cIil9LG8uYnV0dG9uZ3JvdXAuYWNrbm93bGVkZ2U9ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJhY2tub3dsZWRnZVwiKX0sby5idXR0b25ncm91cC5hd2FpdGluZ3VzZXJzcmVzcG9uc2U9ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJhd2FpdGluZ3VzZXJzcmVzcG9uc2VcIil9LG8uYnV0dG9uZ3JvdXAuYXNzaWduVG9TZWxmPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiYXNzaWdudG9zZWxmXCIpfX1dKTsiXSwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
