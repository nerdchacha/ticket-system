angular.module("ticketSystem",["textAngular","yangular-grid","yg-modal","ui.router","yg-notification","angularjs-dropdown-multiselect","yg-multiselect-grid"]).service("authInterceptor",["$q","$injector","Authentication","HelperFactory",function(t,e,r,l){return{request:function(t){return l.setLoading(!0),t},response:function(e){return l.setLoading(!1),401===e.status&&r.clearUser(),e||t.when(e)},responseError:function(s){return l.setLoading(!1),401===s.status&&(r.clearUser(),e.get("$state").go("users-login.login")),403===s.status&&e.get("$state").go("ticket.my-tickets"),t.reject(s)}}}]).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(t,e,r){r.otherwise("/ticket/my-tickets"),e.state("ticket",{url:"/ticket",controller:"TicketsCtrl",templateUrl:"templates/tickets/tickets.html"}).state("ticket.my-tickets",{url:"/my-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-my-tickets.html"}).state("ticket.to-me-tickets",{url:"/tome-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-tome-tickets.html"}).state("ticket.all-tickets",{url:"/all-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-all-tickets.html"}).state("dashboard",{url:"/ticket/dashboard",controller:"DashboardCtrl",templateUrl:"templates/tickets/dashboard.html"}).state("dashboard-to-view",{url:"/ticket/dashboard/:type/:value",controller:"DashboardToViewCtrl",templateUrl:"templates/tickets/dashboard-to-view.html"}).state("ticket-new",{url:"/ticket/new",controller:"NewTicketCtrl",templateUrl:"templates/tickets/new-ticket.html"}).state("ticket-view",{url:"/ticket/view/:id",controller:"ViewTicketCtrl",templateUrl:"templates/tickets/view-ticket.html"}).state("ticket-edit",{url:"/ticket/edit/:id",controller:"EditTicketCtrl",templateUrl:"templates/tickets/edit-ticket.html"}).state("users-login",{url:"/users",controller:"MainLoginCtrl",templateUrl:"templates/users/user-login.html"}).state("users-login.login",{url:"/login",controller:"LoginCtrl",templateUrl:"templates/users/login.html"}).state("users-login.register",{url:"/register",controller:"RegisterCtrl",templateUrl:"templates/users/register.html"}).state("users-profile",{url:"/users/profile",controller:"ProfileCtrl",templateUrl:"templates/users/profile.html"}).state("change-password",{url:"/users/profile/change-password/:id",controller:"ChangePasswordCtrl",templateUrl:"templates/users/change-password.html"}).state("users-register",{url:"/users/register",controller:"RegisterCtrl",templateUrl:"templates/users/register.html"}).state("admin-user-management",{url:"/admin/user-management",controller:"UsersListCtrl",templateUrl:"templates/admin/manage-users.html"}).state("auth-google",{url:"/auth/google/:id/:email",controller:"SetUserCtrl",templateUrl:"templates/users/set-username.html"}).state("admin-edit",{url:"/admin/edit/:username",controller:"EditUsersCtrl",templateUrl:"templates/admin/edit-user.html"}).state("admin-reset-password",{url:"/admin/reset-password/:id",controller:"ChangeUsersPasswordCtrl",templateUrl:"templates/admin/reset-password.html"}).state("queue-management",{url:"/admin/queue-management",controller:"QueueManagementCtrl",templateUrl:"templates/admin/queue-management.html"}),t.interceptors.push("authInterceptor")}]);
angular.module("ticketSystem").directive("ygToggle",function(){return{restrict:"E",scope:{toggle:"="},replace:!0,template:'<div ng-show="loaded" class="toggle-button"><div class="toggle"></div></div>',link:function(e,t,i){var l=function(i){e.loaded=!0,i?t.addClass("is-active"):t.removeClass("is-active")};e.$watch("toggle.value",function(e,t){"undefined"!=typeof e&&l(e)}),t.on("click",function(){e.toggle.value=!e.toggle.value,l(e.toggle.value)})}}}).directive("ygSpinner",["HelperFactory",function(e){return{restrict:"E",template:'<div class="loading" ng-show="loading()"></div>',scope:{},link:function(t,i,l,n){t.loading=e.getLoading}}}]);
angular.module("ticketSystem").factory("TicketFactory",["$http",function(t){var e={};return e.createNewTicket=function(e){return t.post("tickets/new",e)},e.updateTicket=function(e,i){return t.put("tickets/"+e,i)},e.getTicketById=function(e){return t.get("tickets/"+e)},e.getInitialTicketData=function(e){return t.get("tickets/edit-ticket/initial-load/"+e)},e.getDashboardData=function(){return t.get("support/tickets/dashboard")},e}]);
angular.module("ticketSystem").factory("CommonFactory",["$http",function(t){var e={};return e.getInitialStaticData=function(){return t.get("tickets/static-data")},e}]).filter("reverse",function(){return function(t){if(t)return t.slice().reverse()}});
angular.module("ticketSystem").factory("UserFactory",["$http",function(e){var r={};return r.login=function(r,t,s){return e.post("accounts/login",{username:r,password:t,remember:s})},r.logout=function(){return e.get("accounts/logout")},r.registerUser=function(r){return e.post("accounts/register",r)},r.getUserByUsername=function(r){return e.get("users/profile/"+r)},r.updateProfile=function(r){return e.post("users/profile/"+r.username,r)},r.setUsername=function(r){return e.post("accounts/set-username",r)},r.changePassword=function(r,t){return e.post("users/profile/change-password/"+r,t)},r.getAllUserDetails=function(){return e.get("support/users/users-details")},r.getUserDetails=function(r){return e.get("admin/users/user-details/"+r)},r.updateUserDetails=function(r,t){return e.post("admin/users/update-user/"+r,t)},r.resetPassword=function(r,t){return e.post("admin/users/reset-password/"+r,t)},r}]);
angular.module("ticketSystem").factory("Authentication",function(){var t={};return t.getIsAuthenticated=function(){if(localStorage.getItem("ticketSystemUser"))return!0},t.setUser=function(t){localStorage.setItem("ticketSystemUser",JSON.stringify(t))},t.clearUser=function(){localStorage.removeItem("ticketSystemUser")},t.getUser=function(){return JSON.parse(localStorage.getItem("ticketSystemUser"))},t});
angular.module("ticketSystem").factory("HelperFactory",["Authentication",function(r){var e={},n={};return n.loading=!1,e.createFlashMessage=function(r,e){return r.data.errors?r.data.errors.map(function(r){return{message:r.error,class:"danger"}}):e?[{message:e,class:"success"}]:[]},e.getAllUsersButSelf=function(e){var n=r.getUser().username;return e.filter(function(r){return r.username!==n})},e.removeUserFromUsers=function(r,e){return r.filter(function(r){var n=e.indexOf(r.username)===-1;return n})},e.isCurrentUserAdmin=function(){var e=r.getUser();return e.role.indexOf("Admin")>-1},e.isCurrentUserSupport=function(){var e=r.getUser();return e.role.indexOf("Support")>-1},e.isCurrentUserAdminOrSupport=function(){return e.isCurrentUserAdmin()||e.isCurrentUserSupport()},e.stripHtml=function(r){return r?String(r).replace(/<[^>]+>/gm,""):""},e.getLoading=function(){return n.loading},e.setLoading=function(r){n.loading=r},e.isNullOrUndefined=function(r){return null===r||(void 0===r||void 0)},e}]);
angular.module("ticketSystem").factory("ActionFactory",["$http","$q",function(t,n){var e,o={};return o.setTask=function(t){e=t},o.getTask=function(){return e},o.getAssignees=function(){return t.get("static/all-users")},o.getAllowedStatus=function(n){return t.get("static/allowed-status/"+n)},o.getAllowedButtons=function(e){var o=n.defer();return t.get("static/action-buttons/"+e).then(function(t){var n={};n.assign=t.data.actionButtons.assign,n.comment=t.data.actionButtons.comment,n.changeStatus=t.data.actionButtons.changeStatus,n.reopen=t.data.actionButtons.reopen,n.close=t.data.actionButtons.close,n.acknowledge=t.data.actionButtons.acknowledge,n.awaitingUserResponse=t.data.actionButtons.awaitingUserResponse,n.assignToSelf=t.data.actionButtons.assignToSelf,o.resolve(n)}).catch(function(t){o.reject(t)}),o.promise},o.assign=function(n,e,o,s){return t.post("admin/tickets/assign/"+n,{assignee:e,comment:o,notify:s})},o.changeStatus=function(n,e,o,s){return t.post("admin/tickets/change-status/"+n,{status:e,comment:o,notify:s})},o.awaitingUserResponse=function(n,e,o){return t.post("admin/tickets/awaiting-user-response/"+n,{comment:e,notify:o})},o.reopen=function(n,e,o){return t.post("admin/tickets/re-open/"+n,{comment:e,notify:o})},o.close=function(n,e,o){return t.post("admin/tickets/close/"+n,{comment:e,notify:o})},o.acknowledgeTicket=function(n,e,o){return t.post("admin/tickets/acknowledge/"+n,{comment:e,notify:o})},o.addComment=function(n,e,o){return t.post("tickets/addComment/"+n,{comment:e,notify:o})},o.deleteComment=function(n,e){return t.delete("tickets/deleteComment/"+n.id+"?commentId="+e._id)},o}]);
angular.module("ticketSystem").factory("PaginationService",function(){var e={};return e.GetPager=function(e,t,a){t=t||1,a=a||10;var n,r,i=Math.ceil(e/a);i<=10?(n=1,r=i):t<=6?(n=1,r=10):t+4>=i?(n=i-9,r=i):(n=t-5,r=t+4);var g=(t-1)*a,o=Math.min(g+a-1,e-1),u=new Array(r+1-n).fill(void 0),c=u.map(function(e){return n++});return{totalItems:e,currentPage:t,pageSize:a,totalPages:i,startPage:n,endPage:r,startIndex:g,endIndex:o,pages:c}},e});
angular.module("ticketSystem").controller("MainCtrl",["$scope","$state","Authentication","UserFactory","$window","YgNotify","HelperFactory",function(e,t,i,n,r,o,s){var a=function(){var t=i.getUser();t.role.indexOf("Admin")>-1?e.isAdmin=!0:e.isAdmin=!1,e.isRegularUser=!0,(i.getUser().role.indexOf("Support")>-1||i.getUser().role.indexOf("Admin")>-1)&&(e.isRegularUser=!1)};e.init=function(){var t=i.getUser();t&&(t.role.indexOf("Admin")>-1?e.isAdmin=!0:e.isAdmin=!1)},e.getUser=i.getUser,e.isAuthenticated=i.getIsAuthenticated,e.logout=function(){n.logout().then(function(){i.clearUser(),t.go("users-login.login")})},e.$on("successful-login",a),e.getProfile=function(){t.go("users-profile")},r.app={},r.app.auth=function(n,r){""!==n?o.alert("danger",n.toString(),5e3):r.username&&""!==r.username?r&&(i.setUser(r),a(),e.isRegularUser?t.go("ticket.my-tickets"):t.go("dashboard")):t.go("auth-google",{id:r._id.toString(),email:r.email})}}]);
angular.module("ticketSystem").controller("NavCtrl",["$scope",function(a){a.navClass="",a.toggleNav=function(s){var e=angular.element(s.target);e.hasClass("is-open")?a.navClass="is-close":a.navClass="is-open"},a.navClick=function(s){a.navClass="a"===s.target.tagName.toLowerCase()?"is-close":a.navClass}}]);
angular.module("ticketSystem").controller("UsersListCtrl",["$scope","$state","$stateParams","HelperFactory","YgNotify",function(e,s,a,r,t){var i=function(){return""},n=function(e){return e===!0?"fa fa-check":"fa fa-remove"},o=function(){return""},u=function(e){return e.indexOf("Admin")>-1?"fa fa-check":"fa fa-remove"};e.config={},e.config.url="/support/users/users-details",e.config.columns=[],e.config.columns.push({key:"username",name:"Username",cssClass:"col-md-6"}),e.config.columns.push({key:"isActive",name:"Is Active",cssClass:"col-md-3",render:i,renderClass:n}),e.config.columns.push({key:"role",name:"Is Admin",cssClass:"col-md-3",render:o,renderClass:u}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.objectName="users",e.config.onRowClick=function(e){s.go("admin-edit",{username:e.username})}}]).controller("EditUsersCtrl",["$scope","$state","$stateParams","HelperFactory","UserFactory","YgNotify",function(e,s,a,r,t,i){e.isActive={},e.isAdmin={},e.isSupport={},e.userDetails={};var n=a.username;t.getUserDetails(n).then(function(s){e.userDetails.username=s.data.user.username,e.userDetails.firstname=s.data.user.firstname,e.userDetails.lastname=s.data.user.lastname,e.userDetails.id=s.data.user._id;var a=s.data.user.role;e.userDetails.isAdmin=a.indexOf("Admin")>-1,e.userDetails.isSupport=a.indexOf("Support")>-1,e.userDetails.isActive=s.data.user.isActive,e.userDetails.email=s.data.user.email,e.isActive.key="isActive",e.isActive.value=e.userDetails.isActive,e.isAdmin.key="isAdmin",e.isAdmin.value=e.userDetails.isAdmin,e.isSupport.key="isSupport",e.isSupport.value=e.userDetails.isSupport}).catch(function(e){i.alert("danger","There was some error trying to fetch user details. Please try again after some time.",5e3)}),e.userDetails.update=function(){return e.editUserForm.$invalid?(e.editUserForm.firstname.$touched=!0,e.editUserForm.lastname.$touched=!0,void(e.editUserForm.email.$touched=!0)):(e.userDetails.isAdmin=e.isAdmin.value,e.userDetails.isActive=e.isActive.value,e.userDetails.isSupport=e.isSupport.value,void t.updateUserDetails(e.userDetails.username,e.userDetails).then(function(e){r.createFlashMessage(e,"User details updated successfully").forEach(function(e){i.alert(e.class,e.message,5e3)})}).catch(function(e){i.alert("danger","There was some error trying to update user details. Please try again after some time.",5e3)}))}}]).controller("ChangeUsersPasswordCtrl",["$scope","$state","$stateParams","HelperFactory","UserFactory","YgNotify",function(e,s,a,r,t,i){e.changePassword={},e.changePassword.title="Reset Password",e.changePassword.saveTitle="Reset",e.changePassword.cancelHref="#/admin/user-management",e.changePassword.save=function(s){if(s.$invalid)return s.password2.$touched=!0,void(s.password1.$touched=!0);var n=a.id;t.resetPassword(n,e.changePassword).then(function(e){r.createFlashMessage(e,"Password has been reset successfully").forEach(function(e){i.alert(e.class,e.message,5e3)})}).catch(function(e){i.alert("danger","The request could not ben made successfully. Please try later",5e3)})}}]);
angular.module("ticketSystem").controller("QueueManagementCtrl",["$scope","PaginationService",function(e,u){function n(){e.setPage(1)}function d(n){n<1||n>e.pager.totalPages||(e.pager=u.GetPager(e.queues.length,n),e.items=e.queues.slice(e.pager.startIndex,e.pager.endIndex+1))}e.queues=[],e.pager={},e.setPage=d,n(),e.showAddQueuePanel=function(){e.showAddQueue=!0},e.hideAddQueuePanel=function(){e.showAddQueue=!1,e.addQueueForm.newQueue.$touched=!1,e.newQueue=""},e.addQueue=function(){if(e.addQueueForm.$invalid)return void(e.addQueueForm.newQueue.$touched=!0)}}]);
angular.module("ticketSystem").controller("DashboardCtrl",["$scope","$state","YgNotify","TicketFactory",function(e,t,n,o){var a=function(e){return new Date(Date.parse(e)).toLocaleDateString()},s=function(e){return e?String(e).replace(/<[^>]+>/gm,""):""},r=function(e){return e?e:"Unassigned"};e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:s}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"assignee",name:"Assignee",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:a}),e.config.columns.push({key:"createdBy",name:"Created By",cssClass:"col-md-2"}),e.config.url="/support/tickets/open-within-day",e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){t.go("ticket-view",{id:e.id})},e.config.objectName="tickets",o.getDashboardData().then(function(e){var n=e.data.tickets,o=document.getElementById("statusChart"),a=new Chart(o,{type:"doughnut",data:{labels:["New","Open","In-Progress","Awaiting User Response"],datasets:[{data:[n.new.count,n.open.count,n.inProgress.count,n.awaitingUserResponse.count],backgroundColor:["#039BE5","#F44336","#FFB300","#43A047"],hoverBackgroundColor:["#039BE5","#F44336","#FFB300","#43A047"]}]},options:{legend:{labels:{boxWidth:12,fontSize:10}}}}),s=document.getElementById("typeChart"),r=new Chart(s,{type:"doughnut",data:{labels:["Bug","Need Info","Improvement"],datasets:[{data:[n.bug.count,n.needInfo.count,n.improvement.count],backgroundColor:["#F44336","#039BE5","#FFB300"],hoverBackgroundColor:["#F44336","#039BE5","#FFB300"]}]},options:{legend:{labels:{boxWidth:12,fontSize:10}}}}),l=document.getElementById("priorityChart"),c=new Chart(l,{type:"doughnut",data:{labels:["High","Medium","Low"],datasets:[{data:[n.high.count,n.medium.count,n.low.count],backgroundColor:["#F44336","#FFB300","#43A047"],hoverBackgroundColor:["#F44336","#FFB300","#43A047"]}]},options:{legend:{labels:{boxWidth:12,fontSize:10}}}});angular.element(o).on("click",function(e){var n=a.getElementsAtEvent(e);n&&n.length>0&&n[0]._model.label&&t.go("dashboard-to-view",{type:"status",value:n[0]._model.label})}),angular.element(s).on("click",function(e){var n=r.getElementsAtEvent(e);n&&n.length>0&&n[0]._model.label&&t.go("dashboard-to-view",{type:"type",value:n[0]._model.label})}),angular.element(l).on("click",function(e){var n=c.getElementsAtEvent(e);n&&n.length>0&&n[0]._model.label&&t.go("dashboard-to-view",{type:"priority",value:n[0]._model.label})})}).catch(function(e){n.alert("danger","An error occurred while trying to fetch the dashboard data. Please try again later.",5e3)})}]);
angular.module("ticketSystem").controller("DashboardToViewCtrl",["$scope","$state","$stateParams","YgNotify","TicketFactory",function(e,s,n,o,t){function c(e){return new Date(Date.parse(e)).toLocaleDateString()}function i(e){return e?String(e).replace(/<[^>]+>/gm,""):""}function r(e){return e?e:"None"}e.type=n.type,e.value=n.value,e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:i}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"status",name:"Status",cssClass:"col-md-2"}),e.config.columns.push({key:"priority",name:"Priority",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:c}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){s.go("ticket-view",{id:e.id})},e.config.objectName="tickets",e.config.url="/support/tickets/"+n.type+"/"+n.value}]);
angular.module("ticketSystem").controller("DeleteCommentCtrl",["$scope","YgNotify","HelperFactory","YgModal","ActionFactory",function(e,t,n,o,r){var c=function(o,c){return function(){r.deleteComment(o,c).then(function(o){n.createFlashMessage(o,"The comment was deleted successfully").forEach(function(e){t.alert(e.class,e.message,5e3)}),o.data.errors||(e.ticket.comments=o.data.comments)}).catch(function(e){t.alert("danger","An error occurred while trying to delete comment. Please try again later.",5e3)})}};e.deleteComment=function(e,t){o.confirm(c(e,t)),o.open("Are you sure you want to do this?","This will delete the comment permanently")}}]);
angular.module("ticketSystem").controller("EditTicketCtrl",["$scope","$stateParams","$state","TicketFactory","YgNotify","HelperFactory","Authentication",function(t,e,a,r,i,c,n){t.toolbarConfig=[["h1","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],[],["insertLink"]],t.cancel=function(){a.go("ticket-view",{id:t.ticket.id})},t.renderDate=function(t){return new Date(Date.parse(t)).toLocaleDateString()},r.getTicketById(e.id).then(function(e){if(e.data.errors){a.go("ticket.my-tickets");var o=c.createErrorMessage(e.data.errors);o.forEach(function(t){i.alert("danger",t,5e3)})}else t.ticket=e.data.ticket,t.ticket.currentUser=n.getUser().username,r.getInitialTicketData(t.ticket.status).then(function(e){t.priorities=e.data.priorities.values,t.types=e.data.types.values,t.users=e.data.users,t.statuses=e.data.statuses}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to fetch the static data.",5e3)})}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to get ticket details. Please try again later.",5e3)}),t.update=function(){r.updateTicket(t.ticket._id,t.ticket).then(function(e){t.ticket=e.data,i.alert("success","Ticket updated successfully.",5e3),a.go("ticket-view",{id:e.data.id})}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to update ticket details. Please try again later.",5e3)})}}]);
angular.module("ticketSystem").controller("NewTicketCtrl",["$scope","$state","TicketFactory","YgNotify","CommonFactory","HelperFactory",function(e,t,i,c,n,o){n.getInitialStaticData().then(function(t){e.newTicket.types=t.data.types.values,e.newTicket.type=e.newTicket.types[0].value}),e.newTicket={},e.toolbarConfig=[["h1","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],[],["insertLink"]],e.save=function(){return e.newTicketForm.$invalid?(e.newTicketForm.title.$touched=!0,void(e.newTicketForm.description.$touched=!0)):void i.createNewTicket({title:e.newTicket.title,description:e.newTicket.description,type:e.newTicket.type}).then(function(e){o.createFlashMessage(e,"The ticket has been created successfully").forEach(function(e){c.alert(e.class,e.message,5e3)}),e.data.id&&t.go("ticket-view",{id:e.data.id})},function(e){c.alert("danger","An error occurred while trying to create new ticket. Please try again later.",5e3),console.log(e)})}}]);

angular.module("ticketSystem").controller("TicketsCtrl",["$scope","$state","agSortFactory","HelperFactory",function(e,t,n,i){e.isSupport=!1;var c=JSON.parse(localStorage.getItem("ticketSystemUser"));c&&(c.role.indexOf("Admin")>-1||c.role.indexOf("Support")>-1)&&(e.isSupport=!0);var s=function(e){return new Date(Date.parse(e)).toLocaleDateString()},o=function(e){return e?String(e).replace(/<[^>]+>/gm,""):""},r=function(e){return e?e:"Unassigned"};e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:o}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"assignee",name:"Assignee",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:s}),e.config.columns.push({key:"createdBy",name:"Created By",cssClass:"col-md-2"}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){t.go("ticket-view",{id:e.id})},e.config.objectName="tickets",e.initiateAllTicket=function(){e.config.url="/tickets/all",e.$parent.active="all"},e.initiateMyTicket=function(){e.config.url="/tickets/my",e.$parent.active="my"},e.initiateToMeTicket=function(){e.config.url="/tickets/to-me",e.$parent.active="tome"}}]);
angular.module("ticketSystem").controller("ViewTicketCtrl",["$scope","$stateParams","$state","TicketFactory","YgNotify","Authentication","HelperFactory",function(e,t,r,i,n,s,a){function c(e,t){switch(e=e||"",t.success=t.success||"",t.warning=t.warning||"",t.danger=t.danger||"",t.info=t.info||"",e.toLowerCase()){case t.success.toLowerCase():return"success";case t.warning.toLowerCase():return"warning";case t.danger.toLowerCase():return"danger";case t.info.toLowerCase():return"info";default:return"info"}}function o(e){return c(e,{success:"in-progress",warning:"open",info:"new",danger:"resolved"})}function u(e){return c(e,{success:"low",warning:"medium",danger:"high"})}function d(e){return e.assignee===e.currentUser||(e.createdBy===e.currentUser||(!!a.isCurrentUserAdmin()||!!a.isCurrentUserSupport()))}i.getTicketById(t.id).then(function(t){a.createFlashMessage(t).forEach(function(e){n.alert(e.class,e.message,5e3)}),t.data.errors||(e.ticket=t.data.ticket,e.ticket.description=a.stripHtml(e.ticket.description),e.ticket.assignee=e.ticket.assignee?e.ticket.assignee:"Unassigned",e.ticket.createdDate=e.renderDate(e.ticket.createdDate),e.ticket.currentUser=s.getUser().username,e.statusClass=o(e.ticket.status),e.ticket.priority=e.ticket.priority||"N.A",e.priorityClass=u(e.ticket.priority),d(e.ticket)&&(e.showEdit=!0))}).catch(function(e){n.alert("danger","An error occurred while trying to get ticket details. Please try again later.",5e3)}),e.ticket={},e.edit=function(){r.go("ticket-edit",{id:e.ticket.id})},e.renderDate=function(e){return new Date(Date.parse(e)).toLocaleDateString()}}]);
angular.module("ticketSystem").controller("ChangePasswordCtrl",["$scope","$state","$stateParams","UserFactory","HelperFactory","YgNotify",function(e,s,a,r,o,t){e.changePassword={},e.changePassword.title="Change Password",e.changePassword.saveTitle="Change Password",e.changePassword.cancelHref="#/users/profile",e.changePassword.save=function(c){if(c.$invalid)return c.password2.$touched=!0,void(c.password1.$touched=!0);var n=a.id;r.changePassword(n,e.changePassword).then(function(e){o.createFlashMessage(e,"The password has been changed successfully").forEach(function(e){t.alert(e.class,e.message,5e3)}),e.data.errors||s.go("users-profile")}).catch(function(e){t.alert("danger","The request could not ben made successfully. Please try later",5e3)})}}]);
angular.module("ticketSystem").controller("LoginCtrl",["$scope","$state","$window","UserFactory","Authentication","HelperFactory",function(e,t,o,r,i,n){i.getUser()&&t.go("ticket.my-tickets"),e.error=!1,e.message="",e.login=function(){r.login(e.username,e.password,e.remember).then(function(o){o.data.isAuthenticated?(i.setUser(o.data.user),e.$emit("successful-login"),n.isCurrentUserAdminOrSupport()?t.go("dashboard"):t.go("ticket.my-tickets")):(e.error=!0,e.message=o.data.msg)}).catch(function(t){e.error=!0,e.message="An error occurred while trying to log you in. Please try again later"})},e.googleLogin=function(){var e="accounts/auth/google",t=600,r=450,i=(window.outerHeight-r)/2,n=(window.outerWidth-t)/2;o.open(e,"facebook_login","width="+t+",height="+r+",scrollbars=0,top="+i+",left="+n)}}]);
angular.module("ticketSystem").controller("MainLoginCtrl",["$rootScope","$scope","$state",function(t,e,n){e.statename=n.current.name,t.$on("$stateChangeStart",function(t,n,a,o,r){e.statename=n.name})}]);
angular.module("ticketSystem").controller("ProfileCtrl",["$scope","$state","Authentication","UserFactory","HelperFactory","YgNotify",function(e,a,r,s,t,u){e.user={},e.init=function(){s.getUserByUsername(r.getUser().username).then(function(a){t.createFlashMessage(a).forEach(function(e){u.alert(e.class,e.message,5e3)}),a.data.errors||(e.user.firstname=a.data.user.firstname,e.user.lastname=a.data.user.lastname,e.user.username=a.data.user.username,e.user.email=a.data.user.email,e.user.userId=a.data.user._id)})},e.update=function(){return e.profileForm.$invalid?(e.profileForm.firstname.$touched=!0,e.profileForm.lastname.$touched=!0,void(e.profileForm.email.$touched=!0)):(t.setLoading(!0),void s.updateProfile(e.user).then(function(a){t.createFlashMessage(a,"User details have been updated successfully").forEach(function(e){u.alert(e.class,e.message,5e3)}),a.data.errors||(e.user.firstname=a.data.user.firstname,e.user.lastname=a.data.user.lastname,e.user.username=a.data.user.username,e.user.email=a.data.user.email,e.user.role=a.data.user.role,r.setUser(e.user))}).catch(function(e){u.alert("danger","There was some error trying to update user details. Please try again after some time.",5e3)}))}}]);
angular.module("ticketSystem").controller("RegisterCtrl",["$scope","$state","UserFactory","HelperFactory","YgNotify",function(e,r,t,s,a){e.newUser={},e.register=function(){t.registerUser(e.newUser).then(function(e){s.createFlashMessage(e,"User has been created successfully. You can now login.").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.data.errors&&r.go("users-login.login")}).catch(function(e){a.alert("danger","There was some error trying to create the user. Please try again after some time.",5e3)})}}]);
angular.module("ticketSystem").controller("SetUserCtrl",["$scope","$stateParams","$state","UserFactory","YgNotify","Authentication",function(e,s,t,a,r,n){var c=s.id,o=s.email;e.setUsername={},e.setUsername.email=o,e.saveUsername=function(){a.setUsername({id:c,username:e.setUsername.username}).then(function(s){HelperFactory.createFlashMessage(s,"Username has been set successfully.").forEach(function(e){r.alert(e.class,e.message,5e3)}),s.data.errors||(n.setUser(s.data.user),e.$emit("successful-login"),t.go("ticket.my-tickets"))}).catch(function(e){r.alert("danger","There was some error trying to set the username. Please try again after some time.",5e3)})}}]);
angular.module("ticketSystem").controller("ActionsCtrl",["$scope","ActionFactory","HelperFactory","UserFactory","YgNotify","$rootScope",function(e,t,a,s,n,c){e.getTask=t.getTask,e.task={},s.getAllUserDetails().then(function(t){var a=t.data.users;e.task.allUsers=a,e.task.notifyUsers=[],e.task.multiselectOptions={smartButtonMaxItems:4,displayProp:"username",idProp:"username"}}).catch(function(e){n.alert("danger","There was some error trying to get the list of all the users. Please try again after some time.",5e3)}),e.task.showTaskPanel=!1,e.task.showMainPanel=!1,t.setTask(null),e.setSaveFn=function(t){e.saveTask=t},e.cancelTask=function(){t.setTask(null),e.task.comment="",e.task.showTaskPanel=!1,e.task.showMainPanel=!1},e.setSaveBtnName=function(t){e.saveBtnName=t},e.$watch("getTask()",function(t,a){if(e.task.name=null,t)switch(e.task.showTaskPanel=!0,e.task.showMainPanel=!0,e.task.name="templates/partials/action/"+t+"-action-partial.html",t){case"comment":e.task.title="Add new comment";break;case"awaitingusersresponse":e.task.title="Awaiting users response";break;case"close":e.task.title="Close ticket";break;case"reopen":e.task.title="Reopen ticket";break;case"acknowledge":e.task.title="Acknowledge ticket";break;case"assign":e.task.title="Assign ticket";break;case"changestatus":e.task.title="Change ticket status";break;case"assigntoself":e.task.title="Assign to self"}})}]).controller("AssignActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){console.log("set assignee"),t.getAssignees().then(function(t){e.users=t.data.users,e.users=s.removeUserFromUsers(e.users,[e.ticket.createdBy,e.ticket.assignee]),e.assignee=e.users[0].username}),e.setSaveFn(function(){return e.actionForm.comment.$invalid||e.actionForm.assignee.$invalid?(e.actionForm.comment.$touched=!0,void(e.actionForm.assignee.$touched=!0)):(console.log(e.task.notifyUsers),void t.assign(e.ticket.id,e.assignee,e.task.comment,e.task.notifyUsers).then(function(t){s.createFlashMessage(t,"The assignee has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.assignee=t.data.assignee),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to assign the ticket. Please try again after some time.",5e3),e.cancelTask()}))}),e.setSaveBtnName("Assign Ticket")}]).controller("ChangeStatusActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){var n=e.ticket.status;t.getAllowedStatus(n).then(function(t){console.log(t.data),e.allowedStatus=t.data.status.allowed,e.newStatus=e.allowedStatus[0]}),e.setSaveFn(function(){return e.actionForm.comment.$invalid||e.actionForm.newStatus.$invalid?(e.actionForm.comment.$touched=!0,void(e.actionForm.newStatus.$touched=!0)):void t.changeStatus(e.ticket.id,e.newStatus,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Change Status")}]).controller("CommentActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.addComment(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,s.createFlashMessage(t,"The comment has been added successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to add comment. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Add Comment")}]).controller("CloseActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.close(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Close")}]).controller("ReopenActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.reopen(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Reopen")}]).controller("AwaitingActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.awaitingUserResponse(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.status=t.data.status),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Change Status")}]).controller("AcknowledgeActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.acknowledgeTicket(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Acknowledge Ticket")}]).controller("AssignToSelfActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory","Authentication",function(e,t,a,s,n){e.setSaveFn(function(){if(e.actionForm.comment.$invalid)return void(e.actionForm.comment.$touched=!0);var c=n.getUser();t.assign(e.ticket.id,c.username,e.task.comment,e.task.notifyUsers).then(function(t){s.createFlashMessage(t,"The assignee has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.assignee=t.data.assignee),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to assign the ticket. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Assign To Self")}]);
angular.module("ticketSystem").controller("ButtonGroupCtrl",["$scope","ActionFactory","HelperFactory",function(o,t,n){o.buttongroup={},o.$watchCollection("ticket",function(s){s&&!n.isNullOrUndefined(s.id)&&(n.isCurrentUserAdminOrSupport()?t.getAllowedButtons(s.id).then(function(t){o.buttongroup.showAssign=t.assign,o.buttongroup.showComment=t.comment,o.buttongroup.showchangeStatus=t.changeStatus,o.buttongroup.showReopen=t.reopen,o.buttongroup.showClose=t.close,o.buttongroup.showAcknowledge=t.acknowledge,o.buttongroup.showAwaitingUsersResponse=t.awaitingUserResponse,o.buttongroup.showAssignToSelf=t.assignToSelf}):(o.buttongroup.showComment=!0,o.buttongroup.showAssign=!1,o.buttongroup.showchangeStatus=!1,o.buttongroup.showReopen=!1,o.buttongroup.showClose=!1,o.buttongroup.showAcknowledge=!1,o.buttongroup.showAwaitingUsersResponse=!1,o.buttongroup.showAssignToSelf=!1))}),o.buttongroup.comment=function(){t.setTask("comment")},o.buttongroup.assign=function(){t.setTask("assign")},o.buttongroup.changeStatus=function(){t.setTask("changestatus")},o.buttongroup.close=function(){t.setTask("close")},o.buttongroup.reopen=function(){t.setTask("reopen")},o.buttongroup.acknowledge=function(){t.setTask("acknowledge")},o.buttongroup.awaitingusersresponse=function(){t.setTask("awaitingusersresponse")},o.buttongroup.assignToSelf=function(){t.setTask("assigntoself")}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiLFtcInRleHRBbmd1bGFyXCIsXCJ5YW5ndWxhci1ncmlkXCIsXCJ5Zy1tb2RhbFwiLFwidWkucm91dGVyXCIsXCJ5Zy1ub3RpZmljYXRpb25cIixcImFuZ3VsYXJqcy1kcm9wZG93bi1tdWx0aXNlbGVjdFwiLFwieWctbXVsdGlzZWxlY3QtZ3JpZFwiXSkuc2VydmljZShcImF1dGhJbnRlcmNlcHRvclwiLFtcIiRxXCIsXCIkaW5qZWN0b3JcIixcIkF1dGhlbnRpY2F0aW9uXCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24odCxlLHIsbCl7cmV0dXJue3JlcXVlc3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGwuc2V0TG9hZGluZyghMCksdH0scmVzcG9uc2U6ZnVuY3Rpb24oZSl7cmV0dXJuIGwuc2V0TG9hZGluZyghMSksNDAxPT09ZS5zdGF0dXMmJnIuY2xlYXJVc2VyKCksZXx8dC53aGVuKGUpfSxyZXNwb25zZUVycm9yOmZ1bmN0aW9uKHMpe3JldHVybiBsLnNldExvYWRpbmcoITEpLDQwMT09PXMuc3RhdHVzJiYoci5jbGVhclVzZXIoKSxlLmdldChcIiRzdGF0ZVwiKS5nbyhcInVzZXJzLWxvZ2luLmxvZ2luXCIpKSw0MDM9PT1zLnN0YXR1cyYmZS5nZXQoXCIkc3RhdGVcIikuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKSx0LnJlamVjdChzKX19fV0pLmNvbmZpZyhbXCIkaHR0cFByb3ZpZGVyXCIsXCIkc3RhdGVQcm92aWRlclwiLFwiJHVybFJvdXRlclByb3ZpZGVyXCIsZnVuY3Rpb24odCxlLHIpe3Iub3RoZXJ3aXNlKFwiL3RpY2tldC9teS10aWNrZXRzXCIpLGUuc3RhdGUoXCJ0aWNrZXRcIix7dXJsOlwiL3RpY2tldFwiLGNvbnRyb2xsZXI6XCJUaWNrZXRzQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvdGlja2V0cy5odG1sXCJ9KS5zdGF0ZShcInRpY2tldC5teS10aWNrZXRzXCIse3VybDpcIi9teS10aWNrZXRzXCIsY29udHJvbGxlcjpcIlRpY2tldHNDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy92aWV3LW15LXRpY2tldHMuaHRtbFwifSkuc3RhdGUoXCJ0aWNrZXQudG8tbWUtdGlja2V0c1wiLHt1cmw6XCIvdG9tZS10aWNrZXRzXCIsY29udHJvbGxlcjpcIlRpY2tldHNDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy92aWV3LXRvbWUtdGlja2V0cy5odG1sXCJ9KS5zdGF0ZShcInRpY2tldC5hbGwtdGlja2V0c1wiLHt1cmw6XCIvYWxsLXRpY2tldHNcIixjb250cm9sbGVyOlwiVGlja2V0c0N0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL3ZpZXctYWxsLXRpY2tldHMuaHRtbFwifSkuc3RhdGUoXCJkYXNoYm9hcmRcIix7dXJsOlwiL3RpY2tldC9kYXNoYm9hcmRcIixjb250cm9sbGVyOlwiRGFzaGJvYXJkQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvZGFzaGJvYXJkLmh0bWxcIn0pLnN0YXRlKFwiZGFzaGJvYXJkLXRvLXZpZXdcIix7dXJsOlwiL3RpY2tldC9kYXNoYm9hcmQvOnR5cGUvOnZhbHVlXCIsY29udHJvbGxlcjpcIkRhc2hib2FyZFRvVmlld0N0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL2Rhc2hib2FyZC10by12aWV3Lmh0bWxcIn0pLnN0YXRlKFwidGlja2V0LW5ld1wiLHt1cmw6XCIvdGlja2V0L25ld1wiLGNvbnRyb2xsZXI6XCJOZXdUaWNrZXRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy9uZXctdGlja2V0Lmh0bWxcIn0pLnN0YXRlKFwidGlja2V0LXZpZXdcIix7dXJsOlwiL3RpY2tldC92aWV3LzppZFwiLGNvbnRyb2xsZXI6XCJWaWV3VGlja2V0Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvdmlldy10aWNrZXQuaHRtbFwifSkuc3RhdGUoXCJ0aWNrZXQtZWRpdFwiLHt1cmw6XCIvdGlja2V0L2VkaXQvOmlkXCIsY29udHJvbGxlcjpcIkVkaXRUaWNrZXRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy9lZGl0LXRpY2tldC5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLWxvZ2luXCIse3VybDpcIi91c2Vyc1wiLGNvbnRyb2xsZXI6XCJNYWluTG9naW5DdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvdXNlci1sb2dpbi5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLWxvZ2luLmxvZ2luXCIse3VybDpcIi9sb2dpblwiLGNvbnRyb2xsZXI6XCJMb2dpbkN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9sb2dpbi5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLWxvZ2luLnJlZ2lzdGVyXCIse3VybDpcIi9yZWdpc3RlclwiLGNvbnRyb2xsZXI6XCJSZWdpc3RlckN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9yZWdpc3Rlci5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLXByb2ZpbGVcIix7dXJsOlwiL3VzZXJzL3Byb2ZpbGVcIixjb250cm9sbGVyOlwiUHJvZmlsZUN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9wcm9maWxlLmh0bWxcIn0pLnN0YXRlKFwiY2hhbmdlLXBhc3N3b3JkXCIse3VybDpcIi91c2Vycy9wcm9maWxlL2NoYW5nZS1wYXNzd29yZC86aWRcIixjb250cm9sbGVyOlwiQ2hhbmdlUGFzc3dvcmRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvY2hhbmdlLXBhc3N3b3JkLmh0bWxcIn0pLnN0YXRlKFwidXNlcnMtcmVnaXN0ZXJcIix7dXJsOlwiL3VzZXJzL3JlZ2lzdGVyXCIsY29udHJvbGxlcjpcIlJlZ2lzdGVyQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3VzZXJzL3JlZ2lzdGVyLmh0bWxcIn0pLnN0YXRlKFwiYWRtaW4tdXNlci1tYW5hZ2VtZW50XCIse3VybDpcIi9hZG1pbi91c2VyLW1hbmFnZW1lbnRcIixjb250cm9sbGVyOlwiVXNlcnNMaXN0Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL2FkbWluL21hbmFnZS11c2Vycy5odG1sXCJ9KS5zdGF0ZShcImF1dGgtZ29vZ2xlXCIse3VybDpcIi9hdXRoL2dvb2dsZS86aWQvOmVtYWlsXCIsY29udHJvbGxlcjpcIlNldFVzZXJDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvc2V0LXVzZXJuYW1lLmh0bWxcIn0pLnN0YXRlKFwiYWRtaW4tZWRpdFwiLHt1cmw6XCIvYWRtaW4vZWRpdC86dXNlcm5hbWVcIixjb250cm9sbGVyOlwiRWRpdFVzZXJzQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL2FkbWluL2VkaXQtdXNlci5odG1sXCJ9KS5zdGF0ZShcImFkbWluLXJlc2V0LXBhc3N3b3JkXCIse3VybDpcIi9hZG1pbi9yZXNldC1wYXNzd29yZC86aWRcIixjb250cm9sbGVyOlwiQ2hhbmdlVXNlcnNQYXNzd29yZEN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy9hZG1pbi9yZXNldC1wYXNzd29yZC5odG1sXCJ9KS5zdGF0ZShcInF1ZXVlLW1hbmFnZW1lbnRcIix7dXJsOlwiL2FkbWluL3F1ZXVlLW1hbmFnZW1lbnRcIixjb250cm9sbGVyOlwiUXVldWVNYW5hZ2VtZW50Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL2FkbWluL3F1ZXVlLW1hbmFnZW1lbnQuaHRtbFwifSksdC5pbnRlcmNlcHRvcnMucHVzaChcImF1dGhJbnRlcmNlcHRvclwiKX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmRpcmVjdGl2ZShcInlnVG9nZ2xlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsc2NvcGU6e3RvZ2dsZTpcIj1cIn0scmVwbGFjZTohMCx0ZW1wbGF0ZTonPGRpdiBuZy1zaG93PVwibG9hZGVkXCIgY2xhc3M9XCJ0b2dnbGUtYnV0dG9uXCI+PGRpdiBjbGFzcz1cInRvZ2dsZVwiPjwvZGl2PjwvZGl2PicsbGluazpmdW5jdGlvbihlLHQsaSl7dmFyIGw9ZnVuY3Rpb24oaSl7ZS5sb2FkZWQ9ITAsaT90LmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpOnQucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIil9O2UuJHdhdGNoKFwidG9nZ2xlLnZhbHVlXCIsZnVuY3Rpb24oZSx0KXtcInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmbChlKX0pLHQub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7ZS50b2dnbGUudmFsdWU9IWUudG9nZ2xlLnZhbHVlLGwoZS50b2dnbGUudmFsdWUpfSl9fX0pLmRpcmVjdGl2ZShcInlnU3Bpbm5lclwiLFtcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsdGVtcGxhdGU6JzxkaXYgY2xhc3M9XCJsb2FkaW5nXCIgbmctc2hvdz1cImxvYWRpbmcoKVwiPjwvZGl2Picsc2NvcGU6e30sbGluazpmdW5jdGlvbih0LGksbCxuKXt0LmxvYWRpbmc9ZS5nZXRMb2FkaW5nfX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiVGlja2V0RmFjdG9yeVwiLFtcIiRodHRwXCIsZnVuY3Rpb24odCl7dmFyIGU9e307cmV0dXJuIGUuY3JlYXRlTmV3VGlja2V0PWZ1bmN0aW9uKGUpe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL25ld1wiLGUpfSxlLnVwZGF0ZVRpY2tldD1mdW5jdGlvbihlLGkpe3JldHVybiB0LnB1dChcInRpY2tldHMvXCIrZSxpKX0sZS5nZXRUaWNrZXRCeUlkPWZ1bmN0aW9uKGUpe3JldHVybiB0LmdldChcInRpY2tldHMvXCIrZSl9LGUuZ2V0SW5pdGlhbFRpY2tldERhdGE9ZnVuY3Rpb24oZSl7cmV0dXJuIHQuZ2V0KFwidGlja2V0cy9lZGl0LXRpY2tldC9pbml0aWFsLWxvYWQvXCIrZSl9LGUuZ2V0RGFzaGJvYXJkRGF0YT1mdW5jdGlvbigpe3JldHVybiB0LmdldChcInN1cHBvcnQvdGlja2V0cy9kYXNoYm9hcmRcIil9LGV9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiQ29tbW9uRmFjdG9yeVwiLFtcIiRodHRwXCIsZnVuY3Rpb24odCl7dmFyIGU9e307cmV0dXJuIGUuZ2V0SW5pdGlhbFN0YXRpY0RhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdC5nZXQoXCJ0aWNrZXRzL3N0YXRpYy1kYXRhXCIpfSxlfV0pLmZpbHRlcihcInJldmVyc2VcIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0KXtpZih0KXJldHVybiB0LnNsaWNlKCkucmV2ZXJzZSgpfX0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuZmFjdG9yeShcIlVzZXJGYWN0b3J5XCIsW1wiJGh0dHBcIixmdW5jdGlvbihlKXt2YXIgcj17fTtyZXR1cm4gci5sb2dpbj1mdW5jdGlvbihyLHQscyl7cmV0dXJuIGUucG9zdChcImFjY291bnRzL2xvZ2luXCIse3VzZXJuYW1lOnIscGFzc3dvcmQ6dCxyZW1lbWJlcjpzfSl9LHIubG9nb3V0PWZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0KFwiYWNjb3VudHMvbG9nb3V0XCIpfSxyLnJlZ2lzdGVyVXNlcj1mdW5jdGlvbihyKXtyZXR1cm4gZS5wb3N0KFwiYWNjb3VudHMvcmVnaXN0ZXJcIixyKX0sci5nZXRVc2VyQnlVc2VybmFtZT1mdW5jdGlvbihyKXtyZXR1cm4gZS5nZXQoXCJ1c2Vycy9wcm9maWxlL1wiK3IpfSxyLnVwZGF0ZVByb2ZpbGU9ZnVuY3Rpb24ocil7cmV0dXJuIGUucG9zdChcInVzZXJzL3Byb2ZpbGUvXCIrci51c2VybmFtZSxyKX0sci5zZXRVc2VybmFtZT1mdW5jdGlvbihyKXtyZXR1cm4gZS5wb3N0KFwiYWNjb3VudHMvc2V0LXVzZXJuYW1lXCIscil9LHIuY2hhbmdlUGFzc3dvcmQ9ZnVuY3Rpb24ocix0KXtyZXR1cm4gZS5wb3N0KFwidXNlcnMvcHJvZmlsZS9jaGFuZ2UtcGFzc3dvcmQvXCIrcix0KX0sci5nZXRBbGxVc2VyRGV0YWlscz1mdW5jdGlvbigpe3JldHVybiBlLmdldChcInN1cHBvcnQvdXNlcnMvdXNlcnMtZGV0YWlsc1wiKX0sci5nZXRVc2VyRGV0YWlscz1mdW5jdGlvbihyKXtyZXR1cm4gZS5nZXQoXCJhZG1pbi91c2Vycy91c2VyLWRldGFpbHMvXCIrcil9LHIudXBkYXRlVXNlckRldGFpbHM9ZnVuY3Rpb24ocix0KXtyZXR1cm4gZS5wb3N0KFwiYWRtaW4vdXNlcnMvdXBkYXRlLXVzZXIvXCIrcix0KX0sci5yZXNldFBhc3N3b3JkPWZ1bmN0aW9uKHIsdCl7cmV0dXJuIGUucG9zdChcImFkbWluL3VzZXJzL3Jlc2V0LXBhc3N3b3JkL1wiK3IsdCl9LHJ9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiQXV0aGVudGljYXRpb25cIixmdW5jdGlvbigpe3ZhciB0PXt9O3JldHVybiB0LmdldElzQXV0aGVudGljYXRlZD1mdW5jdGlvbigpe2lmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiKSlyZXR1cm4hMH0sdC5zZXRVc2VyPWZ1bmN0aW9uKHQpe2xvY2FsU3RvcmFnZS5zZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiLEpTT04uc3RyaW5naWZ5KHQpKX0sdC5jbGVhclVzZXI9ZnVuY3Rpb24oKXtsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInRpY2tldFN5c3RlbVVzZXJcIil9LHQuZ2V0VXNlcj1mdW5jdGlvbigpe3JldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiKSl9LHR9KTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJIZWxwZXJGYWN0b3J5XCIsW1wiQXV0aGVudGljYXRpb25cIixmdW5jdGlvbihyKXt2YXIgZT17fSxuPXt9O3JldHVybiBuLmxvYWRpbmc9ITEsZS5jcmVhdGVGbGFzaE1lc3NhZ2U9ZnVuY3Rpb24ocixlKXtyZXR1cm4gci5kYXRhLmVycm9ycz9yLmRhdGEuZXJyb3JzLm1hcChmdW5jdGlvbihyKXtyZXR1cm57bWVzc2FnZTpyLmVycm9yLGNsYXNzOlwiZGFuZ2VyXCJ9fSk6ZT9be21lc3NhZ2U6ZSxjbGFzczpcInN1Y2Nlc3NcIn1dOltdfSxlLmdldEFsbFVzZXJzQnV0U2VsZj1mdW5jdGlvbihlKXt2YXIgbj1yLmdldFVzZXIoKS51c2VybmFtZTtyZXR1cm4gZS5maWx0ZXIoZnVuY3Rpb24ocil7cmV0dXJuIHIudXNlcm5hbWUhPT1ufSl9LGUucmVtb3ZlVXNlckZyb21Vc2Vycz1mdW5jdGlvbihyLGUpe3JldHVybiByLmZpbHRlcihmdW5jdGlvbihyKXt2YXIgbj1lLmluZGV4T2Yoci51c2VybmFtZSk9PT0tMTtyZXR1cm4gbn0pfSxlLmlzQ3VycmVudFVzZXJBZG1pbj1mdW5jdGlvbigpe3ZhciBlPXIuZ2V0VXNlcigpO3JldHVybiBlLnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xfSxlLmlzQ3VycmVudFVzZXJTdXBwb3J0PWZ1bmN0aW9uKCl7dmFyIGU9ci5nZXRVc2VyKCk7cmV0dXJuIGUucm9sZS5pbmRleE9mKFwiU3VwcG9ydFwiKT4tMX0sZS5pc0N1cnJlbnRVc2VyQWRtaW5PclN1cHBvcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gZS5pc0N1cnJlbnRVc2VyQWRtaW4oKXx8ZS5pc0N1cnJlbnRVc2VyU3VwcG9ydCgpfSxlLnN0cmlwSHRtbD1mdW5jdGlvbihyKXtyZXR1cm4gcj9TdHJpbmcocikucmVwbGFjZSgvPFtePl0rPi9nbSxcIlwiKTpcIlwifSxlLmdldExvYWRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gbi5sb2FkaW5nfSxlLnNldExvYWRpbmc9ZnVuY3Rpb24ocil7bi5sb2FkaW5nPXJ9LGUuaXNOdWxsT3JVbmRlZmluZWQ9ZnVuY3Rpb24ocil7cmV0dXJuIG51bGw9PT1yfHwodm9pZCAwPT09cnx8dm9pZCAwKX0sZX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJBY3Rpb25GYWN0b3J5XCIsW1wiJGh0dHBcIixcIiRxXCIsZnVuY3Rpb24odCxuKXt2YXIgZSxvPXt9O3JldHVybiBvLnNldFRhc2s9ZnVuY3Rpb24odCl7ZT10fSxvLmdldFRhc2s9ZnVuY3Rpb24oKXtyZXR1cm4gZX0sby5nZXRBc3NpZ25lZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdC5nZXQoXCJzdGF0aWMvYWxsLXVzZXJzXCIpfSxvLmdldEFsbG93ZWRTdGF0dXM9ZnVuY3Rpb24obil7cmV0dXJuIHQuZ2V0KFwic3RhdGljL2FsbG93ZWQtc3RhdHVzL1wiK24pfSxvLmdldEFsbG93ZWRCdXR0b25zPWZ1bmN0aW9uKGUpe3ZhciBvPW4uZGVmZXIoKTtyZXR1cm4gdC5nZXQoXCJzdGF0aWMvYWN0aW9uLWJ1dHRvbnMvXCIrZSkudGhlbihmdW5jdGlvbih0KXt2YXIgbj17fTtuLmFzc2lnbj10LmRhdGEuYWN0aW9uQnV0dG9ucy5hc3NpZ24sbi5jb21tZW50PXQuZGF0YS5hY3Rpb25CdXR0b25zLmNvbW1lbnQsbi5jaGFuZ2VTdGF0dXM9dC5kYXRhLmFjdGlvbkJ1dHRvbnMuY2hhbmdlU3RhdHVzLG4ucmVvcGVuPXQuZGF0YS5hY3Rpb25CdXR0b25zLnJlb3BlbixuLmNsb3NlPXQuZGF0YS5hY3Rpb25CdXR0b25zLmNsb3NlLG4uYWNrbm93bGVkZ2U9dC5kYXRhLmFjdGlvbkJ1dHRvbnMuYWNrbm93bGVkZ2Usbi5hd2FpdGluZ1VzZXJSZXNwb25zZT10LmRhdGEuYWN0aW9uQnV0dG9ucy5hd2FpdGluZ1VzZXJSZXNwb25zZSxuLmFzc2lnblRvU2VsZj10LmRhdGEuYWN0aW9uQnV0dG9ucy5hc3NpZ25Ub1NlbGYsby5yZXNvbHZlKG4pfSkuY2F0Y2goZnVuY3Rpb24odCl7by5yZWplY3QodCl9KSxvLnByb21pc2V9LG8uYXNzaWduPWZ1bmN0aW9uKG4sZSxvLHMpe3JldHVybiB0LnBvc3QoXCJhZG1pbi90aWNrZXRzL2Fzc2lnbi9cIituLHthc3NpZ25lZTplLGNvbW1lbnQ6byxub3RpZnk6c30pfSxvLmNoYW5nZVN0YXR1cz1mdW5jdGlvbihuLGUsbyxzKXtyZXR1cm4gdC5wb3N0KFwiYWRtaW4vdGlja2V0cy9jaGFuZ2Utc3RhdHVzL1wiK24se3N0YXR1czplLGNvbW1lbnQ6byxub3RpZnk6c30pfSxvLmF3YWl0aW5nVXNlclJlc3BvbnNlPWZ1bmN0aW9uKG4sZSxvKXtyZXR1cm4gdC5wb3N0KFwiYWRtaW4vdGlja2V0cy9hd2FpdGluZy11c2VyLXJlc3BvbnNlL1wiK24se2NvbW1lbnQ6ZSxub3RpZnk6b30pfSxvLnJlb3Blbj1mdW5jdGlvbihuLGUsbyl7cmV0dXJuIHQucG9zdChcImFkbWluL3RpY2tldHMvcmUtb3Blbi9cIituLHtjb21tZW50OmUsbm90aWZ5Om99KX0sby5jbG9zZT1mdW5jdGlvbihuLGUsbyl7cmV0dXJuIHQucG9zdChcImFkbWluL3RpY2tldHMvY2xvc2UvXCIrbix7Y29tbWVudDplLG5vdGlmeTpvfSl9LG8uYWNrbm93bGVkZ2VUaWNrZXQ9ZnVuY3Rpb24obixlLG8pe3JldHVybiB0LnBvc3QoXCJhZG1pbi90aWNrZXRzL2Fja25vd2xlZGdlL1wiK24se2NvbW1lbnQ6ZSxub3RpZnk6b30pfSxvLmFkZENvbW1lbnQ9ZnVuY3Rpb24obixlLG8pe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL2FkZENvbW1lbnQvXCIrbix7Y29tbWVudDplLG5vdGlmeTpvfSl9LG8uZGVsZXRlQ29tbWVudD1mdW5jdGlvbihuLGUpe3JldHVybiB0LmRlbGV0ZShcInRpY2tldHMvZGVsZXRlQ29tbWVudC9cIituLmlkK1wiP2NvbW1lbnRJZD1cIitlLl9pZCl9LG99XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiUGFnaW5hdGlvblNlcnZpY2VcIixmdW5jdGlvbigpe3ZhciBlPXt9O3JldHVybiBlLkdldFBhZ2VyPWZ1bmN0aW9uKGUsdCxhKXt0PXR8fDEsYT1hfHwxMDt2YXIgbixyLGk9TWF0aC5jZWlsKGUvYSk7aTw9MTA/KG49MSxyPWkpOnQ8PTY/KG49MSxyPTEwKTp0KzQ+PWk/KG49aS05LHI9aSk6KG49dC01LHI9dCs0KTt2YXIgZz0odC0xKSphLG89TWF0aC5taW4oZythLTEsZS0xKSx1PW5ldyBBcnJheShyKzEtbikuZmlsbCh2b2lkIDApLGM9dS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIG4rK30pO3JldHVybnt0b3RhbEl0ZW1zOmUsY3VycmVudFBhZ2U6dCxwYWdlU2l6ZTphLHRvdGFsUGFnZXM6aSxzdGFydFBhZ2U6bixlbmRQYWdlOnIsc3RhcnRJbmRleDpnLGVuZEluZGV4Om8scGFnZXM6Y319LGV9KTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJNYWluQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCJBdXRoZW50aWNhdGlvblwiLFwiVXNlckZhY3RvcnlcIixcIiR3aW5kb3dcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGksbixyLG8scyl7dmFyIGE9ZnVuY3Rpb24oKXt2YXIgdD1pLmdldFVzZXIoKTt0LnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xP2UuaXNBZG1pbj0hMDplLmlzQWRtaW49ITEsZS5pc1JlZ3VsYXJVc2VyPSEwLChpLmdldFVzZXIoKS5yb2xlLmluZGV4T2YoXCJTdXBwb3J0XCIpPi0xfHxpLmdldFVzZXIoKS5yb2xlLmluZGV4T2YoXCJBZG1pblwiKT4tMSkmJihlLmlzUmVndWxhclVzZXI9ITEpfTtlLmluaXQ9ZnVuY3Rpb24oKXt2YXIgdD1pLmdldFVzZXIoKTt0JiYodC5yb2xlLmluZGV4T2YoXCJBZG1pblwiKT4tMT9lLmlzQWRtaW49ITA6ZS5pc0FkbWluPSExKX0sZS5nZXRVc2VyPWkuZ2V0VXNlcixlLmlzQXV0aGVudGljYXRlZD1pLmdldElzQXV0aGVudGljYXRlZCxlLmxvZ291dD1mdW5jdGlvbigpe24ubG9nb3V0KCkudGhlbihmdW5jdGlvbigpe2kuY2xlYXJVc2VyKCksdC5nbyhcInVzZXJzLWxvZ2luLmxvZ2luXCIpfSl9LGUuJG9uKFwic3VjY2Vzc2Z1bC1sb2dpblwiLGEpLGUuZ2V0UHJvZmlsZT1mdW5jdGlvbigpe3QuZ28oXCJ1c2Vycy1wcm9maWxlXCIpfSxyLmFwcD17fSxyLmFwcC5hdXRoPWZ1bmN0aW9uKG4scil7XCJcIiE9PW4/by5hbGVydChcImRhbmdlclwiLG4udG9TdHJpbmcoKSw1ZTMpOnIudXNlcm5hbWUmJlwiXCIhPT1yLnVzZXJuYW1lP3ImJihpLnNldFVzZXIociksYSgpLGUuaXNSZWd1bGFyVXNlcj90LmdvKFwidGlja2V0Lm15LXRpY2tldHNcIik6dC5nbyhcImRhc2hib2FyZFwiKSk6dC5nbyhcImF1dGgtZ29vZ2xlXCIse2lkOnIuX2lkLnRvU3RyaW5nKCksZW1haWw6ci5lbWFpbH0pfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJOYXZDdHJsXCIsW1wiJHNjb3BlXCIsZnVuY3Rpb24oYSl7YS5uYXZDbGFzcz1cIlwiLGEudG9nZ2xlTmF2PWZ1bmN0aW9uKHMpe3ZhciBlPWFuZ3VsYXIuZWxlbWVudChzLnRhcmdldCk7ZS5oYXNDbGFzcyhcImlzLW9wZW5cIik/YS5uYXZDbGFzcz1cImlzLWNsb3NlXCI6YS5uYXZDbGFzcz1cImlzLW9wZW5cIn0sYS5uYXZDbGljaz1mdW5jdGlvbihzKXthLm5hdkNsYXNzPVwiYVwiPT09cy50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpP1wiaXMtY2xvc2VcIjphLm5hdkNsYXNzfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJVc2Vyc0xpc3RDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiSGVscGVyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixmdW5jdGlvbihlLHMsYSxyLHQpe3ZhciBpPWZ1bmN0aW9uKCl7cmV0dXJuXCJcIn0sbj1mdW5jdGlvbihlKXtyZXR1cm4gZT09PSEwP1wiZmEgZmEtY2hlY2tcIjpcImZhIGZhLXJlbW92ZVwifSxvPWZ1bmN0aW9uKCl7cmV0dXJuXCJcIn0sdT1mdW5jdGlvbihlKXtyZXR1cm4gZS5pbmRleE9mKFwiQWRtaW5cIik+LTE/XCJmYSBmYS1jaGVja1wiOlwiZmEgZmEtcmVtb3ZlXCJ9O2UuY29uZmlnPXt9LGUuY29uZmlnLnVybD1cIi9zdXBwb3J0L3VzZXJzL3VzZXJzLWRldGFpbHNcIixlLmNvbmZpZy5jb2x1bW5zPVtdLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwidXNlcm5hbWVcIixuYW1lOlwiVXNlcm5hbWVcIixjc3NDbGFzczpcImNvbC1tZC02XCJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImlzQWN0aXZlXCIsbmFtZTpcIklzIEFjdGl2ZVwiLGNzc0NsYXNzOlwiY29sLW1kLTNcIixyZW5kZXI6aSxyZW5kZXJDbGFzczpufSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJyb2xlXCIsbmFtZTpcIklzIEFkbWluXCIsY3NzQ2xhc3M6XCJjb2wtbWQtM1wiLHJlbmRlcjpvLHJlbmRlckNsYXNzOnV9KSxlLmNvbmZpZy5zb3J0UXVlcnlzdHJpbmdQYXJhbT1cInNvcnRcIixlLmNvbmZpZy5vcmRlclF1ZXJ5c3RyaW5nUGFyYW09XCJvcmRlclwiLGUuY29uZmlnLnBhZ2VRdWVyeXN0cmluZ1BhcmFtPVwicGFnZVwiLGUuY29uZmlnLnNpemVRdWVyeXN0cmluZ1BhcmFtPVwic2l6ZVwiLGUuY29uZmlnLm9iamVjdE5hbWU9XCJ1c2Vyc1wiLGUuY29uZmlnLm9uUm93Q2xpY2s9ZnVuY3Rpb24oZSl7cy5nbyhcImFkbWluLWVkaXRcIix7dXNlcm5hbWU6ZS51c2VybmFtZX0pfX1dKS5jb250cm9sbGVyKFwiRWRpdFVzZXJzQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkc3RhdGVQYXJhbXNcIixcIkhlbHBlckZhY3RvcnlcIixcIlVzZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsdCxpKXtlLmlzQWN0aXZlPXt9LGUuaXNBZG1pbj17fSxlLmlzU3VwcG9ydD17fSxlLnVzZXJEZXRhaWxzPXt9O3ZhciBuPWEudXNlcm5hbWU7dC5nZXRVc2VyRGV0YWlscyhuKS50aGVuKGZ1bmN0aW9uKHMpe2UudXNlckRldGFpbHMudXNlcm5hbWU9cy5kYXRhLnVzZXIudXNlcm5hbWUsZS51c2VyRGV0YWlscy5maXJzdG5hbWU9cy5kYXRhLnVzZXIuZmlyc3RuYW1lLGUudXNlckRldGFpbHMubGFzdG5hbWU9cy5kYXRhLnVzZXIubGFzdG5hbWUsZS51c2VyRGV0YWlscy5pZD1zLmRhdGEudXNlci5faWQ7dmFyIGE9cy5kYXRhLnVzZXIucm9sZTtlLnVzZXJEZXRhaWxzLmlzQWRtaW49YS5pbmRleE9mKFwiQWRtaW5cIik+LTEsZS51c2VyRGV0YWlscy5pc1N1cHBvcnQ9YS5pbmRleE9mKFwiU3VwcG9ydFwiKT4tMSxlLnVzZXJEZXRhaWxzLmlzQWN0aXZlPXMuZGF0YS51c2VyLmlzQWN0aXZlLGUudXNlckRldGFpbHMuZW1haWw9cy5kYXRhLnVzZXIuZW1haWwsZS5pc0FjdGl2ZS5rZXk9XCJpc0FjdGl2ZVwiLGUuaXNBY3RpdmUudmFsdWU9ZS51c2VyRGV0YWlscy5pc0FjdGl2ZSxlLmlzQWRtaW4ua2V5PVwiaXNBZG1pblwiLGUuaXNBZG1pbi52YWx1ZT1lLnVzZXJEZXRhaWxzLmlzQWRtaW4sZS5pc1N1cHBvcnQua2V5PVwiaXNTdXBwb3J0XCIsZS5pc1N1cHBvcnQudmFsdWU9ZS51c2VyRGV0YWlscy5pc1N1cHBvcnR9KS5jYXRjaChmdW5jdGlvbihlKXtpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gZmV0Y2ggdXNlciBkZXRhaWxzLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpfSksZS51c2VyRGV0YWlscy51cGRhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gZS5lZGl0VXNlckZvcm0uJGludmFsaWQ/KGUuZWRpdFVzZXJGb3JtLmZpcnN0bmFtZS4kdG91Y2hlZD0hMCxlLmVkaXRVc2VyRm9ybS5sYXN0bmFtZS4kdG91Y2hlZD0hMCx2b2lkKGUuZWRpdFVzZXJGb3JtLmVtYWlsLiR0b3VjaGVkPSEwKSk6KGUudXNlckRldGFpbHMuaXNBZG1pbj1lLmlzQWRtaW4udmFsdWUsZS51c2VyRGV0YWlscy5pc0FjdGl2ZT1lLmlzQWN0aXZlLnZhbHVlLGUudXNlckRldGFpbHMuaXNTdXBwb3J0PWUuaXNTdXBwb3J0LnZhbHVlLHZvaWQgdC51cGRhdGVVc2VyRGV0YWlscyhlLnVzZXJEZXRhaWxzLnVzZXJuYW1lLGUudXNlckRldGFpbHMpLnRoZW4oZnVuY3Rpb24oZSl7ci5jcmVhdGVGbGFzaE1lc3NhZ2UoZSxcIlVzZXIgZGV0YWlscyB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2kuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pfSkuY2F0Y2goZnVuY3Rpb24oZSl7aS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIHVwZGF0ZSB1c2VyIGRldGFpbHMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KSl9fV0pLmNvbnRyb2xsZXIoXCJDaGFuZ2VVc2Vyc1Bhc3N3b3JkQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkc3RhdGVQYXJhbXNcIixcIkhlbHBlckZhY3RvcnlcIixcIlVzZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsdCxpKXtlLmNoYW5nZVBhc3N3b3JkPXt9LGUuY2hhbmdlUGFzc3dvcmQudGl0bGU9XCJSZXNldCBQYXNzd29yZFwiLGUuY2hhbmdlUGFzc3dvcmQuc2F2ZVRpdGxlPVwiUmVzZXRcIixlLmNoYW5nZVBhc3N3b3JkLmNhbmNlbEhyZWY9XCIjL2FkbWluL3VzZXItbWFuYWdlbWVudFwiLGUuY2hhbmdlUGFzc3dvcmQuc2F2ZT1mdW5jdGlvbihzKXtpZihzLiRpbnZhbGlkKXJldHVybiBzLnBhc3N3b3JkMi4kdG91Y2hlZD0hMCx2b2lkKHMucGFzc3dvcmQxLiR0b3VjaGVkPSEwKTt2YXIgbj1hLmlkO3QucmVzZXRQYXNzd29yZChuLGUuY2hhbmdlUGFzc3dvcmQpLnRoZW4oZnVuY3Rpb24oZSl7ci5jcmVhdGVGbGFzaE1lc3NhZ2UoZSxcIlBhc3N3b3JkIGhhcyBiZWVuIHJlc2V0IHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2kuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pfSkuY2F0Y2goZnVuY3Rpb24oZSl7aS5hbGVydChcImRhbmdlclwiLFwiVGhlIHJlcXVlc3QgY291bGQgbm90IGJlbiBtYWRlIHN1Y2Nlc3NmdWxseS4gUGxlYXNlIHRyeSBsYXRlclwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiUXVldWVNYW5hZ2VtZW50Q3RybFwiLFtcIiRzY29wZVwiLFwiUGFnaW5hdGlvblNlcnZpY2VcIixmdW5jdGlvbihlLHUpe2Z1bmN0aW9uIG4oKXtlLnNldFBhZ2UoMSl9ZnVuY3Rpb24gZChuKXtuPDF8fG4+ZS5wYWdlci50b3RhbFBhZ2VzfHwoZS5wYWdlcj11LkdldFBhZ2VyKGUucXVldWVzLmxlbmd0aCxuKSxlLml0ZW1zPWUucXVldWVzLnNsaWNlKGUucGFnZXIuc3RhcnRJbmRleCxlLnBhZ2VyLmVuZEluZGV4KzEpKX1lLnF1ZXVlcz1bXSxlLnBhZ2VyPXt9LGUuc2V0UGFnZT1kLG4oKSxlLnNob3dBZGRRdWV1ZVBhbmVsPWZ1bmN0aW9uKCl7ZS5zaG93QWRkUXVldWU9ITB9LGUuaGlkZUFkZFF1ZXVlUGFuZWw9ZnVuY3Rpb24oKXtlLnNob3dBZGRRdWV1ZT0hMSxlLmFkZFF1ZXVlRm9ybS5uZXdRdWV1ZS4kdG91Y2hlZD0hMSxlLm5ld1F1ZXVlPVwiXCJ9LGUuYWRkUXVldWU9ZnVuY3Rpb24oKXtpZihlLmFkZFF1ZXVlRm9ybS4kaW52YWxpZClyZXR1cm4gdm9pZChlLmFkZFF1ZXVlRm9ybS5uZXdRdWV1ZS4kdG91Y2hlZD0hMCl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkRhc2hib2FyZEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiWWdOb3RpZnlcIixcIlRpY2tldEZhY3RvcnlcIixmdW5jdGlvbihlLHQsbixvKXt2YXIgYT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZShlKSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/U3RyaW5nKGUpLnJlcGxhY2UoLzxbXj5dKz4vZ20sXCJcIik6XCJcIn0scj1mdW5jdGlvbihlKXtyZXR1cm4gZT9lOlwiVW5hc3NpZ25lZFwifTtlLmNvbmZpZz17fSxlLmNvbmZpZy5jb2x1bW5zPVtdLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiaWRcIixuYW1lOlwiSURcIixjc3NDbGFzczpcImNvbC1tZC0xXCJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInRpdGxlXCIsbmFtZTpcIlRpdGxlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJkZXNjcmlwdGlvblwiLG5hbWU6XCJEZXNjcmlwdGlvblwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6c30pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwidHlwZVwiLG5hbWU6XCJUeXBlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJhc3NpZ25lZVwiLG5hbWU6XCJBc3NpZ25lZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6cn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZERhdGVcIixuYW1lOlwiQ3JlYXRlZCBEYXRlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwiLHJlbmRlcjphfSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJjcmVhdGVkQnlcIixuYW1lOlwiQ3JlYXRlZCBCeVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLnVybD1cIi9zdXBwb3J0L3RpY2tldHMvb3Blbi13aXRoaW4tZGF5XCIsZS5jb25maWcuc29ydFF1ZXJ5c3RyaW5nUGFyYW09XCJzb3J0XCIsZS5jb25maWcub3JkZXJRdWVyeXN0cmluZ1BhcmFtPVwib3JkZXJcIixlLmNvbmZpZy5wYWdlUXVlcnlzdHJpbmdQYXJhbT1cInBhZ2VcIixlLmNvbmZpZy5zaXplUXVlcnlzdHJpbmdQYXJhbT1cInNpemVcIixlLmNvbmZpZy5vblJvd0NsaWNrPWZ1bmN0aW9uKGUpe3QuZ28oXCJ0aWNrZXQtdmlld1wiLHtpZDplLmlkfSl9LGUuY29uZmlnLm9iamVjdE5hbWU9XCJ0aWNrZXRzXCIsby5nZXREYXNoYm9hcmREYXRhKCkudGhlbihmdW5jdGlvbihlKXt2YXIgbj1lLmRhdGEudGlja2V0cyxvPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhdHVzQ2hhcnRcIiksYT1uZXcgQ2hhcnQobyx7dHlwZTpcImRvdWdobnV0XCIsZGF0YTp7bGFiZWxzOltcIk5ld1wiLFwiT3BlblwiLFwiSW4tUHJvZ3Jlc3NcIixcIkF3YWl0aW5nIFVzZXIgUmVzcG9uc2VcIl0sZGF0YXNldHM6W3tkYXRhOltuLm5ldy5jb3VudCxuLm9wZW4uY291bnQsbi5pblByb2dyZXNzLmNvdW50LG4uYXdhaXRpbmdVc2VyUmVzcG9uc2UuY291bnRdLGJhY2tncm91bmRDb2xvcjpbXCIjMDM5QkU1XCIsXCIjRjQ0MzM2XCIsXCIjRkZCMzAwXCIsXCIjNDNBMDQ3XCJdLGhvdmVyQmFja2dyb3VuZENvbG9yOltcIiMwMzlCRTVcIixcIiNGNDQzMzZcIixcIiNGRkIzMDBcIixcIiM0M0EwNDdcIl19XX0sb3B0aW9uczp7bGVnZW5kOntsYWJlbHM6e2JveFdpZHRoOjEyLGZvbnRTaXplOjEwfX19fSkscz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInR5cGVDaGFydFwiKSxyPW5ldyBDaGFydChzLHt0eXBlOlwiZG91Z2hudXRcIixkYXRhOntsYWJlbHM6W1wiQnVnXCIsXCJOZWVkIEluZm9cIixcIkltcHJvdmVtZW50XCJdLGRhdGFzZXRzOlt7ZGF0YTpbbi5idWcuY291bnQsbi5uZWVkSW5mby5jb3VudCxuLmltcHJvdmVtZW50LmNvdW50XSxiYWNrZ3JvdW5kQ29sb3I6W1wiI0Y0NDMzNlwiLFwiIzAzOUJFNVwiLFwiI0ZGQjMwMFwiXSxob3ZlckJhY2tncm91bmRDb2xvcjpbXCIjRjQ0MzM2XCIsXCIjMDM5QkU1XCIsXCIjRkZCMzAwXCJdfV19LG9wdGlvbnM6e2xlZ2VuZDp7bGFiZWxzOntib3hXaWR0aDoxMixmb250U2l6ZToxMH19fX0pLGw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcmlvcml0eUNoYXJ0XCIpLGM9bmV3IENoYXJ0KGwse3R5cGU6XCJkb3VnaG51dFwiLGRhdGE6e2xhYmVsczpbXCJIaWdoXCIsXCJNZWRpdW1cIixcIkxvd1wiXSxkYXRhc2V0czpbe2RhdGE6W24uaGlnaC5jb3VudCxuLm1lZGl1bS5jb3VudCxuLmxvdy5jb3VudF0sYmFja2dyb3VuZENvbG9yOltcIiNGNDQzMzZcIixcIiNGRkIzMDBcIixcIiM0M0EwNDdcIl0saG92ZXJCYWNrZ3JvdW5kQ29sb3I6W1wiI0Y0NDMzNlwiLFwiI0ZGQjMwMFwiLFwiIzQzQTA0N1wiXX1dfSxvcHRpb25zOntsZWdlbmQ6e2xhYmVsczp7Ym94V2lkdGg6MTIsZm9udFNpemU6MTB9fX19KTthbmd1bGFyLmVsZW1lbnQobykub24oXCJjbGlja1wiLGZ1bmN0aW9uKGUpe3ZhciBuPWEuZ2V0RWxlbWVudHNBdEV2ZW50KGUpO24mJm4ubGVuZ3RoPjAmJm5bMF0uX21vZGVsLmxhYmVsJiZ0LmdvKFwiZGFzaGJvYXJkLXRvLXZpZXdcIix7dHlwZTpcInN0YXR1c1wiLHZhbHVlOm5bMF0uX21vZGVsLmxhYmVsfSl9KSxhbmd1bGFyLmVsZW1lbnQocykub24oXCJjbGlja1wiLGZ1bmN0aW9uKGUpe3ZhciBuPXIuZ2V0RWxlbWVudHNBdEV2ZW50KGUpO24mJm4ubGVuZ3RoPjAmJm5bMF0uX21vZGVsLmxhYmVsJiZ0LmdvKFwiZGFzaGJvYXJkLXRvLXZpZXdcIix7dHlwZTpcInR5cGVcIix2YWx1ZTpuWzBdLl9tb2RlbC5sYWJlbH0pfSksYW5ndWxhci5lbGVtZW50KGwpLm9uKFwiY2xpY2tcIixmdW5jdGlvbihlKXt2YXIgbj1jLmdldEVsZW1lbnRzQXRFdmVudChlKTtuJiZuLmxlbmd0aD4wJiZuWzBdLl9tb2RlbC5sYWJlbCYmdC5nbyhcImRhc2hib2FyZC10by12aWV3XCIse3R5cGU6XCJwcmlvcml0eVwiLHZhbHVlOm5bMF0uX21vZGVsLmxhYmVsfSl9KX0pLmNhdGNoKGZ1bmN0aW9uKGUpe24uYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBmZXRjaCB0aGUgZGFzaGJvYXJkIGRhdGEuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsNWUzKX0pfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkRhc2hib2FyZFRvVmlld0N0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCJZZ05vdGlmeVwiLFwiVGlja2V0RmFjdG9yeVwiLGZ1bmN0aW9uKGUscyxuLG8sdCl7ZnVuY3Rpb24gYyhlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZShlKSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9ZnVuY3Rpb24gaShlKXtyZXR1cm4gZT9TdHJpbmcoZSkucmVwbGFjZSgvPFtePl0rPi9nbSxcIlwiKTpcIlwifWZ1bmN0aW9uIHIoZSl7cmV0dXJuIGU/ZTpcIk5vbmVcIn1lLnR5cGU9bi50eXBlLGUudmFsdWU9bi52YWx1ZSxlLmNvbmZpZz17fSxlLmNvbmZpZy5jb2x1bW5zPVtdLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiaWRcIixuYW1lOlwiSURcIixjc3NDbGFzczpcImNvbC1tZC0xXCJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInRpdGxlXCIsbmFtZTpcIlRpdGxlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJkZXNjcmlwdGlvblwiLG5hbWU6XCJEZXNjcmlwdGlvblwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6aX0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwidHlwZVwiLG5hbWU6XCJUeXBlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJzdGF0dXNcIixuYW1lOlwiU3RhdHVzXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJwcmlvcml0eVwiLG5hbWU6XCJQcmlvcml0eVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6cn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZERhdGVcIixuYW1lOlwiQ3JlYXRlZCBEYXRlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwiLHJlbmRlcjpjfSksZS5jb25maWcuc29ydFF1ZXJ5c3RyaW5nUGFyYW09XCJzb3J0XCIsZS5jb25maWcub3JkZXJRdWVyeXN0cmluZ1BhcmFtPVwib3JkZXJcIixlLmNvbmZpZy5wYWdlUXVlcnlzdHJpbmdQYXJhbT1cInBhZ2VcIixlLmNvbmZpZy5zaXplUXVlcnlzdHJpbmdQYXJhbT1cInNpemVcIixlLmNvbmZpZy5vblJvd0NsaWNrPWZ1bmN0aW9uKGUpe3MuZ28oXCJ0aWNrZXQtdmlld1wiLHtpZDplLmlkfSl9LGUuY29uZmlnLm9iamVjdE5hbWU9XCJ0aWNrZXRzXCIsZS5jb25maWcudXJsPVwiL3N1cHBvcnQvdGlja2V0cy9cIituLnR5cGUrXCIvXCIrbi52YWx1ZX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJEZWxldGVDb21tZW50Q3RybFwiLFtcIiRzY29wZVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixcIllnTW9kYWxcIixcIkFjdGlvbkZhY3RvcnlcIixmdW5jdGlvbihlLHQsbixvLHIpe3ZhciBjPWZ1bmN0aW9uKG8sYyl7cmV0dXJuIGZ1bmN0aW9uKCl7ci5kZWxldGVDb21tZW50KG8sYykudGhlbihmdW5jdGlvbihvKXtuLmNyZWF0ZUZsYXNoTWVzc2FnZShvLFwiVGhlIGNvbW1lbnQgd2FzIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksby5kYXRhLmVycm9yc3x8KGUudGlja2V0LmNvbW1lbnRzPW8uZGF0YS5jb21tZW50cyl9KS5jYXRjaChmdW5jdGlvbihlKXt0LmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gZGVsZXRlIGNvbW1lbnQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsNWUzKX0pfX07ZS5kZWxldGVDb21tZW50PWZ1bmN0aW9uKGUsdCl7by5jb25maXJtKGMoZSx0KSksby5vcGVuKFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRvIHRoaXM/XCIsXCJUaGlzIHdpbGwgZGVsZXRlIHRoZSBjb21tZW50IHBlcm1hbmVudGx5XCIpfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJFZGl0VGlja2V0Q3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCIkc3RhdGVcIixcIlRpY2tldEZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKHQsZSxhLHIsaSxjLG4pe3QudG9vbGJhckNvbmZpZz1bW1wiaDFcIixcInBcIixcInByZVwiLFwicXVvdGVcIl0sW1wiYm9sZFwiLFwiaXRhbGljc1wiLFwidW5kZXJsaW5lXCIsXCJzdHJpa2VUaHJvdWdoXCIsXCJ1bFwiLFwib2xcIixcInJlZG9cIixcInVuZG9cIixcImNsZWFyXCJdLFtdLFtcImluc2VydExpbmtcIl1dLHQuY2FuY2VsPWZ1bmN0aW9uKCl7YS5nbyhcInRpY2tldC12aWV3XCIse2lkOnQudGlja2V0LmlkfSl9LHQucmVuZGVyRGF0ZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZSh0KSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LHIuZ2V0VGlja2V0QnlJZChlLmlkKS50aGVuKGZ1bmN0aW9uKGUpe2lmKGUuZGF0YS5lcnJvcnMpe2EuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKTt2YXIgbz1jLmNyZWF0ZUVycm9yTWVzc2FnZShlLmRhdGEuZXJyb3JzKTtvLmZvckVhY2goZnVuY3Rpb24odCl7aS5hbGVydChcImRhbmdlclwiLHQsNWUzKX0pfWVsc2UgdC50aWNrZXQ9ZS5kYXRhLnRpY2tldCx0LnRpY2tldC5jdXJyZW50VXNlcj1uLmdldFVzZXIoKS51c2VybmFtZSxyLmdldEluaXRpYWxUaWNrZXREYXRhKHQudGlja2V0LnN0YXR1cykudGhlbihmdW5jdGlvbihlKXt0LnByaW9yaXRpZXM9ZS5kYXRhLnByaW9yaXRpZXMudmFsdWVzLHQudHlwZXM9ZS5kYXRhLnR5cGVzLnZhbHVlcyx0LnVzZXJzPWUuZGF0YS51c2Vycyx0LnN0YXR1c2VzPWUuZGF0YS5zdGF0dXNlc30pLmNhdGNoKGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKHQpLGkuYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBmZXRjaCB0aGUgc3RhdGljIGRhdGEuXCIsNWUzKX0pfSkuY2F0Y2goZnVuY3Rpb24odCl7Y29uc29sZS5sb2codCksaS5hbGVydChcImRhbmdlclwiLFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGdldCB0aWNrZXQgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpfSksdC51cGRhdGU9ZnVuY3Rpb24oKXtyLnVwZGF0ZVRpY2tldCh0LnRpY2tldC5faWQsdC50aWNrZXQpLnRoZW4oZnVuY3Rpb24oZSl7dC50aWNrZXQ9ZS5kYXRhLGkuYWxlcnQoXCJzdWNjZXNzXCIsXCJUaWNrZXQgdXBkYXRlZCBzdWNjZXNzZnVsbHkuXCIsNWUzKSxhLmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5kYXRhLmlkfSl9KS5jYXRjaChmdW5jdGlvbih0KXtjb25zb2xlLmxvZyh0KSxpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gdXBkYXRlIHRpY2tldCBkZXRhaWxzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiTmV3VGlja2V0Q3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCJUaWNrZXRGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiQ29tbW9uRmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxpLGMsbixvKXtuLmdldEluaXRpYWxTdGF0aWNEYXRhKCkudGhlbihmdW5jdGlvbih0KXtlLm5ld1RpY2tldC50eXBlcz10LmRhdGEudHlwZXMudmFsdWVzLGUubmV3VGlja2V0LnR5cGU9ZS5uZXdUaWNrZXQudHlwZXNbMF0udmFsdWV9KSxlLm5ld1RpY2tldD17fSxlLnRvb2xiYXJDb25maWc9W1tcImgxXCIsXCJwXCIsXCJwcmVcIixcInF1b3RlXCJdLFtcImJvbGRcIixcIml0YWxpY3NcIixcInVuZGVybGluZVwiLFwic3RyaWtlVGhyb3VnaFwiLFwidWxcIixcIm9sXCIsXCJyZWRvXCIsXCJ1bmRvXCIsXCJjbGVhclwiXSxbXSxbXCJpbnNlcnRMaW5rXCJdXSxlLnNhdmU9ZnVuY3Rpb24oKXtyZXR1cm4gZS5uZXdUaWNrZXRGb3JtLiRpbnZhbGlkPyhlLm5ld1RpY2tldEZvcm0udGl0bGUuJHRvdWNoZWQ9ITAsdm9pZChlLm5ld1RpY2tldEZvcm0uZGVzY3JpcHRpb24uJHRvdWNoZWQ9ITApKTp2b2lkIGkuY3JlYXRlTmV3VGlja2V0KHt0aXRsZTplLm5ld1RpY2tldC50aXRsZSxkZXNjcmlwdGlvbjplLm5ld1RpY2tldC5kZXNjcmlwdGlvbix0eXBlOmUubmV3VGlja2V0LnR5cGV9KS50aGVuKGZ1bmN0aW9uKGUpe28uY3JlYXRlRmxhc2hNZXNzYWdlKGUsXCJUaGUgdGlja2V0IGhhcyBiZWVuIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7Yy5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksZS5kYXRhLmlkJiZ0LmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5kYXRhLmlkfSl9LGZ1bmN0aW9uKGUpe2MuYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBjcmVhdGUgbmV3IHRpY2tldC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpLGNvbnNvbGUubG9nKGUpfSl9fV0pO1xuXG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiVGlja2V0c0N0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiYWdTb3J0RmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxuLGkpe2UuaXNTdXBwb3J0PSExO3ZhciBjPUpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aWNrZXRTeXN0ZW1Vc2VyXCIpKTtjJiYoYy5yb2xlLmluZGV4T2YoXCJBZG1pblwiKT4tMXx8Yy5yb2xlLmluZGV4T2YoXCJTdXBwb3J0XCIpPi0xKSYmKGUuaXNTdXBwb3J0PSEwKTt2YXIgcz1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZShlKSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LG89ZnVuY3Rpb24oZSl7cmV0dXJuIGU/U3RyaW5nKGUpLnJlcGxhY2UoLzxbXj5dKz4vZ20sXCJcIik6XCJcIn0scj1mdW5jdGlvbihlKXtyZXR1cm4gZT9lOlwiVW5hc3NpZ25lZFwifTtlLmNvbmZpZz17fSxlLmNvbmZpZy5jb2x1bW5zPVtdLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiaWRcIixuYW1lOlwiSURcIixjc3NDbGFzczpcImNvbC1tZC0xXCJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInRpdGxlXCIsbmFtZTpcIlRpdGxlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJkZXNjcmlwdGlvblwiLG5hbWU6XCJEZXNjcmlwdGlvblwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6b30pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwidHlwZVwiLG5hbWU6XCJUeXBlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJhc3NpZ25lZVwiLG5hbWU6XCJBc3NpZ25lZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6cn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZERhdGVcIixuYW1lOlwiQ3JlYXRlZCBEYXRlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMlwiLHJlbmRlcjpzfSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJjcmVhdGVkQnlcIixuYW1lOlwiQ3JlYXRlZCBCeVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLnNvcnRRdWVyeXN0cmluZ1BhcmFtPVwic29ydFwiLGUuY29uZmlnLm9yZGVyUXVlcnlzdHJpbmdQYXJhbT1cIm9yZGVyXCIsZS5jb25maWcucGFnZVF1ZXJ5c3RyaW5nUGFyYW09XCJwYWdlXCIsZS5jb25maWcuc2l6ZVF1ZXJ5c3RyaW5nUGFyYW09XCJzaXplXCIsZS5jb25maWcub25Sb3dDbGljaz1mdW5jdGlvbihlKXt0LmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5pZH0pfSxlLmNvbmZpZy5vYmplY3ROYW1lPVwidGlja2V0c1wiLGUuaW5pdGlhdGVBbGxUaWNrZXQ9ZnVuY3Rpb24oKXtlLmNvbmZpZy51cmw9XCIvdGlja2V0cy9hbGxcIixlLiRwYXJlbnQuYWN0aXZlPVwiYWxsXCJ9LGUuaW5pdGlhdGVNeVRpY2tldD1mdW5jdGlvbigpe2UuY29uZmlnLnVybD1cIi90aWNrZXRzL215XCIsZS4kcGFyZW50LmFjdGl2ZT1cIm15XCJ9LGUuaW5pdGlhdGVUb01lVGlja2V0PWZ1bmN0aW9uKCl7ZS5jb25maWcudXJsPVwiL3RpY2tldHMvdG8tbWVcIixlLiRwYXJlbnQuYWN0aXZlPVwidG9tZVwifX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJWaWV3VGlja2V0Q3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCIkc3RhdGVcIixcIlRpY2tldEZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJBdXRoZW50aWNhdGlvblwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxyLGksbixzLGEpe2Z1bmN0aW9uIGMoZSx0KXtzd2l0Y2goZT1lfHxcIlwiLHQuc3VjY2Vzcz10LnN1Y2Nlc3N8fFwiXCIsdC53YXJuaW5nPXQud2FybmluZ3x8XCJcIix0LmRhbmdlcj10LmRhbmdlcnx8XCJcIix0LmluZm89dC5pbmZvfHxcIlwiLGUudG9Mb3dlckNhc2UoKSl7Y2FzZSB0LnN1Y2Nlc3MudG9Mb3dlckNhc2UoKTpyZXR1cm5cInN1Y2Nlc3NcIjtjYXNlIHQud2FybmluZy50b0xvd2VyQ2FzZSgpOnJldHVyblwid2FybmluZ1wiO2Nhc2UgdC5kYW5nZXIudG9Mb3dlckNhc2UoKTpyZXR1cm5cImRhbmdlclwiO2Nhc2UgdC5pbmZvLnRvTG93ZXJDYXNlKCk6cmV0dXJuXCJpbmZvXCI7ZGVmYXVsdDpyZXR1cm5cImluZm9cIn19ZnVuY3Rpb24gbyhlKXtyZXR1cm4gYyhlLHtzdWNjZXNzOlwiaW4tcHJvZ3Jlc3NcIix3YXJuaW5nOlwib3BlblwiLGluZm86XCJuZXdcIixkYW5nZXI6XCJyZXNvbHZlZFwifSl9ZnVuY3Rpb24gdShlKXtyZXR1cm4gYyhlLHtzdWNjZXNzOlwibG93XCIsd2FybmluZzpcIm1lZGl1bVwiLGRhbmdlcjpcImhpZ2hcIn0pfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIGUuYXNzaWduZWU9PT1lLmN1cnJlbnRVc2VyfHwoZS5jcmVhdGVkQnk9PT1lLmN1cnJlbnRVc2VyfHwoISFhLmlzQ3VycmVudFVzZXJBZG1pbigpfHwhIWEuaXNDdXJyZW50VXNlclN1cHBvcnQoKSkpfWkuZ2V0VGlja2V0QnlJZCh0LmlkKS50aGVuKGZ1bmN0aW9uKHQpe2EuY3JlYXRlRmxhc2hNZXNzYWdlKHQpLmZvckVhY2goZnVuY3Rpb24oZSl7bi5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksdC5kYXRhLmVycm9yc3x8KGUudGlja2V0PXQuZGF0YS50aWNrZXQsZS50aWNrZXQuZGVzY3JpcHRpb249YS5zdHJpcEh0bWwoZS50aWNrZXQuZGVzY3JpcHRpb24pLGUudGlja2V0LmFzc2lnbmVlPWUudGlja2V0LmFzc2lnbmVlP2UudGlja2V0LmFzc2lnbmVlOlwiVW5hc3NpZ25lZFwiLGUudGlja2V0LmNyZWF0ZWREYXRlPWUucmVuZGVyRGF0ZShlLnRpY2tldC5jcmVhdGVkRGF0ZSksZS50aWNrZXQuY3VycmVudFVzZXI9cy5nZXRVc2VyKCkudXNlcm5hbWUsZS5zdGF0dXNDbGFzcz1vKGUudGlja2V0LnN0YXR1cyksZS50aWNrZXQucHJpb3JpdHk9ZS50aWNrZXQucHJpb3JpdHl8fFwiTi5BXCIsZS5wcmlvcml0eUNsYXNzPXUoZS50aWNrZXQucHJpb3JpdHkpLGQoZS50aWNrZXQpJiYoZS5zaG93RWRpdD0hMCkpfSkuY2F0Y2goZnVuY3Rpb24oZSl7bi5hbGVydChcImRhbmdlclwiLFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGdldCB0aWNrZXQgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpfSksZS50aWNrZXQ9e30sZS5lZGl0PWZ1bmN0aW9uKCl7ci5nbyhcInRpY2tldC1lZGl0XCIse2lkOmUudGlja2V0LmlkfSl9LGUucmVuZGVyRGF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IERhdGUoRGF0ZS5wYXJzZShlKSkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkNoYW5nZVBhc3N3b3JkQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkc3RhdGVQYXJhbXNcIixcIlVzZXJGYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsbyx0KXtlLmNoYW5nZVBhc3N3b3JkPXt9LGUuY2hhbmdlUGFzc3dvcmQudGl0bGU9XCJDaGFuZ2UgUGFzc3dvcmRcIixlLmNoYW5nZVBhc3N3b3JkLnNhdmVUaXRsZT1cIkNoYW5nZSBQYXNzd29yZFwiLGUuY2hhbmdlUGFzc3dvcmQuY2FuY2VsSHJlZj1cIiMvdXNlcnMvcHJvZmlsZVwiLGUuY2hhbmdlUGFzc3dvcmQuc2F2ZT1mdW5jdGlvbihjKXtpZihjLiRpbnZhbGlkKXJldHVybiBjLnBhc3N3b3JkMi4kdG91Y2hlZD0hMCx2b2lkKGMucGFzc3dvcmQxLiR0b3VjaGVkPSEwKTt2YXIgbj1hLmlkO3IuY2hhbmdlUGFzc3dvcmQobixlLmNoYW5nZVBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uKGUpe28uY3JlYXRlRmxhc2hNZXNzYWdlKGUsXCJUaGUgcGFzc3dvcmQgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXt0LmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmRhdGEuZXJyb3JzfHxzLmdvKFwidXNlcnMtcHJvZmlsZVwiKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe3QuYWxlcnQoXCJkYW5nZXJcIixcIlRoZSByZXF1ZXN0IGNvdWxkIG5vdCBiZW4gbWFkZSBzdWNjZXNzZnVsbHkuIFBsZWFzZSB0cnkgbGF0ZXJcIiw1ZTMpfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkxvZ2luQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCIkd2luZG93XCIsXCJVc2VyRmFjdG9yeVwiLFwiQXV0aGVudGljYXRpb25cIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsbyxyLGksbil7aS5nZXRVc2VyKCkmJnQuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKSxlLmVycm9yPSExLGUubWVzc2FnZT1cIlwiLGUubG9naW49ZnVuY3Rpb24oKXtyLmxvZ2luKGUudXNlcm5hbWUsZS5wYXNzd29yZCxlLnJlbWVtYmVyKS50aGVuKGZ1bmN0aW9uKG8pe28uZGF0YS5pc0F1dGhlbnRpY2F0ZWQ/KGkuc2V0VXNlcihvLmRhdGEudXNlciksZS4kZW1pdChcInN1Y2Nlc3NmdWwtbG9naW5cIiksbi5pc0N1cnJlbnRVc2VyQWRtaW5PclN1cHBvcnQoKT90LmdvKFwiZGFzaGJvYXJkXCIpOnQuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKSk6KGUuZXJyb3I9ITAsZS5tZXNzYWdlPW8uZGF0YS5tc2cpfSkuY2F0Y2goZnVuY3Rpb24odCl7ZS5lcnJvcj0hMCxlLm1lc3NhZ2U9XCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gbG9nIHlvdSBpbi4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlclwifSl9LGUuZ29vZ2xlTG9naW49ZnVuY3Rpb24oKXt2YXIgZT1cImFjY291bnRzL2F1dGgvZ29vZ2xlXCIsdD02MDAscj00NTAsaT0od2luZG93Lm91dGVySGVpZ2h0LXIpLzIsbj0od2luZG93Lm91dGVyV2lkdGgtdCkvMjtvLm9wZW4oZSxcImZhY2Vib29rX2xvZ2luXCIsXCJ3aWR0aD1cIit0K1wiLGhlaWdodD1cIityK1wiLHNjcm9sbGJhcnM9MCx0b3A9XCIraStcIixsZWZ0PVwiK24pfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJNYWluTG9naW5DdHJsXCIsW1wiJHJvb3RTY29wZVwiLFwiJHNjb3BlXCIsXCIkc3RhdGVcIixmdW5jdGlvbih0LGUsbil7ZS5zdGF0ZW5hbWU9bi5jdXJyZW50Lm5hbWUsdC4kb24oXCIkc3RhdGVDaGFuZ2VTdGFydFwiLGZ1bmN0aW9uKHQsbixhLG8scil7ZS5zdGF0ZW5hbWU9bi5uYW1lfSl9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiUHJvZmlsZUN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiQXV0aGVudGljYXRpb25cIixcIlVzZXJGYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUsYSxyLHMsdCx1KXtlLnVzZXI9e30sZS5pbml0PWZ1bmN0aW9uKCl7cy5nZXRVc2VyQnlVc2VybmFtZShyLmdldFVzZXIoKS51c2VybmFtZSkudGhlbihmdW5jdGlvbihhKXt0LmNyZWF0ZUZsYXNoTWVzc2FnZShhKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3UuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLGEuZGF0YS5lcnJvcnN8fChlLnVzZXIuZmlyc3RuYW1lPWEuZGF0YS51c2VyLmZpcnN0bmFtZSxlLnVzZXIubGFzdG5hbWU9YS5kYXRhLnVzZXIubGFzdG5hbWUsZS51c2VyLnVzZXJuYW1lPWEuZGF0YS51c2VyLnVzZXJuYW1lLGUudXNlci5lbWFpbD1hLmRhdGEudXNlci5lbWFpbCxlLnVzZXIudXNlcklkPWEuZGF0YS51c2VyLl9pZCl9KX0sZS51cGRhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gZS5wcm9maWxlRm9ybS4kaW52YWxpZD8oZS5wcm9maWxlRm9ybS5maXJzdG5hbWUuJHRvdWNoZWQ9ITAsZS5wcm9maWxlRm9ybS5sYXN0bmFtZS4kdG91Y2hlZD0hMCx2b2lkKGUucHJvZmlsZUZvcm0uZW1haWwuJHRvdWNoZWQ9ITApKToodC5zZXRMb2FkaW5nKCEwKSx2b2lkIHMudXBkYXRlUHJvZmlsZShlLnVzZXIpLnRoZW4oZnVuY3Rpb24oYSl7dC5jcmVhdGVGbGFzaE1lc3NhZ2UoYSxcIlVzZXIgZGV0YWlscyBoYXZlIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXt1LmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxhLmRhdGEuZXJyb3JzfHwoZS51c2VyLmZpcnN0bmFtZT1hLmRhdGEudXNlci5maXJzdG5hbWUsZS51c2VyLmxhc3RuYW1lPWEuZGF0YS51c2VyLmxhc3RuYW1lLGUudXNlci51c2VybmFtZT1hLmRhdGEudXNlci51c2VybmFtZSxlLnVzZXIuZW1haWw9YS5kYXRhLnVzZXIuZW1haWwsZS51c2VyLnJvbGU9YS5kYXRhLnVzZXIucm9sZSxyLnNldFVzZXIoZS51c2VyKSl9KS5jYXRjaChmdW5jdGlvbihlKXt1LmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gdXBkYXRlIHVzZXIgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKX0pKX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiUmVnaXN0ZXJDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIlVzZXJGYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscix0LHMsYSl7ZS5uZXdVc2VyPXt9LGUucmVnaXN0ZXI9ZnVuY3Rpb24oKXt0LnJlZ2lzdGVyVXNlcihlLm5ld1VzZXIpLnRoZW4oZnVuY3Rpb24oZSl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UoZSxcIlVzZXIgaGFzIGJlZW4gY3JlYXRlZCBzdWNjZXNzZnVsbHkuIFlvdSBjYW4gbm93IGxvZ2luLlwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLGUuZGF0YS5lcnJvcnMmJnIuZ28oXCJ1c2Vycy1sb2dpbi5sb2dpblwiKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjcmVhdGUgdGhlIHVzZXIuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiU2V0VXNlckN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiJHN0YXRlXCIsXCJVc2VyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkF1dGhlbnRpY2F0aW9uXCIsZnVuY3Rpb24oZSxzLHQsYSxyLG4pe3ZhciBjPXMuaWQsbz1zLmVtYWlsO2Uuc2V0VXNlcm5hbWU9e30sZS5zZXRVc2VybmFtZS5lbWFpbD1vLGUuc2F2ZVVzZXJuYW1lPWZ1bmN0aW9uKCl7YS5zZXRVc2VybmFtZSh7aWQ6Yyx1c2VybmFtZTplLnNldFVzZXJuYW1lLnVzZXJuYW1lfSkudGhlbihmdW5jdGlvbihzKXtIZWxwZXJGYWN0b3J5LmNyZWF0ZUZsYXNoTWVzc2FnZShzLFwiVXNlcm5hbWUgaGFzIGJlZW4gc2V0IHN1Y2Nlc3NmdWxseS5cIikuZm9yRWFjaChmdW5jdGlvbihlKXtyLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxzLmRhdGEuZXJyb3JzfHwobi5zZXRVc2VyKHMuZGF0YS51c2VyKSxlLiRlbWl0KFwic3VjY2Vzc2Z1bC1sb2dpblwiKSx0LmdvKFwidGlja2V0Lm15LXRpY2tldHNcIikpfSkuY2F0Y2goZnVuY3Rpb24oZSl7ci5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIHNldCB0aGUgdXNlcm5hbWUuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiQWN0aW9uc0N0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIkhlbHBlckZhY3RvcnlcIixcIlVzZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGUsdCxhLHMsbixjKXtlLmdldFRhc2s9dC5nZXRUYXNrLGUudGFzaz17fSxzLmdldEFsbFVzZXJEZXRhaWxzKCkudGhlbihmdW5jdGlvbih0KXt2YXIgYT10LmRhdGEudXNlcnM7ZS50YXNrLmFsbFVzZXJzPWEsZS50YXNrLm5vdGlmeVVzZXJzPVtdLGUudGFzay5tdWx0aXNlbGVjdE9wdGlvbnM9e3NtYXJ0QnV0dG9uTWF4SXRlbXM6NCxkaXNwbGF5UHJvcDpcInVzZXJuYW1lXCIsaWRQcm9wOlwidXNlcm5hbWVcIn19KS5jYXRjaChmdW5jdGlvbihlKXtuLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gZ2V0IHRoZSBsaXN0IG9mIGFsbCB0aGUgdXNlcnMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KSxlLnRhc2suc2hvd1Rhc2tQYW5lbD0hMSxlLnRhc2suc2hvd01haW5QYW5lbD0hMSx0LnNldFRhc2sobnVsbCksZS5zZXRTYXZlRm49ZnVuY3Rpb24odCl7ZS5zYXZlVGFzaz10fSxlLmNhbmNlbFRhc2s9ZnVuY3Rpb24oKXt0LnNldFRhc2sobnVsbCksZS50YXNrLmNvbW1lbnQ9XCJcIixlLnRhc2suc2hvd1Rhc2tQYW5lbD0hMSxlLnRhc2suc2hvd01haW5QYW5lbD0hMX0sZS5zZXRTYXZlQnRuTmFtZT1mdW5jdGlvbih0KXtlLnNhdmVCdG5OYW1lPXR9LGUuJHdhdGNoKFwiZ2V0VGFzaygpXCIsZnVuY3Rpb24odCxhKXtpZihlLnRhc2submFtZT1udWxsLHQpc3dpdGNoKGUudGFzay5zaG93VGFza1BhbmVsPSEwLGUudGFzay5zaG93TWFpblBhbmVsPSEwLGUudGFzay5uYW1lPVwidGVtcGxhdGVzL3BhcnRpYWxzL2FjdGlvbi9cIit0K1wiLWFjdGlvbi1wYXJ0aWFsLmh0bWxcIix0KXtjYXNlXCJjb21tZW50XCI6ZS50YXNrLnRpdGxlPVwiQWRkIG5ldyBjb21tZW50XCI7YnJlYWs7Y2FzZVwiYXdhaXRpbmd1c2Vyc3Jlc3BvbnNlXCI6ZS50YXNrLnRpdGxlPVwiQXdhaXRpbmcgdXNlcnMgcmVzcG9uc2VcIjticmVhaztjYXNlXCJjbG9zZVwiOmUudGFzay50aXRsZT1cIkNsb3NlIHRpY2tldFwiO2JyZWFrO2Nhc2VcInJlb3BlblwiOmUudGFzay50aXRsZT1cIlJlb3BlbiB0aWNrZXRcIjticmVhaztjYXNlXCJhY2tub3dsZWRnZVwiOmUudGFzay50aXRsZT1cIkFja25vd2xlZGdlIHRpY2tldFwiO2JyZWFrO2Nhc2VcImFzc2lnblwiOmUudGFzay50aXRsZT1cIkFzc2lnbiB0aWNrZXRcIjticmVhaztjYXNlXCJjaGFuZ2VzdGF0dXNcIjplLnRhc2sudGl0bGU9XCJDaGFuZ2UgdGlja2V0IHN0YXR1c1wiO2JyZWFrO2Nhc2VcImFzc2lnbnRvc2VsZlwiOmUudGFzay50aXRsZT1cIkFzc2lnbiB0byBzZWxmXCJ9fSl9XSkuY29udHJvbGxlcihcIkFzc2lnbkFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7Y29uc29sZS5sb2coXCJzZXQgYXNzaWduZWVcIiksdC5nZXRBc3NpZ25lZXMoKS50aGVuKGZ1bmN0aW9uKHQpe2UudXNlcnM9dC5kYXRhLnVzZXJzLGUudXNlcnM9cy5yZW1vdmVVc2VyRnJvbVVzZXJzKGUudXNlcnMsW2UudGlja2V0LmNyZWF0ZWRCeSxlLnRpY2tldC5hc3NpZ25lZV0pLGUuYXNzaWduZWU9ZS51c2Vyc1swXS51c2VybmFtZX0pLGUuc2V0U2F2ZUZuKGZ1bmN0aW9uKCl7cmV0dXJuIGUuYWN0aW9uRm9ybS5jb21tZW50LiRpbnZhbGlkfHxlLmFjdGlvbkZvcm0uYXNzaWduZWUuJGludmFsaWQ/KGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwLHZvaWQoZS5hY3Rpb25Gb3JtLmFzc2lnbmVlLiR0b3VjaGVkPSEwKSk6KGNvbnNvbGUubG9nKGUudGFzay5ub3RpZnlVc2Vycyksdm9pZCB0LmFzc2lnbihlLnRpY2tldC5pZCxlLmFzc2lnbmVlLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtzLmNyZWF0ZUZsYXNoTWVzc2FnZSh0LFwiVGhlIGFzc2lnbmVlIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7YS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksdC5kYXRhLmNvbW1lbnRzJiYoZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLGUudGlja2V0LmFzc2lnbmVlPXQuZGF0YS5hc3NpZ25lZSksZS5jYW5jZWxUYXNrKCl9KS5jYXRjaChmdW5jdGlvbih0KXthLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gYXNzaWduIHRoZSB0aWNrZXQuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQXNzaWduIFRpY2tldFwiKX1dKS5jb250cm9sbGVyKFwiQ2hhbmdlU3RhdHVzQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXt2YXIgbj1lLnRpY2tldC5zdGF0dXM7dC5nZXRBbGxvd2VkU3RhdHVzKG4pLnRoZW4oZnVuY3Rpb24odCl7Y29uc29sZS5sb2codC5kYXRhKSxlLmFsbG93ZWRTdGF0dXM9dC5kYXRhLnN0YXR1cy5hbGxvd2VkLGUubmV3U3RhdHVzPWUuYWxsb3dlZFN0YXR1c1swXX0pLGUuc2V0U2F2ZUZuKGZ1bmN0aW9uKCl7cmV0dXJuIGUuYWN0aW9uRm9ybS5jb21tZW50LiRpbnZhbGlkfHxlLmFjdGlvbkZvcm0ubmV3U3RhdHVzLiRpbnZhbGlkPyhlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCx2b2lkKGUuYWN0aW9uRm9ybS5uZXdTdGF0dXMuJHRvdWNoZWQ9ITApKTp2b2lkIHQuY2hhbmdlU3RhdHVzKGUudGlja2V0LmlkLGUubmV3U3RhdHVzLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJDaGFuZ2UgU3RhdHVzXCIpfV0pLmNvbnRyb2xsZXIoXCJDb21tZW50QWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuYWRkQ29tbWVudChlLnRpY2tldC5pZCxlLnRhc2suY29tbWVudCxlLnRhc2subm90aWZ5VXNlcnMpLnRoZW4oZnVuY3Rpb24odCl7ZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLHMuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgY29tbWVudCBoYXMgYmVlbiBhZGRlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBhZGQgY29tbWVudC4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKSxlLmNhbmNlbFRhc2soKX0pfSksZS5zZXRTYXZlQnRuTmFtZShcIkFkZCBDb21tZW50XCIpfV0pLmNvbnRyb2xsZXIoXCJDbG9zZUFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtyZXR1cm4gZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQ/dm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk6dm9pZCB0LmNsb3NlKGUudGlja2V0LmlkLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJDbG9zZVwiKX1dKS5jb250cm9sbGVyKFwiUmVvcGVuQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQucmVvcGVuKGUudGlja2V0LmlkLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJSZW9wZW5cIil9XSkuY29udHJvbGxlcihcIkF3YWl0aW5nQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuYXdhaXRpbmdVc2VyUmVzcG9uc2UoZS50aWNrZXQuaWQsZS50YXNrLmNvbW1lbnQsZS50YXNrLm5vdGlmeVVzZXJzKS50aGVuKGZ1bmN0aW9uKHQpe3MuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgc3RhdHVzIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7YS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksdC5kYXRhLmNvbW1lbnRzJiYoZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLGUudGlja2V0LnN0YXR1cz10LmRhdGEuc3RhdHVzKSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJDaGFuZ2UgU3RhdHVzXCIpfV0pLmNvbnRyb2xsZXIoXCJBY2tub3dsZWRnZUFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtyZXR1cm4gZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQ/dm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk6dm9pZCB0LmFja25vd2xlZGdlVGlja2V0KGUudGlja2V0LmlkLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJBY2tub3dsZWRnZSBUaWNrZXRcIil9XSkuY29udHJvbGxlcihcIkFzc2lnblRvU2VsZkFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKGUsdCxhLHMsbil7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtpZihlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZClyZXR1cm4gdm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk7dmFyIGM9bi5nZXRVc2VyKCk7dC5hc3NpZ24oZS50aWNrZXQuaWQsYy51c2VybmFtZSxlLnRhc2suY29tbWVudCxlLnRhc2subm90aWZ5VXNlcnMpLnRoZW4oZnVuY3Rpb24odCl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBhc3NpZ25lZSBoYXMgYmVlbiBjaGFuZ2VkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLHQuZGF0YS5jb21tZW50cyYmKGUudGlja2V0LmNvbW1lbnRzPXQuZGF0YS5jb21tZW50cyxlLnRpY2tldC5hc3NpZ25lZT10LmRhdGEuYXNzaWduZWUpLGUuY2FuY2VsVGFzaygpfSkuY2F0Y2goZnVuY3Rpb24odCl7YS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGFzc2lnbiB0aGUgdGlja2V0LiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQXNzaWduIFRvIFNlbGZcIil9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiQnV0dG9uR3JvdXBDdHJsXCIsW1wiJHNjb3BlXCIsXCJBY3Rpb25GYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24obyx0LG4pe28uYnV0dG9uZ3JvdXA9e30sby4kd2F0Y2hDb2xsZWN0aW9uKFwidGlja2V0XCIsZnVuY3Rpb24ocyl7cyYmIW4uaXNOdWxsT3JVbmRlZmluZWQocy5pZCkmJihuLmlzQ3VycmVudFVzZXJBZG1pbk9yU3VwcG9ydCgpP3QuZ2V0QWxsb3dlZEJ1dHRvbnMocy5pZCkudGhlbihmdW5jdGlvbih0KXtvLmJ1dHRvbmdyb3VwLnNob3dBc3NpZ249dC5hc3NpZ24sby5idXR0b25ncm91cC5zaG93Q29tbWVudD10LmNvbW1lbnQsby5idXR0b25ncm91cC5zaG93Y2hhbmdlU3RhdHVzPXQuY2hhbmdlU3RhdHVzLG8uYnV0dG9uZ3JvdXAuc2hvd1Jlb3Blbj10LnJlb3BlbixvLmJ1dHRvbmdyb3VwLnNob3dDbG9zZT10LmNsb3NlLG8uYnV0dG9uZ3JvdXAuc2hvd0Fja25vd2xlZGdlPXQuYWNrbm93bGVkZ2Usby5idXR0b25ncm91cC5zaG93QXdhaXRpbmdVc2Vyc1Jlc3BvbnNlPXQuYXdhaXRpbmdVc2VyUmVzcG9uc2Usby5idXR0b25ncm91cC5zaG93QXNzaWduVG9TZWxmPXQuYXNzaWduVG9TZWxmfSk6KG8uYnV0dG9uZ3JvdXAuc2hvd0NvbW1lbnQ9ITAsby5idXR0b25ncm91cC5zaG93QXNzaWduPSExLG8uYnV0dG9uZ3JvdXAuc2hvd2NoYW5nZVN0YXR1cz0hMSxvLmJ1dHRvbmdyb3VwLnNob3dSZW9wZW49ITEsby5idXR0b25ncm91cC5zaG93Q2xvc2U9ITEsby5idXR0b25ncm91cC5zaG93QWNrbm93bGVkZ2U9ITEsby5idXR0b25ncm91cC5zaG93QXdhaXRpbmdVc2Vyc1Jlc3BvbnNlPSExLG8uYnV0dG9uZ3JvdXAuc2hvd0Fzc2lnblRvU2VsZj0hMSkpfSksby5idXR0b25ncm91cC5jb21tZW50PWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiY29tbWVudFwiKX0sby5idXR0b25ncm91cC5hc3NpZ249ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJhc3NpZ25cIil9LG8uYnV0dG9uZ3JvdXAuY2hhbmdlU3RhdHVzPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiY2hhbmdlc3RhdHVzXCIpfSxvLmJ1dHRvbmdyb3VwLmNsb3NlPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiY2xvc2VcIil9LG8uYnV0dG9uZ3JvdXAucmVvcGVuPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwicmVvcGVuXCIpfSxvLmJ1dHRvbmdyb3VwLmFja25vd2xlZGdlPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiYWNrbm93bGVkZ2VcIil9LG8uYnV0dG9uZ3JvdXAuYXdhaXRpbmd1c2Vyc3Jlc3BvbnNlPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiYXdhaXRpbmd1c2Vyc3Jlc3BvbnNlXCIpfSxvLmJ1dHRvbmdyb3VwLmFzc2lnblRvU2VsZj1mdW5jdGlvbigpe3Quc2V0VGFzayhcImFzc2lnbnRvc2VsZlwiKX19XSk7Il0sImZpbGUiOiJtYWluLm1pbi5qcyJ9
