angular.module("ticketSystem",["ngRoute","textAngular","yangular-grid","yg-modal","ngFlash","ui.router","yg-notification","angularjs-dropdown-multiselect"]).service("authInterceptor",["$q","$injector","Authentication","HelperFactory",function(t,e,r,l){return{request:function(t){return l.setLoading(!0),t},response:function(e){return l.setLoading(!1),401===e.status&&r.clearUser(),e||t.when(e)},responseError:function(s){return l.setLoading(!1),401===s.status&&(r.clearUser(),e.get("$state").go("users-login.login")),403===s.status&&e.get("$state").go("ticket.my-tickets"),t.reject(s)}}}]).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(t,e,r){r.otherwise("/ticket/my-tickets"),e.state("ticket",{url:"/ticket",controller:"TicketsCtrl",templateUrl:"templates/tickets/tickets.html"}).state("ticket.my-tickets",{url:"/my-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-my-tickets.html"}).state("ticket.to-me-tickets",{url:"/tome-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-tome-tickets.html"}).state("ticket.all-tickets",{url:"/all-tickets",controller:"TicketsCtrl",templateUrl:"templates/tickets/view-all-tickets.html"}).state("dashboard",{url:"/ticket/dashboard",controller:"DashboardCtrl",templateUrl:"templates/tickets/dashboard.html"}).state("dashboard-to-view",{url:"/ticket/dashboard/:type/:value",controller:"DashboardToViewCtrl",templateUrl:"templates/tickets/dashboard-to-view.html"}).state("ticket-new",{url:"/ticket/new",controller:"NewTicketCtrl",templateUrl:"templates/tickets/new-ticket.html"}).state("ticket-view",{url:"/ticket/view/:id",controller:"ViewTicketCtrl",templateUrl:"templates/tickets/view-ticket.html"}).state("ticket-edit",{url:"/ticket/edit/:id",controller:"EditTicketCtrl",templateUrl:"templates/tickets/edit-ticket.html"}).state("users-login",{url:"/users",controller:"MainLoginCtrl",templateUrl:"templates/users/user-login.html"}).state("users-login.login",{url:"/login",controller:"LoginCtrl",templateUrl:"templates/users/login.html"}).state("users-login.register",{url:"/register",controller:"RegisterCtrl",templateUrl:"templates/users/register.html"}).state("users-profile",{url:"/users/profile",controller:"ProfileCtrl",templateUrl:"templates/users/profile.html"}).state("change-password",{url:"/users/profile/change-password/:id",controller:"ChangePasswordCtrl",templateUrl:"templates/users/change-password.html"}).state("users-register",{url:"/users/register",controller:"RegisterCtrl",templateUrl:"templates/users/register.html"}).state("admin-user-management",{url:"/admin/user-management",controller:"UsersListCtrl",templateUrl:"templates/admin/manage-users.html"}).state("auth-google",{url:"/auth/google/:id/:email",controller:"SetUserCtrl",templateUrl:"templates/users/set-username.html"}).state("admin-edit",{url:"/admin/edit/:username",controller:"EditUsersCtrl",templateUrl:"templates/admin/edit-user.html"}).state("admin-reset-password",{url:"/admin/reset-password/:id",controller:"ChangeUsersPasswordCtrl",templateUrl:"templates/admin/reset-password.html"}),t.interceptors.push("authInterceptor")}]);
angular.module("ticketSystem").directive("ygToggle",function(){return{restrict:"E",scope:{toggle:"="},replace:!0,template:'<div ng-show="loaded" class="toggle-button"><div class="toggle"></div></div>',link:function(e,t,i){var l=function(i){e.loaded=!0,i?t.addClass("is-active"):t.removeClass("is-active")};e.$watch("toggle.value",function(e,t){"undefined"!=typeof e&&l(e)}),t.on("click",function(){e.toggle.value=!e.toggle.value,l(e.toggle.value)})}}}).directive("ygSpinner",["HelperFactory",function(e){return{restrict:"E",template:'<div class="loading" ng-show="loading()"></div>',scope:{},link:function(t,i,l,n){t.loading=e.getLoading}}}]);
angular.module("ticketSystem").factory("TicketFactory",["$http",function(t){var e={};return e.createNewTicket=function(e){return t.post("tickets/new",e)},e.updateTicket=function(e,i){return t.put("tickets/"+e,i)},e.getTicketById=function(e){return t.get("tickets/"+e)},e.getInitialTicketData=function(e){return t.get("tickets/edit-ticket/initial-load/"+e)},e.getDashboardData=function(){return t.get("support/tickets/dashboard")},e}]);
angular.module("ticketSystem").factory("CommonFactory",["$http",function(t){var e={};return e.getInitialStaticData=function(){return t.get("tickets/static-data")},e}]).filter("reverse",function(){return function(t){if(t)return t.slice().reverse()}});
angular.module("ticketSystem").factory("UserFactory",["$http",function(e){var r={};return r.login=function(r,t,s){return e.post("accounts/login",{username:r,password:t,remember:s})},r.logout=function(){return e.get("accounts/logout")},r.registerUser=function(r){return e.post("accounts/register",r)},r.getUserByUsername=function(r){return e.get("users/profile/"+r)},r.updateProfile=function(r){return e.post("users/profile/"+r.username,r)},r.setUsername=function(r){return e.post("accounts/set-username",r)},r.changePassword=function(r,t){return e.post("users/profile/change-password/"+r,t)},r.getAllUserDetails=function(){return e.get("support/users/users-details")},r.getUserDetails=function(r){return e.get("admin/users/user-details/"+r)},r.updateUserDetails=function(r,t){return e.post("admin/users/update-user/"+r,t)},r.resetPassword=function(r,t){return e.post("admin/users/reset-password/"+r,t)},r}]);
angular.module("ticketSystem").factory("Authentication",function(){var t={};return t.getIsAuthenticated=function(){if(localStorage.getItem("ticketSystemUser"))return!0},t.setUser=function(t){localStorage.setItem("ticketSystemUser",JSON.stringify(t))},t.clearUser=function(){localStorage.removeItem("ticketSystemUser")},t.getUser=function(){return JSON.parse(localStorage.getItem("ticketSystemUser"))},t});
angular.module("ticketSystem").factory("HelperFactory",["Authentication",function(r){var e={},n={};return n.loading=!1,e.createFlashMessage=function(r,e){return r.data.errors?r.data.errors.map(function(r){return{message:r.error,class:"danger"}}):e?[{message:e,class:"success"}]:[]},e.getAllUsersButSelf=function(e){var n=r.getUser().username;return e.filter(function(r){return r.username!==n})},e.removeUserFromUsers=function(r,e){return r.filter(function(r){var n=e.indexOf(r.username)===-1;return n})},e.isCurrentUserAdmin=function(){var e=r.getUser();return e.role.indexOf("Admin")>-1},e.isCurrentUserSupport=function(){var e=r.getUser();return e.role.indexOf("Support")>-1},e.isCurrentUserAdminOrSupport=function(){return e.isCurrentUserAdmin()||e.isCurrentUserSupport()},e.stripHtml=function(r){return r?String(r).replace(/<[^>]+>/gm,""):""},e.getLoading=function(){return n.loading},e.setLoading=function(r){n.loading=r},e.isNullOrUndefined=function(r){return null===r||(void 0===r||void 0)},e}]);
angular.module("ticketSystem").factory("ActionFactory",["$http","$q",function(t,n){var e,o={};return o.setTask=function(t){e=t},o.getTask=function(){return e},o.getAssignees=function(){return t.get("static/all-users")},o.getAllowedStatus=function(n){return t.get("static/allowed-status/"+n)},o.getAllowedButtons=function(e){var o=n.defer();return t.get("static/action-buttons/"+e).then(function(t){var n={};n.assign=t.data.actionButtons.assign,n.comment=t.data.actionButtons.comment,n.changeStatus=t.data.actionButtons.changeStatus,n.reopen=t.data.actionButtons.reopen,n.close=t.data.actionButtons.close,n.acknowledge=t.data.actionButtons.acknowledge,n.awaitingUserResponse=t.data.actionButtons.awaitingUserResponse,n.assignToSelf=t.data.actionButtons.assignToSelf,o.resolve(n)}).catch(function(t){o.reject(t)}),o.promise},o.assign=function(n,e,o,s){return t.post("admin/tickets/assign/"+n,{assignee:e,comment:o,notify:s})},o.changeStatus=function(n,e,o,s){return t.post("admin/tickets/change-status/"+n,{status:e,comment:o,notify:s})},o.awaitingUserResponse=function(n,e,o){return t.post("admin/tickets/awaiting-user-response/"+n,{comment:e,notify:o})},o.reopen=function(n,e,o){return t.post("admin/tickets/re-open/"+n,{comment:e,notify:o})},o.close=function(n,e,o){return t.post("admin/tickets/close/"+n,{comment:e,notify:o})},o.acknowledgeTicket=function(n,e,o){return t.post("admin/tickets/acknowledge/"+n,{comment:e,notify:o})},o.addComment=function(n,e){return t.post("tickets/addComment/"+n,{comment:e})},o.deleteComment=function(n,e){return t.delete("tickets/deleteComment/"+n._id+"?commentId="+e._id)},o}]);
angular.module("ticketSystem").controller("MainCtrl",["$scope","$state","Authentication","UserFactory","$window","YgNotify","HelperFactory",function(e,t,i,n,r,o,s){var a=function(){var t=i.getUser();t.role.indexOf("Admin")>-1?e.isAdmin=!0:e.isAdmin=!1,e.isRegularUser=!0,(i.getUser().role.indexOf("Support")>-1||i.getUser().role.indexOf("Admin")>-1)&&(e.isRegularUser=!1)};e.init=function(){var t=i.getUser();t&&(t.role.indexOf("Admin")>-1?e.isAdmin=!0:e.isAdmin=!1)},e.getUser=i.getUser,e.isAuthenticated=i.getIsAuthenticated,e.logout=function(){n.logout().then(function(){i.clearUser(),t.go("users-login.login")})},e.$on("successful-login",a),e.getProfile=function(){t.go("users-profile")},r.app={},r.app.auth=function(n,r){""!==n?o.alert("danger",n.toString(),5e3):r.username&&""!==r.username?r&&(i.setUser(r),a(),e.isRegularUser?t.go("ticket.my-tickets"):t.go("dashboard")):t.go("auth-google",{id:r._id.toString(),email:r.email})}}]);
angular.module("ticketSystem").controller("NavCtrl",["$scope",function(a){a.navClass="",a.toggleNav=function(s){var e=angular.element(s.target);e.hasClass("is-open")?a.navClass="is-close":a.navClass="is-open"},a.navClick=function(s){a.navClass="a"===s.target.tagName.toLowerCase()?"is-close":a.navClass}}]);
angular.module("ticketSystem").controller("UsersListCtrl",["$scope","$state","$stateParams","HelperFactory","YgNotify",function(e,s,a,r,t){var i=function(){return""},n=function(e){return e===!0?"fa fa-check":"fa fa-remove"},o=function(){return""},u=function(e){return e.indexOf("Admin")>-1?"fa fa-check":"fa fa-remove"};e.config={},e.config.url="/support/users/users-details",e.config.columns=[],e.config.columns.push({key:"username",name:"Username",cssClass:"col-md-6"}),e.config.columns.push({key:"isActive",name:"Is Active",cssClass:"col-md-3",render:i,renderClass:n}),e.config.columns.push({key:"role",name:"Is Admin",cssClass:"col-md-3",render:o,renderClass:u}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.objectName="users",e.config.onRowClick=function(e){s.go("admin-edit",{username:e.username})}}]).controller("EditUsersCtrl",["$scope","$state","$stateParams","HelperFactory","UserFactory","YgNotify",function(e,s,a,r,t,i){e.isActive={},e.isAdmin={},e.isSupport={},e.userDetails={};var n=a.username;t.getUserDetails(n).then(function(s){e.userDetails.username=s.data.user.username,e.userDetails.firstname=s.data.user.firstname,e.userDetails.lastname=s.data.user.lastname,e.userDetails.id=s.data.user._id;var a=s.data.user.role;e.userDetails.isAdmin=a.indexOf("Admin")>-1,e.userDetails.isSupport=a.indexOf("Support")>-1,e.userDetails.isActive=s.data.user.isActive,e.userDetails.email=s.data.user.email,e.isActive.key="isActive",e.isActive.value=e.userDetails.isActive,e.isAdmin.key="isAdmin",e.isAdmin.value=e.userDetails.isAdmin,e.isSupport.key="isSupport",e.isSupport.value=e.userDetails.isSupport}).catch(function(e){i.alert("danger","There was some error trying to fetch user details. Please try again after some time.",5e3)}),e.userDetails.update=function(){return e.editUserForm.$invalid?(e.editUserForm.firstname.$touched=!0,e.editUserForm.lastname.$touched=!0,void(e.editUserForm.email.$touched=!0)):(e.userDetails.isAdmin=e.isAdmin.value,e.userDetails.isActive=e.isActive.value,e.userDetails.isSupport=e.isSupport.value,void t.updateUserDetails(e.userDetails.username,e.userDetails).then(function(e){r.createFlashMessage(e,"User details updated successfully").forEach(function(e){i.alert(e.class,e.message,5e3)})}).catch(function(e){i.alert("danger","There was some error trying to update user details. Please try again after some time.",5e3)}))}}]).controller("ChangeUsersPasswordCtrl",["$scope","$state","$stateParams","HelperFactory","UserFactory","YgNotify",function(e,s,a,r,t,i){e.changePassword={},e.changePassword.title="Reset Password",e.changePassword.saveTitle="Reset",e.changePassword.cancelHref="#/admin/user-management",e.changePassword.save=function(s){if(s.$invalid)return s.password2.$touched=!0,void(s.password1.$touched=!0);var n=a.id;t.resetPassword(n,e.changePassword).then(function(e){r.createFlashMessage(e,"Password has been reset successfully").forEach(function(e){i.alert(e.class,e.message,5e3)})}).catch(function(e){i.alert("danger","The request could not ben made successfully. Please try later",5e3)})}}]);
angular.module("ticketSystem").controller("DashboardCtrl",["$scope","$state","YgNotify","TicketFactory",function(e,t,n,o){var a=function(e){return new Date(Date.parse(e)).toLocaleDateString()},s=function(e){return e?String(e).replace(/<[^>]+>/gm,""):""},r=function(e){return e?e:"Unassigned"};e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:s}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"assignee",name:"Assignee",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:a}),e.config.columns.push({key:"createdBy",name:"Created By",cssClass:"col-md-2"}),e.config.url="/support/tickets/open-within-day",e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){t.go("ticket-view",{id:e.id})},e.config.objectName="tickets",o.getDashboardData().then(function(e){var n=e.data.tickets,o=document.getElementById("statusChart"),a=new Chart(o,{type:"doughnut",data:{labels:["New","Open","In-Progress","Awaiting User Response"],datasets:[{data:[n.new.count,n.open.count,n.inProgress.count,n.awaitingUserResponse.count],backgroundColor:["#039BE5","#F44336","#FFB300","#43A047"],hoverBackgroundColor:["#039BE5","#F44336","#FFB300","#43A047"]}]},options:{legend:{labels:{boxWidth:12,fontSize:10}}}}),s=document.getElementById("typeChart"),r=new Chart(s,{type:"doughnut",data:{labels:["Bug","Need Info","Improvement"],datasets:[{data:[n.bug.count,n.needInfo.count,n.improvement.count],backgroundColor:["#F44336","#039BE5","#FFB300"],hoverBackgroundColor:["#F44336","#039BE5","#FFB300"]}]},options:{legend:{labels:{boxWidth:12,fontSize:10}}}}),l=document.getElementById("priorityChart"),c=new Chart(l,{type:"doughnut",data:{labels:["High","Medium","Low"],datasets:[{data:[n.high.count,n.medium.count,n.low.count],backgroundColor:["#F44336","#FFB300","#43A047"],hoverBackgroundColor:["#F44336","#FFB300","#43A047"]}]},options:{legend:{labels:{boxWidth:12,fontSize:10}}}});angular.element(o).on("click",function(e){var n=a.getElementsAtEvent(e);n&&n.length>0&&n[0]._model.label&&t.go("dashboard-to-view",{type:"status",value:n[0]._model.label})}),angular.element(s).on("click",function(e){var n=r.getElementsAtEvent(e);n&&n.length>0&&n[0]._model.label&&t.go("dashboard-to-view",{type:"type",value:n[0]._model.label})}),angular.element(l).on("click",function(e){var n=c.getElementsAtEvent(e);n&&n.length>0&&n[0]._model.label&&t.go("dashboard-to-view",{type:"priority",value:n[0]._model.label})})}).catch(function(e){n.alert("danger","An error occurred while trying to fetch the dashboard data. Please try again later.",5e3)})}]);
angular.module("ticketSystem").controller("DashboardToViewCtrl",["$scope","$state","$stateParams","YgNotify","TicketFactory",function(e,s,n,o,t){function c(e){return new Date(Date.parse(e)).toLocaleDateString()}function i(e){return e?String(e).replace(/<[^>]+>/gm,""):""}function r(e){return e?e:"None"}e.type=n.type,e.value=n.value,e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:i}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"status",name:"Status",cssClass:"col-md-2"}),e.config.columns.push({key:"priority",name:"Priority",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:c}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){s.go("ticket-view",{id:e.id})},e.config.objectName="tickets",e.config.url="/support/tickets/"+n.type+"/"+n.value}]);
angular.module("ticketSystem").controller("DeleteCommentCtrl",["$scope","YgNotify","HelperFactory","YgModal","ActionFactory",function(e,t,n,o,r){var c=function(o,c){return function(){r.deleteComment(o,c).then(function(o){n.createFlashMessage(o,"The comment was deleted successfully").forEach(function(e){t.alert(e.class,e.message,5e3)}),o.data.errors||(e.ticket.comments=o.data.comments)}).catch(function(e){t.alert("danger","An error occurred while trying to delete comment. Please try again later.",5e3)})}};e.deleteComment=function(e,t){o.confirm(c(e,t)),o.open("Are you sure you want to do this?","This will delete the comment permanently")}}]);
angular.module("ticketSystem").controller("EditTicketCtrl",["$scope","$stateParams","$state","TicketFactory","YgNotify","HelperFactory","Authentication",function(t,e,a,r,i,c,n){t.toolbarConfig=[["h1","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],[],["insertLink"]],t.cancel=function(){a.go("ticket-view",{id:t.ticket.id})},t.renderDate=function(t){return new Date(Date.parse(t)).toLocaleDateString()},r.getTicketById(e.id).then(function(e){if(e.data.errors){a.go("ticket.my-tickets");var o=c.createErrorMessage(e.data.errors);o.forEach(function(t){i.alert("danger",t,5e3)})}else t.ticket=e.data.ticket,t.ticket.currentUser=n.getUser().username,r.getInitialTicketData(t.ticket.status).then(function(e){t.priorities=e.data.priorities.values,t.types=e.data.types.values,t.users=e.data.users,t.statuses=e.data.statuses}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to fetch the static data.",5e3)})}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to get ticket details. Please try again later.",5e3)}),t.update=function(){r.updateTicket(t.ticket._id,t.ticket).then(function(e){t.ticket=e.data,i.alert("success","Ticket updated successfully.",5e3),a.go("ticket-view",{id:e.data.id})}).catch(function(t){console.log(t),i.alert("danger","An error occurred while trying to update ticket details. Please try again later.",5e3)})}}]);
angular.module("ticketSystem").controller("NewTicketCtrl",["$scope","$state","TicketFactory","YgNotify","CommonFactory","HelperFactory",function(e,t,i,c,n,o){n.getInitialStaticData().then(function(t){e.newTicket.types=t.data.types.values,e.newTicket.type=e.newTicket.types[0].value}),e.newTicket={},e.toolbarConfig=[["h1","p","pre","quote"],["bold","italics","underline","strikeThrough","ul","ol","redo","undo","clear"],[],["insertLink"]],e.save=function(){return e.newTicketForm.$invalid?(e.newTicketForm.title.$touched=!0,void(e.newTicketForm.description.$touched=!0)):void i.createNewTicket({title:e.newTicket.title,description:e.newTicket.description,type:e.newTicket.type}).then(function(e){o.createFlashMessage(e,"The ticket has been created successfully").forEach(function(e){c.alert(e.class,e.message,5e3)}),e.data.id&&t.go("ticket-view",{id:e.data.id})},function(e){c.alert("danger","An error occurred while trying to create new ticket. Please try again later.",5e3),console.log(e)})}}]);

angular.module("ticketSystem").controller("TicketsCtrl",["$scope","$state","agSortFactory","HelperFactory",function(e,t,n,i){e.isSupport=!1;var c=JSON.parse(localStorage.getItem("ticketSystemUser"));c&&(c.role.indexOf("Admin")>-1||c.role.indexOf("Support")>-1)&&(e.isSupport=!0);var s=function(e){return new Date(Date.parse(e)).toLocaleDateString()},o=function(e){return e?String(e).replace(/<[^>]+>/gm,""):""},r=function(e){return e?e:"Unassigned"};e.config={},e.config.columns=[],e.config.columns.push({key:"id",name:"ID",cssClass:"col-md-1"}),e.config.columns.push({key:"title",name:"Title",cssClass:"col-md-2"}),e.config.columns.push({key:"description",name:"Description",cssClass:"col-md-2",render:o}),e.config.columns.push({key:"type",name:"Type",cssClass:"col-md-1"}),e.config.columns.push({key:"assignee",name:"Assignee",cssClass:"col-md-2",render:r}),e.config.columns.push({key:"createdDate",name:"Created Date",cssClass:"col-md-2",render:s}),e.config.columns.push({key:"createdBy",name:"Created By",cssClass:"col-md-2"}),e.config.sortQuerystringParam="sort",e.config.orderQuerystringParam="order",e.config.pageQuerystringParam="page",e.config.sizeQuerystringParam="size",e.config.onRowClick=function(e){t.go("ticket-view",{id:e.id})},e.config.objectName="tickets",e.initiateAllTicket=function(){e.config.url="/tickets/all",e.$parent.active="all"},e.initiateMyTicket=function(){e.config.url="/tickets/my",e.$parent.active="my"},e.initiateToMeTicket=function(){e.config.url="/tickets/to-me",e.$parent.active="tome"}}]);
angular.module("ticketSystem").controller("ViewTicketCtrl",["$scope","$stateParams","$state","TicketFactory","YgNotify","Authentication","HelperFactory",function(e,t,r,i,n,s,a){function c(e,t){switch(e=e||"",t.success=t.success||"",t.warning=t.warning||"",t.danger=t.danger||"",t.info=t.info||"",e.toLowerCase()){case t.success.toLowerCase():return"success";case t.warning.toLowerCase():return"warning";case t.danger.toLowerCase():return"danger";case t.info.toLowerCase():return"info";default:return"info"}}function o(e){return c(e,{success:"in-progress",warning:"open",info:"new",danger:"resolved"})}function u(e){return c(e,{success:"low",warning:"medium",danger:"high"})}function d(e){return e.assignee===e.currentUser||(e.createdBy===e.currentUser||(!!a.isCurrentUserAdmin()||!!a.isCurrentUserSupport()))}i.getTicketById(t.id).then(function(t){a.createFlashMessage(t).forEach(function(e){n.alert(e.class,e.message,5e3)}),t.data.errors||(e.ticket=t.data.ticket,e.ticket.description=a.stripHtml(e.ticket.description),e.ticket.assignee=e.ticket.assignee?e.ticket.assignee:"Unassigned",e.ticket.createdDate=e.renderDate(e.ticket.createdDate),e.ticket.currentUser=s.getUser().username,e.statusClass=o(e.ticket.status),e.ticket.priority=e.ticket.priority||"N.A",e.priorityClass=u(e.ticket.priority),d(e.ticket)&&(e.showEdit=!0))}).catch(function(e){n.alert("danger","An error occurred while trying to get ticket details. Please try again later.",5e3)}),e.ticket={},e.edit=function(){r.go("ticket-edit",{id:e.ticket.id})},e.renderDate=function(e){return new Date(Date.parse(e)).toLocaleDateString()}}]);
angular.module("ticketSystem").controller("ChangePasswordCtrl",["$scope","$state","$stateParams","UserFactory","HelperFactory","YgNotify",function(e,s,a,r,o,t){e.changePassword={},e.changePassword.title="Change Password",e.changePassword.saveTitle="Change Password",e.changePassword.cancelHref="#/users/profile",e.changePassword.save=function(c){if(c.$invalid)return c.password2.$touched=!0,void(c.password1.$touched=!0);var n=a.id;r.changePassword(n,e.changePassword).then(function(e){o.createFlashMessage(e,"The password has been changed successfully").forEach(function(e){t.alert(e.class,e.message,5e3)}),e.data.errors||s.go("users-profile")}).catch(function(e){t.alert("danger","The request could not ben made successfully. Please try later",5e3)})}}]);
angular.module("ticketSystem").controller("LoginCtrl",["$scope","$state","$window","UserFactory","Authentication","HelperFactory",function(e,t,o,r,i,n){i.getUser()&&t.go("ticket.my-tickets"),e.error=!1,e.message="",e.login=function(){r.login(e.username,e.password,e.remember).then(function(o){o.data.isAuthenticated?(i.setUser(o.data.user),e.$emit("successful-login"),n.isCurrentUserAdminOrSupport()?t.go("dashboard"):t.go("ticket.my-tickets")):(e.error=!0,e.message=o.data.msg)}).catch(function(t){e.error=!0,e.message="An error occurred while trying to log you in. Please try again later"})},e.googleLogin=function(){var e="accounts/auth/google",t=600,r=450,i=(window.outerHeight-r)/2,n=(window.outerWidth-t)/2;o.open(e,"facebook_login","width="+t+",height="+r+",scrollbars=0,top="+i+",left="+n)}}]);
angular.module("ticketSystem").controller("MainLoginCtrl",["$rootScope","$scope","$state",function(t,e,n){e.statename=n.current.name,t.$on("$stateChangeStart",function(t,n,a,o,r){e.statename=n.name})}]);
angular.module("ticketSystem").controller("ProfileCtrl",["$scope","$state","Authentication","UserFactory","HelperFactory","YgNotify",function(e,a,r,s,t,u){e.user={},e.init=function(){s.getUserByUsername(r.getUser().username).then(function(a){t.createFlashMessage(a).forEach(function(e){u.alert(e.class,e.message,5e3)}),a.data.errors||(e.user.firstname=a.data.user.firstname,e.user.lastname=a.data.user.lastname,e.user.username=a.data.user.username,e.user.email=a.data.user.email,e.user.userId=a.data.user._id)})},e.update=function(){return e.profileForm.$invalid?(e.profileForm.firstname.$touched=!0,e.profileForm.lastname.$touched=!0,void(e.profileForm.email.$touched=!0)):(t.setLoading(!0),void s.updateProfile(e.user).then(function(a){t.createFlashMessage(a,"User details have been updated successfully").forEach(function(e){u.alert(e.class,e.message,5e3)}),a.data.errors||(e.user.firstname=a.data.user.firstname,e.user.lastname=a.data.user.lastname,e.user.username=a.data.user.username,e.user.email=a.data.user.email,e.user.role=a.data.user.role,r.setUser(e.user))}).catch(function(e){u.alert("danger","There was some error trying to update user details. Please try again after some time.",5e3)}))}}]);
angular.module("ticketSystem").controller("RegisterCtrl",["$scope","$state","UserFactory","HelperFactory","YgNotify",function(e,r,t,s,a){e.newUser={},e.register=function(){t.registerUser(e.newUser).then(function(e){s.createFlashMessage(e,"User has been created successfully. You can now login.").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.data.errors&&r.go("users-login.login")}).catch(function(e){a.alert("danger","There was some error trying to create the user. Please try again after some time.",5e3)})}}]);
angular.module("ticketSystem").controller("SetUserCtrl",["$scope","$stateParams","$state","UserFactory","YgNotify","Authentication",function(e,s,t,a,r,n){var c=s.id,o=s.email;e.setUsername={},e.setUsername.email=o,e.saveUsername=function(){a.setUsername({id:c,username:e.setUsername.username}).then(function(s){HelperFactory.createFlashMessage(s,"Username has been set successfully.").forEach(function(e){r.alert(e.class,e.message,5e3)}),s.data.errors||(n.setUser(s.data.user),e.$emit("successful-login"),t.go("ticket.my-tickets"))}).catch(function(e){r.alert("danger","There was some error trying to set the username. Please try again after some time.",5e3)})}}]);
angular.module("ticketSystem").controller("ActionsCtrl",["$scope","ActionFactory","HelperFactory","UserFactory","YgNotify","$rootScope",function(e,t,a,s,n,c){e.getTask=t.getTask,e.task={},s.getAllUserDetails().then(function(t){var a=t.data.users;e.task.allUsers=a,e.task.notifyUsers=[],e.task.multiselectOptions={smartButtonMaxItems:4,displayProp:"username",idProp:"username"}}).catch(function(e){n.alert("danger","There was some error trying to get the list of all the users. Please try again after some time.",5e3)}),e.task.showTaskPanel=!1,e.task.showMainPanel=!1,t.setTask(null),e.setSaveFn=function(t){e.saveTask=t},e.cancelTask=function(){t.setTask(null),e.task.comment="",e.task.showTaskPanel=!1,e.task.showMainPanel=!1},e.setSaveBtnName=function(t){e.saveBtnName=t},e.$watch("getTask()",function(t,a){if(e.task.name=null,t)switch(e.task.showTaskPanel=!0,e.task.showMainPanel=!0,e.task.name="templates/partials/action/"+t+"-action-partial.html",t){case"comment":e.task.title="Add new comment";break;case"awaitingusersresponse":e.task.title="Awaiting users response";break;case"close":e.task.title="Close ticket";break;case"reopen":e.task.title="Reopen ticket";break;case"acknowledge":e.task.title="Acknowledge ticket";break;case"assign":e.task.title="Assign ticket";break;case"changestatus":e.task.title="Change ticket status";break;case"assigntoself":e.task.title="Assign to self"}})}]).controller("AssignActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){console.log("set assignee"),t.getAssignees().then(function(t){e.users=t.data.users,e.users=s.removeUserFromUsers(e.users,[e.ticket.createdBy,e.ticket.assignee]),e.assignee=e.users[0].username}),e.setSaveFn(function(){return e.actionForm.comment.$invalid||e.actionForm.assignee.$invalid?(e.actionForm.comment.$touched=!0,void(e.actionForm.assignee.$touched=!0)):(console.log(e.task.notifyUsers),void t.assign(e.ticket.id,e.assignee,e.task.comment,e.task.notifyUsers).then(function(t){s.createFlashMessage(t,"The assignee has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.assignee=t.data.assignee),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to assign the ticket. Please try again after some time.",5e3),e.cancelTask()}))}),e.setSaveBtnName("Assign Ticket")}]).controller("ChangeStatusActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){var n=e.ticket.status;t.getAllowedStatus(n).then(function(t){console.log(t.data),e.allowedStatus=t.data.status.allowed,e.newStatus=e.allowedStatus[0]}),e.setSaveFn(function(){return e.actionForm.comment.$invalid||e.actionForm.newStatus.$invalid?(e.actionForm.comment.$touched=!0,void(e.actionForm.newStatus.$touched=!0)):void t.changeStatus(e.ticket.id,e.newStatus,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Change Status")}]).controller("CommentActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.addComment(e.ticket.id,e.task.comment).then(function(t){e.ticket.comments=t.data.comments,s.createFlashMessage(t,"The comment has been added successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to add comment. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Add Comment")}]).controller("CloseActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.close(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Close")}]).controller("ReopenActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.reopen(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Reopen")}]).controller("AwaitingActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.awaitingUserResponse(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.status=t.data.status),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Change Status")}]).controller("AcknowledgeActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory",function(e,t,a,s){e.setSaveFn(function(){return e.actionForm.comment.$invalid?void(e.actionForm.comment.$touched=!0):void t.acknowledgeTicket(e.ticket.id,e.task.comment,e.task.notifyUsers).then(function(t){e.ticket.comments=t.data.comments,e.ticket.status=t.data.status,s.createFlashMessage(t,"The status has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to change the ticket status. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Acknowledge Ticket")}]).controller("AssignToSelfActionCtrl",["$scope","ActionFactory","YgNotify","HelperFactory","Authentication",function(e,t,a,s,n){e.setSaveFn(function(){if(e.actionForm.comment.$invalid)return void(e.actionForm.comment.$touched=!0);var c=n.getUser();console.log(c),t.assign(e.ticket.id,c.username,e.task.comment,e.task.notifyUsers).then(function(t){s.createFlashMessage(t,"The assignee has been changed successfully").forEach(function(e){a.alert(e.class,e.message,5e3)}),t.data.comments&&(e.ticket.comments=t.data.comments,e.ticket.assignee=t.data.assignee),e.cancelTask()}).catch(function(t){a.alert("danger","There was some error trying to assign the ticket. Please try again after some time.",5e3),e.cancelTask()})}),e.setSaveBtnName("Assign To Self")}]);
angular.module("ticketSystem").controller("ButtonGroupCtrl",["$scope","ActionFactory","HelperFactory",function(o,t,n){o.buttongroup={},o.$watchCollection("ticket",function(s){s&&!n.isNullOrUndefined(s.id)&&(n.isCurrentUserAdminOrSupport()?t.getAllowedButtons(s.id).then(function(t){o.buttongroup.showAssign=t.assign,o.buttongroup.showComment=t.comment,o.buttongroup.showchangeStatus=t.changeStatus,o.buttongroup.showReopen=t.reopen,o.buttongroup.showClose=t.close,o.buttongroup.showAcknowledge=t.acknowledge,o.buttongroup.showAwaitingUsersResponse=t.awaitingUserResponse,o.buttongroup.showAssignToSelf=t.assignToSelf}):(o.buttongroup.showAssign=!1,o.buttongroup.showComment=!1,o.buttongroup.showchangeStatus=!1,o.buttongroup.showReopen=!1,o.buttongroup.showClose=!1,o.buttongroup.showAcknowledge=!1,o.buttongroup.showAwaitingUsersResponse=!1,o.buttongroup.showAssignToSelf=!1))}),o.buttongroup.comment=function(){t.setTask("comment")},o.buttongroup.assign=function(){t.setTask("assign")},o.buttongroup.changeStatus=function(){t.setTask("changestatus")},o.buttongroup.close=function(){t.setTask("close")},o.buttongroup.reopen=function(){t.setTask("reopen")},o.buttongroup.acknowledge=function(){t.setTask("acknowledge")},o.buttongroup.awaitingusersresponse=function(){t.setTask("awaitingusersresponse")},o.buttongroup.assignToSelf=function(){t.setTask("assigntoself")}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtYWluLm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiLFtcIm5nUm91dGVcIixcInRleHRBbmd1bGFyXCIsXCJ5YW5ndWxhci1ncmlkXCIsXCJ5Zy1tb2RhbFwiLFwibmdGbGFzaFwiLFwidWkucm91dGVyXCIsXCJ5Zy1ub3RpZmljYXRpb25cIixcImFuZ3VsYXJqcy1kcm9wZG93bi1tdWx0aXNlbGVjdFwiXSkuc2VydmljZShcImF1dGhJbnRlcmNlcHRvclwiLFtcIiRxXCIsXCIkaW5qZWN0b3JcIixcIkF1dGhlbnRpY2F0aW9uXCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24odCxlLHIsbCl7cmV0dXJue3JlcXVlc3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGwuc2V0TG9hZGluZyghMCksdH0scmVzcG9uc2U6ZnVuY3Rpb24oZSl7cmV0dXJuIGwuc2V0TG9hZGluZyghMSksNDAxPT09ZS5zdGF0dXMmJnIuY2xlYXJVc2VyKCksZXx8dC53aGVuKGUpfSxyZXNwb25zZUVycm9yOmZ1bmN0aW9uKHMpe3JldHVybiBsLnNldExvYWRpbmcoITEpLDQwMT09PXMuc3RhdHVzJiYoci5jbGVhclVzZXIoKSxlLmdldChcIiRzdGF0ZVwiKS5nbyhcInVzZXJzLWxvZ2luLmxvZ2luXCIpKSw0MDM9PT1zLnN0YXR1cyYmZS5nZXQoXCIkc3RhdGVcIikuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKSx0LnJlamVjdChzKX19fV0pLmNvbmZpZyhbXCIkaHR0cFByb3ZpZGVyXCIsXCIkc3RhdGVQcm92aWRlclwiLFwiJHVybFJvdXRlclByb3ZpZGVyXCIsZnVuY3Rpb24odCxlLHIpe3Iub3RoZXJ3aXNlKFwiL3RpY2tldC9teS10aWNrZXRzXCIpLGUuc3RhdGUoXCJ0aWNrZXRcIix7dXJsOlwiL3RpY2tldFwiLGNvbnRyb2xsZXI6XCJUaWNrZXRzQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvdGlja2V0cy5odG1sXCJ9KS5zdGF0ZShcInRpY2tldC5teS10aWNrZXRzXCIse3VybDpcIi9teS10aWNrZXRzXCIsY29udHJvbGxlcjpcIlRpY2tldHNDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy92aWV3LW15LXRpY2tldHMuaHRtbFwifSkuc3RhdGUoXCJ0aWNrZXQudG8tbWUtdGlja2V0c1wiLHt1cmw6XCIvdG9tZS10aWNrZXRzXCIsY29udHJvbGxlcjpcIlRpY2tldHNDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy92aWV3LXRvbWUtdGlja2V0cy5odG1sXCJ9KS5zdGF0ZShcInRpY2tldC5hbGwtdGlja2V0c1wiLHt1cmw6XCIvYWxsLXRpY2tldHNcIixjb250cm9sbGVyOlwiVGlja2V0c0N0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL3ZpZXctYWxsLXRpY2tldHMuaHRtbFwifSkuc3RhdGUoXCJkYXNoYm9hcmRcIix7dXJsOlwiL3RpY2tldC9kYXNoYm9hcmRcIixjb250cm9sbGVyOlwiRGFzaGJvYXJkQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvZGFzaGJvYXJkLmh0bWxcIn0pLnN0YXRlKFwiZGFzaGJvYXJkLXRvLXZpZXdcIix7dXJsOlwiL3RpY2tldC9kYXNoYm9hcmQvOnR5cGUvOnZhbHVlXCIsY29udHJvbGxlcjpcIkRhc2hib2FyZFRvVmlld0N0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy90aWNrZXRzL2Rhc2hib2FyZC10by12aWV3Lmh0bWxcIn0pLnN0YXRlKFwidGlja2V0LW5ld1wiLHt1cmw6XCIvdGlja2V0L25ld1wiLGNvbnRyb2xsZXI6XCJOZXdUaWNrZXRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy9uZXctdGlja2V0Lmh0bWxcIn0pLnN0YXRlKFwidGlja2V0LXZpZXdcIix7dXJsOlwiL3RpY2tldC92aWV3LzppZFwiLGNvbnRyb2xsZXI6XCJWaWV3VGlja2V0Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3RpY2tldHMvdmlldy10aWNrZXQuaHRtbFwifSkuc3RhdGUoXCJ0aWNrZXQtZWRpdFwiLHt1cmw6XCIvdGlja2V0L2VkaXQvOmlkXCIsY29udHJvbGxlcjpcIkVkaXRUaWNrZXRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdGlja2V0cy9lZGl0LXRpY2tldC5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLWxvZ2luXCIse3VybDpcIi91c2Vyc1wiLGNvbnRyb2xsZXI6XCJNYWluTG9naW5DdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvdXNlci1sb2dpbi5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLWxvZ2luLmxvZ2luXCIse3VybDpcIi9sb2dpblwiLGNvbnRyb2xsZXI6XCJMb2dpbkN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9sb2dpbi5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLWxvZ2luLnJlZ2lzdGVyXCIse3VybDpcIi9yZWdpc3RlclwiLGNvbnRyb2xsZXI6XCJSZWdpc3RlckN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9yZWdpc3Rlci5odG1sXCJ9KS5zdGF0ZShcInVzZXJzLXByb2ZpbGVcIix7dXJsOlwiL3VzZXJzL3Byb2ZpbGVcIixjb250cm9sbGVyOlwiUHJvZmlsZUN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy91c2Vycy9wcm9maWxlLmh0bWxcIn0pLnN0YXRlKFwiY2hhbmdlLXBhc3N3b3JkXCIse3VybDpcIi91c2Vycy9wcm9maWxlL2NoYW5nZS1wYXNzd29yZC86aWRcIixjb250cm9sbGVyOlwiQ2hhbmdlUGFzc3dvcmRDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvY2hhbmdlLXBhc3N3b3JkLmh0bWxcIn0pLnN0YXRlKFwidXNlcnMtcmVnaXN0ZXJcIix7dXJsOlwiL3VzZXJzL3JlZ2lzdGVyXCIsY29udHJvbGxlcjpcIlJlZ2lzdGVyQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL3VzZXJzL3JlZ2lzdGVyLmh0bWxcIn0pLnN0YXRlKFwiYWRtaW4tdXNlci1tYW5hZ2VtZW50XCIse3VybDpcIi9hZG1pbi91c2VyLW1hbmFnZW1lbnRcIixjb250cm9sbGVyOlwiVXNlcnNMaXN0Q3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL2FkbWluL21hbmFnZS11c2Vycy5odG1sXCJ9KS5zdGF0ZShcImF1dGgtZ29vZ2xlXCIse3VybDpcIi9hdXRoL2dvb2dsZS86aWQvOmVtYWlsXCIsY29udHJvbGxlcjpcIlNldFVzZXJDdHJsXCIsdGVtcGxhdGVVcmw6XCJ0ZW1wbGF0ZXMvdXNlcnMvc2V0LXVzZXJuYW1lLmh0bWxcIn0pLnN0YXRlKFwiYWRtaW4tZWRpdFwiLHt1cmw6XCIvYWRtaW4vZWRpdC86dXNlcm5hbWVcIixjb250cm9sbGVyOlwiRWRpdFVzZXJzQ3RybFwiLHRlbXBsYXRlVXJsOlwidGVtcGxhdGVzL2FkbWluL2VkaXQtdXNlci5odG1sXCJ9KS5zdGF0ZShcImFkbWluLXJlc2V0LXBhc3N3b3JkXCIse3VybDpcIi9hZG1pbi9yZXNldC1wYXNzd29yZC86aWRcIixjb250cm9sbGVyOlwiQ2hhbmdlVXNlcnNQYXNzd29yZEN0cmxcIix0ZW1wbGF0ZVVybDpcInRlbXBsYXRlcy9hZG1pbi9yZXNldC1wYXNzd29yZC5odG1sXCJ9KSx0LmludGVyY2VwdG9ycy5wdXNoKFwiYXV0aEludGVyY2VwdG9yXCIpfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuZGlyZWN0aXZlKFwieWdUb2dnbGVcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVcIixzY29wZTp7dG9nZ2xlOlwiPVwifSxyZXBsYWNlOiEwLHRlbXBsYXRlOic8ZGl2IG5nLXNob3c9XCJsb2FkZWRcIiBjbGFzcz1cInRvZ2dsZS1idXR0b25cIj48ZGl2IGNsYXNzPVwidG9nZ2xlXCI+PC9kaXY+PC9kaXY+JyxsaW5rOmZ1bmN0aW9uKGUsdCxpKXt2YXIgbD1mdW5jdGlvbihpKXtlLmxvYWRlZD0hMCxpP3QuYWRkQ2xhc3MoXCJpcy1hY3RpdmVcIik6dC5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKX07ZS4kd2F0Y2goXCJ0b2dnbGUudmFsdWVcIixmdW5jdGlvbihlLHQpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBlJiZsKGUpfSksdC5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXtlLnRvZ2dsZS52YWx1ZT0hZS50b2dnbGUudmFsdWUsbChlLnRvZ2dsZS52YWx1ZSl9KX19fSkuZGlyZWN0aXZlKFwieWdTcGlubmVyXCIsW1wiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUpe3JldHVybntyZXN0cmljdDpcIkVcIix0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cImxvYWRpbmdcIiBuZy1zaG93PVwibG9hZGluZygpXCI+PC9kaXY+JyxzY29wZTp7fSxsaW5rOmZ1bmN0aW9uKHQsaSxsLG4pe3QubG9hZGluZz1lLmdldExvYWRpbmd9fX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJUaWNrZXRGYWN0b3J5XCIsW1wiJGh0dHBcIixmdW5jdGlvbih0KXt2YXIgZT17fTtyZXR1cm4gZS5jcmVhdGVOZXdUaWNrZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHQucG9zdChcInRpY2tldHMvbmV3XCIsZSl9LGUudXBkYXRlVGlja2V0PWZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQucHV0KFwidGlja2V0cy9cIitlLGkpfSxlLmdldFRpY2tldEJ5SWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHQuZ2V0KFwidGlja2V0cy9cIitlKX0sZS5nZXRJbml0aWFsVGlja2V0RGF0YT1mdW5jdGlvbihlKXtyZXR1cm4gdC5nZXQoXCJ0aWNrZXRzL2VkaXQtdGlja2V0L2luaXRpYWwtbG9hZC9cIitlKX0sZS5nZXREYXNoYm9hcmREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHQuZ2V0KFwic3VwcG9ydC90aWNrZXRzL2Rhc2hib2FyZFwiKX0sZX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJDb21tb25GYWN0b3J5XCIsW1wiJGh0dHBcIixmdW5jdGlvbih0KXt2YXIgZT17fTtyZXR1cm4gZS5nZXRJbml0aWFsU3RhdGljRGF0YT1mdW5jdGlvbigpe3JldHVybiB0LmdldChcInRpY2tldHMvc3RhdGljLWRhdGFcIil9LGV9XSkuZmlsdGVyKFwicmV2ZXJzZVwiLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe2lmKHQpcmV0dXJuIHQuc2xpY2UoKS5yZXZlcnNlKCl9fSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5mYWN0b3J5KFwiVXNlckZhY3RvcnlcIixbXCIkaHR0cFwiLGZ1bmN0aW9uKGUpe3ZhciByPXt9O3JldHVybiByLmxvZ2luPWZ1bmN0aW9uKHIsdCxzKXtyZXR1cm4gZS5wb3N0KFwiYWNjb3VudHMvbG9naW5cIix7dXNlcm5hbWU6cixwYXNzd29yZDp0LHJlbWVtYmVyOnN9KX0sci5sb2dvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZS5nZXQoXCJhY2NvdW50cy9sb2dvdXRcIil9LHIucmVnaXN0ZXJVc2VyPWZ1bmN0aW9uKHIpe3JldHVybiBlLnBvc3QoXCJhY2NvdW50cy9yZWdpc3RlclwiLHIpfSxyLmdldFVzZXJCeVVzZXJuYW1lPWZ1bmN0aW9uKHIpe3JldHVybiBlLmdldChcInVzZXJzL3Byb2ZpbGUvXCIrcil9LHIudXBkYXRlUHJvZmlsZT1mdW5jdGlvbihyKXtyZXR1cm4gZS5wb3N0KFwidXNlcnMvcHJvZmlsZS9cIityLnVzZXJuYW1lLHIpfSxyLnNldFVzZXJuYW1lPWZ1bmN0aW9uKHIpe3JldHVybiBlLnBvc3QoXCJhY2NvdW50cy9zZXQtdXNlcm5hbWVcIixyKX0sci5jaGFuZ2VQYXNzd29yZD1mdW5jdGlvbihyLHQpe3JldHVybiBlLnBvc3QoXCJ1c2Vycy9wcm9maWxlL2NoYW5nZS1wYXNzd29yZC9cIityLHQpfSxyLmdldEFsbFVzZXJEZXRhaWxzPWZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0KFwic3VwcG9ydC91c2Vycy91c2Vycy1kZXRhaWxzXCIpfSxyLmdldFVzZXJEZXRhaWxzPWZ1bmN0aW9uKHIpe3JldHVybiBlLmdldChcImFkbWluL3VzZXJzL3VzZXItZGV0YWlscy9cIityKX0sci51cGRhdGVVc2VyRGV0YWlscz1mdW5jdGlvbihyLHQpe3JldHVybiBlLnBvc3QoXCJhZG1pbi91c2Vycy91cGRhdGUtdXNlci9cIityLHQpfSxyLnJlc2V0UGFzc3dvcmQ9ZnVuY3Rpb24ocix0KXtyZXR1cm4gZS5wb3N0KFwiYWRtaW4vdXNlcnMvcmVzZXQtcGFzc3dvcmQvXCIrcix0KX0scn1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmZhY3RvcnkoXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKCl7dmFyIHQ9e307cmV0dXJuIHQuZ2V0SXNBdXRoZW50aWNhdGVkPWZ1bmN0aW9uKCl7aWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aWNrZXRTeXN0ZW1Vc2VyXCIpKXJldHVybiEwfSx0LnNldFVzZXI9ZnVuY3Rpb24odCl7bG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ0aWNrZXRTeXN0ZW1Vc2VyXCIsSlNPTi5zdHJpbmdpZnkodCkpfSx0LmNsZWFyVXNlcj1mdW5jdGlvbigpe2xvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiKX0sdC5nZXRVc2VyPWZ1bmN0aW9uKCl7cmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0aWNrZXRTeXN0ZW1Vc2VyXCIpKX0sdH0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuZmFjdG9yeShcIkhlbHBlckZhY3RvcnlcIixbXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKHIpe3ZhciBlPXt9LG49e307cmV0dXJuIG4ubG9hZGluZz0hMSxlLmNyZWF0ZUZsYXNoTWVzc2FnZT1mdW5jdGlvbihyLGUpe3JldHVybiByLmRhdGEuZXJyb3JzP3IuZGF0YS5lcnJvcnMubWFwKGZ1bmN0aW9uKHIpe3JldHVybnttZXNzYWdlOnIuZXJyb3IsY2xhc3M6XCJkYW5nZXJcIn19KTplP1t7bWVzc2FnZTplLGNsYXNzOlwic3VjY2Vzc1wifV06W119LGUuZ2V0QWxsVXNlcnNCdXRTZWxmPWZ1bmN0aW9uKGUpe3ZhciBuPXIuZ2V0VXNlcigpLnVzZXJuYW1lO3JldHVybiBlLmZpbHRlcihmdW5jdGlvbihyKXtyZXR1cm4gci51c2VybmFtZSE9PW59KX0sZS5yZW1vdmVVc2VyRnJvbVVzZXJzPWZ1bmN0aW9uKHIsZSl7cmV0dXJuIHIuZmlsdGVyKGZ1bmN0aW9uKHIpe3ZhciBuPWUuaW5kZXhPZihyLnVzZXJuYW1lKT09PS0xO3JldHVybiBufSl9LGUuaXNDdXJyZW50VXNlckFkbWluPWZ1bmN0aW9uKCl7dmFyIGU9ci5nZXRVc2VyKCk7cmV0dXJuIGUucm9sZS5pbmRleE9mKFwiQWRtaW5cIik+LTF9LGUuaXNDdXJyZW50VXNlclN1cHBvcnQ9ZnVuY3Rpb24oKXt2YXIgZT1yLmdldFVzZXIoKTtyZXR1cm4gZS5yb2xlLmluZGV4T2YoXCJTdXBwb3J0XCIpPi0xfSxlLmlzQ3VycmVudFVzZXJBZG1pbk9yU3VwcG9ydD1mdW5jdGlvbigpe3JldHVybiBlLmlzQ3VycmVudFVzZXJBZG1pbigpfHxlLmlzQ3VycmVudFVzZXJTdXBwb3J0KCl9LGUuc3RyaXBIdG1sPWZ1bmN0aW9uKHIpe3JldHVybiByP1N0cmluZyhyKS5yZXBsYWNlKC88W14+XSs+L2dtLFwiXCIpOlwiXCJ9LGUuZ2V0TG9hZGluZz1mdW5jdGlvbigpe3JldHVybiBuLmxvYWRpbmd9LGUuc2V0TG9hZGluZz1mdW5jdGlvbihyKXtuLmxvYWRpbmc9cn0sZS5pc051bGxPclVuZGVmaW5lZD1mdW5jdGlvbihyKXtyZXR1cm4gbnVsbD09PXJ8fCh2b2lkIDA9PT1yfHx2b2lkIDApfSxlfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuZmFjdG9yeShcIkFjdGlvbkZhY3RvcnlcIixbXCIkaHR0cFwiLFwiJHFcIixmdW5jdGlvbih0LG4pe3ZhciBlLG89e307cmV0dXJuIG8uc2V0VGFzaz1mdW5jdGlvbih0KXtlPXR9LG8uZ2V0VGFzaz1mdW5jdGlvbigpe3JldHVybiBlfSxvLmdldEFzc2lnbmVlcz1mdW5jdGlvbigpe3JldHVybiB0LmdldChcInN0YXRpYy9hbGwtdXNlcnNcIil9LG8uZ2V0QWxsb3dlZFN0YXR1cz1mdW5jdGlvbihuKXtyZXR1cm4gdC5nZXQoXCJzdGF0aWMvYWxsb3dlZC1zdGF0dXMvXCIrbil9LG8uZ2V0QWxsb3dlZEJ1dHRvbnM9ZnVuY3Rpb24oZSl7dmFyIG89bi5kZWZlcigpO3JldHVybiB0LmdldChcInN0YXRpYy9hY3Rpb24tYnV0dG9ucy9cIitlKS50aGVuKGZ1bmN0aW9uKHQpe3ZhciBuPXt9O24uYXNzaWduPXQuZGF0YS5hY3Rpb25CdXR0b25zLmFzc2lnbixuLmNvbW1lbnQ9dC5kYXRhLmFjdGlvbkJ1dHRvbnMuY29tbWVudCxuLmNoYW5nZVN0YXR1cz10LmRhdGEuYWN0aW9uQnV0dG9ucy5jaGFuZ2VTdGF0dXMsbi5yZW9wZW49dC5kYXRhLmFjdGlvbkJ1dHRvbnMucmVvcGVuLG4uY2xvc2U9dC5kYXRhLmFjdGlvbkJ1dHRvbnMuY2xvc2Usbi5hY2tub3dsZWRnZT10LmRhdGEuYWN0aW9uQnV0dG9ucy5hY2tub3dsZWRnZSxuLmF3YWl0aW5nVXNlclJlc3BvbnNlPXQuZGF0YS5hY3Rpb25CdXR0b25zLmF3YWl0aW5nVXNlclJlc3BvbnNlLG4uYXNzaWduVG9TZWxmPXQuZGF0YS5hY3Rpb25CdXR0b25zLmFzc2lnblRvU2VsZixvLnJlc29sdmUobil9KS5jYXRjaChmdW5jdGlvbih0KXtvLnJlamVjdCh0KX0pLG8ucHJvbWlzZX0sby5hc3NpZ249ZnVuY3Rpb24obixlLG8scyl7cmV0dXJuIHQucG9zdChcImFkbWluL3RpY2tldHMvYXNzaWduL1wiK24se2Fzc2lnbmVlOmUsY29tbWVudDpvLG5vdGlmeTpzfSl9LG8uY2hhbmdlU3RhdHVzPWZ1bmN0aW9uKG4sZSxvLHMpe3JldHVybiB0LnBvc3QoXCJhZG1pbi90aWNrZXRzL2NoYW5nZS1zdGF0dXMvXCIrbix7c3RhdHVzOmUsY29tbWVudDpvLG5vdGlmeTpzfSl9LG8uYXdhaXRpbmdVc2VyUmVzcG9uc2U9ZnVuY3Rpb24obixlLG8pe3JldHVybiB0LnBvc3QoXCJhZG1pbi90aWNrZXRzL2F3YWl0aW5nLXVzZXItcmVzcG9uc2UvXCIrbix7Y29tbWVudDplLG5vdGlmeTpvfSl9LG8ucmVvcGVuPWZ1bmN0aW9uKG4sZSxvKXtyZXR1cm4gdC5wb3N0KFwiYWRtaW4vdGlja2V0cy9yZS1vcGVuL1wiK24se2NvbW1lbnQ6ZSxub3RpZnk6b30pfSxvLmNsb3NlPWZ1bmN0aW9uKG4sZSxvKXtyZXR1cm4gdC5wb3N0KFwiYWRtaW4vdGlja2V0cy9jbG9zZS9cIituLHtjb21tZW50OmUsbm90aWZ5Om99KX0sby5hY2tub3dsZWRnZVRpY2tldD1mdW5jdGlvbihuLGUsbyl7cmV0dXJuIHQucG9zdChcImFkbWluL3RpY2tldHMvYWNrbm93bGVkZ2UvXCIrbix7Y29tbWVudDplLG5vdGlmeTpvfSl9LG8uYWRkQ29tbWVudD1mdW5jdGlvbihuLGUpe3JldHVybiB0LnBvc3QoXCJ0aWNrZXRzL2FkZENvbW1lbnQvXCIrbix7Y29tbWVudDplfSl9LG8uZGVsZXRlQ29tbWVudD1mdW5jdGlvbihuLGUpe3JldHVybiB0LmRlbGV0ZShcInRpY2tldHMvZGVsZXRlQ29tbWVudC9cIituLl9pZCtcIj9jb21tZW50SWQ9XCIrZS5faWQpfSxvfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIk1haW5DdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIkF1dGhlbnRpY2F0aW9uXCIsXCJVc2VyRmFjdG9yeVwiLFwiJHdpbmRvd1wiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsaSxuLHIsbyxzKXt2YXIgYT1mdW5jdGlvbigpe3ZhciB0PWkuZ2V0VXNlcigpO3Qucm9sZS5pbmRleE9mKFwiQWRtaW5cIik+LTE/ZS5pc0FkbWluPSEwOmUuaXNBZG1pbj0hMSxlLmlzUmVndWxhclVzZXI9ITAsKGkuZ2V0VXNlcigpLnJvbGUuaW5kZXhPZihcIlN1cHBvcnRcIik+LTF8fGkuZ2V0VXNlcigpLnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xKSYmKGUuaXNSZWd1bGFyVXNlcj0hMSl9O2UuaW5pdD1mdW5jdGlvbigpe3ZhciB0PWkuZ2V0VXNlcigpO3QmJih0LnJvbGUuaW5kZXhPZihcIkFkbWluXCIpPi0xP2UuaXNBZG1pbj0hMDplLmlzQWRtaW49ITEpfSxlLmdldFVzZXI9aS5nZXRVc2VyLGUuaXNBdXRoZW50aWNhdGVkPWkuZ2V0SXNBdXRoZW50aWNhdGVkLGUubG9nb3V0PWZ1bmN0aW9uKCl7bi5sb2dvdXQoKS50aGVuKGZ1bmN0aW9uKCl7aS5jbGVhclVzZXIoKSx0LmdvKFwidXNlcnMtbG9naW4ubG9naW5cIil9KX0sZS4kb24oXCJzdWNjZXNzZnVsLWxvZ2luXCIsYSksZS5nZXRQcm9maWxlPWZ1bmN0aW9uKCl7dC5nbyhcInVzZXJzLXByb2ZpbGVcIil9LHIuYXBwPXt9LHIuYXBwLmF1dGg9ZnVuY3Rpb24obixyKXtcIlwiIT09bj9vLmFsZXJ0KFwiZGFuZ2VyXCIsbi50b1N0cmluZygpLDVlMyk6ci51c2VybmFtZSYmXCJcIiE9PXIudXNlcm5hbWU/ciYmKGkuc2V0VXNlcihyKSxhKCksZS5pc1JlZ3VsYXJVc2VyP3QuZ28oXCJ0aWNrZXQubXktdGlja2V0c1wiKTp0LmdvKFwiZGFzaGJvYXJkXCIpKTp0LmdvKFwiYXV0aC1nb29nbGVcIix7aWQ6ci5faWQudG9TdHJpbmcoKSxlbWFpbDpyLmVtYWlsfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIk5hdkN0cmxcIixbXCIkc2NvcGVcIixmdW5jdGlvbihhKXthLm5hdkNsYXNzPVwiXCIsYS50b2dnbGVOYXY9ZnVuY3Rpb24ocyl7dmFyIGU9YW5ndWxhci5lbGVtZW50KHMudGFyZ2V0KTtlLmhhc0NsYXNzKFwiaXMtb3BlblwiKT9hLm5hdkNsYXNzPVwiaXMtY2xvc2VcIjphLm5hdkNsYXNzPVwiaXMtb3BlblwifSxhLm5hdkNsaWNrPWZ1bmN0aW9uKHMpe2EubmF2Q2xhc3M9XCJhXCI9PT1zLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk/XCJpcy1jbG9zZVwiOmEubmF2Q2xhc3N9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIlVzZXJzTGlzdEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLGZ1bmN0aW9uKGUscyxhLHIsdCl7dmFyIGk9ZnVuY3Rpb24oKXtyZXR1cm5cIlwifSxuPWZ1bmN0aW9uKGUpe3JldHVybiBlPT09ITA/XCJmYSBmYS1jaGVja1wiOlwiZmEgZmEtcmVtb3ZlXCJ9LG89ZnVuY3Rpb24oKXtyZXR1cm5cIlwifSx1PWZ1bmN0aW9uKGUpe3JldHVybiBlLmluZGV4T2YoXCJBZG1pblwiKT4tMT9cImZhIGZhLWNoZWNrXCI6XCJmYSBmYS1yZW1vdmVcIn07ZS5jb25maWc9e30sZS5jb25maWcudXJsPVwiL3N1cHBvcnQvdXNlcnMvdXNlcnMtZGV0YWlsc1wiLGUuY29uZmlnLmNvbHVtbnM9W10sZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJ1c2VybmFtZVwiLG5hbWU6XCJVc2VybmFtZVwiLGNzc0NsYXNzOlwiY29sLW1kLTZcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiaXNBY3RpdmVcIixuYW1lOlwiSXMgQWN0aXZlXCIsY3NzQ2xhc3M6XCJjb2wtbWQtM1wiLHJlbmRlcjppLHJlbmRlckNsYXNzOm59KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInJvbGVcIixuYW1lOlwiSXMgQWRtaW5cIixjc3NDbGFzczpcImNvbC1tZC0zXCIscmVuZGVyOm8scmVuZGVyQ2xhc3M6dX0pLGUuY29uZmlnLnNvcnRRdWVyeXN0cmluZ1BhcmFtPVwic29ydFwiLGUuY29uZmlnLm9yZGVyUXVlcnlzdHJpbmdQYXJhbT1cIm9yZGVyXCIsZS5jb25maWcucGFnZVF1ZXJ5c3RyaW5nUGFyYW09XCJwYWdlXCIsZS5jb25maWcuc2l6ZVF1ZXJ5c3RyaW5nUGFyYW09XCJzaXplXCIsZS5jb25maWcub2JqZWN0TmFtZT1cInVzZXJzXCIsZS5jb25maWcub25Sb3dDbGljaz1mdW5jdGlvbihlKXtzLmdvKFwiYWRtaW4tZWRpdFwiLHt1c2VybmFtZTplLnVzZXJuYW1lfSl9fV0pLmNvbnRyb2xsZXIoXCJFZGl0VXNlcnNDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiSGVscGVyRmFjdG9yeVwiLFwiVXNlckZhY3RvcnlcIixcIllnTm90aWZ5XCIsZnVuY3Rpb24oZSxzLGEscix0LGkpe2UuaXNBY3RpdmU9e30sZS5pc0FkbWluPXt9LGUuaXNTdXBwb3J0PXt9LGUudXNlckRldGFpbHM9e307dmFyIG49YS51c2VybmFtZTt0LmdldFVzZXJEZXRhaWxzKG4pLnRoZW4oZnVuY3Rpb24ocyl7ZS51c2VyRGV0YWlscy51c2VybmFtZT1zLmRhdGEudXNlci51c2VybmFtZSxlLnVzZXJEZXRhaWxzLmZpcnN0bmFtZT1zLmRhdGEudXNlci5maXJzdG5hbWUsZS51c2VyRGV0YWlscy5sYXN0bmFtZT1zLmRhdGEudXNlci5sYXN0bmFtZSxlLnVzZXJEZXRhaWxzLmlkPXMuZGF0YS51c2VyLl9pZDt2YXIgYT1zLmRhdGEudXNlci5yb2xlO2UudXNlckRldGFpbHMuaXNBZG1pbj1hLmluZGV4T2YoXCJBZG1pblwiKT4tMSxlLnVzZXJEZXRhaWxzLmlzU3VwcG9ydD1hLmluZGV4T2YoXCJTdXBwb3J0XCIpPi0xLGUudXNlckRldGFpbHMuaXNBY3RpdmU9cy5kYXRhLnVzZXIuaXNBY3RpdmUsZS51c2VyRGV0YWlscy5lbWFpbD1zLmRhdGEudXNlci5lbWFpbCxlLmlzQWN0aXZlLmtleT1cImlzQWN0aXZlXCIsZS5pc0FjdGl2ZS52YWx1ZT1lLnVzZXJEZXRhaWxzLmlzQWN0aXZlLGUuaXNBZG1pbi5rZXk9XCJpc0FkbWluXCIsZS5pc0FkbWluLnZhbHVlPWUudXNlckRldGFpbHMuaXNBZG1pbixlLmlzU3VwcG9ydC5rZXk9XCJpc1N1cHBvcnRcIixlLmlzU3VwcG9ydC52YWx1ZT1lLnVzZXJEZXRhaWxzLmlzU3VwcG9ydH0pLmNhdGNoKGZ1bmN0aW9uKGUpe2kuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBmZXRjaCB1c2VyIGRldGFpbHMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KSxlLnVzZXJEZXRhaWxzLnVwZGF0ZT1mdW5jdGlvbigpe3JldHVybiBlLmVkaXRVc2VyRm9ybS4kaW52YWxpZD8oZS5lZGl0VXNlckZvcm0uZmlyc3RuYW1lLiR0b3VjaGVkPSEwLGUuZWRpdFVzZXJGb3JtLmxhc3RuYW1lLiR0b3VjaGVkPSEwLHZvaWQoZS5lZGl0VXNlckZvcm0uZW1haWwuJHRvdWNoZWQ9ITApKTooZS51c2VyRGV0YWlscy5pc0FkbWluPWUuaXNBZG1pbi52YWx1ZSxlLnVzZXJEZXRhaWxzLmlzQWN0aXZlPWUuaXNBY3RpdmUudmFsdWUsZS51c2VyRGV0YWlscy5pc1N1cHBvcnQ9ZS5pc1N1cHBvcnQudmFsdWUsdm9pZCB0LnVwZGF0ZVVzZXJEZXRhaWxzKGUudXNlckRldGFpbHMudXNlcm5hbWUsZS51c2VyRGV0YWlscykudGhlbihmdW5jdGlvbihlKXtyLmNyZWF0ZUZsYXNoTWVzc2FnZShlLFwiVXNlciBkZXRhaWxzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7aS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSl9KS5jYXRjaChmdW5jdGlvbihlKXtpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gdXBkYXRlIHVzZXIgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKX0pKX19XSkuY29udHJvbGxlcihcIkNoYW5nZVVzZXJzUGFzc3dvcmRDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiSGVscGVyRmFjdG9yeVwiLFwiVXNlckZhY3RvcnlcIixcIllnTm90aWZ5XCIsZnVuY3Rpb24oZSxzLGEscix0LGkpe2UuY2hhbmdlUGFzc3dvcmQ9e30sZS5jaGFuZ2VQYXNzd29yZC50aXRsZT1cIlJlc2V0IFBhc3N3b3JkXCIsZS5jaGFuZ2VQYXNzd29yZC5zYXZlVGl0bGU9XCJSZXNldFwiLGUuY2hhbmdlUGFzc3dvcmQuY2FuY2VsSHJlZj1cIiMvYWRtaW4vdXNlci1tYW5hZ2VtZW50XCIsZS5jaGFuZ2VQYXNzd29yZC5zYXZlPWZ1bmN0aW9uKHMpe2lmKHMuJGludmFsaWQpcmV0dXJuIHMucGFzc3dvcmQyLiR0b3VjaGVkPSEwLHZvaWQocy5wYXNzd29yZDEuJHRvdWNoZWQ9ITApO3ZhciBuPWEuaWQ7dC5yZXNldFBhc3N3b3JkKG4sZS5jaGFuZ2VQYXNzd29yZCkudGhlbihmdW5jdGlvbihlKXtyLmNyZWF0ZUZsYXNoTWVzc2FnZShlLFwiUGFzc3dvcmQgaGFzIGJlZW4gcmVzZXQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7aS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSl9KS5jYXRjaChmdW5jdGlvbihlKXtpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGUgcmVxdWVzdCBjb3VsZCBub3QgYmVuIG1hZGUgc3VjY2Vzc2Z1bGx5LiBQbGVhc2UgdHJ5IGxhdGVyXCIsNWUzKX0pfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJEYXNoYm9hcmRDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIllnTm90aWZ5XCIsXCJUaWNrZXRGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LG4sbyl7dmFyIGE9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBEYXRlKERhdGUucGFyc2UoZSkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSxzPWZ1bmN0aW9uKGUpe3JldHVybiBlP1N0cmluZyhlKS5yZXBsYWNlKC88W14+XSs+L2dtLFwiXCIpOlwiXCJ9LHI9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/ZTpcIlVuYXNzaWduZWRcIn07ZS5jb25maWc9e30sZS5jb25maWcuY29sdW1ucz1bXSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImlkXCIsbmFtZTpcIklEXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJ0aXRsZVwiLG5hbWU6XCJUaXRsZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiZGVzY3JpcHRpb25cIixuYW1lOlwiRGVzY3JpcHRpb25cIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOnN9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInR5cGVcIixuYW1lOlwiVHlwZVwiLGNzc0NsYXNzOlwiY29sLW1kLTFcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiYXNzaWduZWVcIixuYW1lOlwiQXNzaWduZWVcIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOnJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImNyZWF0ZWREYXRlXCIsbmFtZTpcIkNyZWF0ZWQgRGF0ZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6YX0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZEJ5XCIsbmFtZTpcIkNyZWF0ZWQgQnlcIixjc3NDbGFzczpcImNvbC1tZC0yXCJ9KSxlLmNvbmZpZy51cmw9XCIvc3VwcG9ydC90aWNrZXRzL29wZW4td2l0aGluLWRheVwiLGUuY29uZmlnLnNvcnRRdWVyeXN0cmluZ1BhcmFtPVwic29ydFwiLGUuY29uZmlnLm9yZGVyUXVlcnlzdHJpbmdQYXJhbT1cIm9yZGVyXCIsZS5jb25maWcucGFnZVF1ZXJ5c3RyaW5nUGFyYW09XCJwYWdlXCIsZS5jb25maWcuc2l6ZVF1ZXJ5c3RyaW5nUGFyYW09XCJzaXplXCIsZS5jb25maWcub25Sb3dDbGljaz1mdW5jdGlvbihlKXt0LmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5pZH0pfSxlLmNvbmZpZy5vYmplY3ROYW1lPVwidGlja2V0c1wiLG8uZ2V0RGFzaGJvYXJkRGF0YSgpLnRoZW4oZnVuY3Rpb24oZSl7dmFyIG49ZS5kYXRhLnRpY2tldHMsbz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXR1c0NoYXJ0XCIpLGE9bmV3IENoYXJ0KG8se3R5cGU6XCJkb3VnaG51dFwiLGRhdGE6e2xhYmVsczpbXCJOZXdcIixcIk9wZW5cIixcIkluLVByb2dyZXNzXCIsXCJBd2FpdGluZyBVc2VyIFJlc3BvbnNlXCJdLGRhdGFzZXRzOlt7ZGF0YTpbbi5uZXcuY291bnQsbi5vcGVuLmNvdW50LG4uaW5Qcm9ncmVzcy5jb3VudCxuLmF3YWl0aW5nVXNlclJlc3BvbnNlLmNvdW50XSxiYWNrZ3JvdW5kQ29sb3I6W1wiIzAzOUJFNVwiLFwiI0Y0NDMzNlwiLFwiI0ZGQjMwMFwiLFwiIzQzQTA0N1wiXSxob3ZlckJhY2tncm91bmRDb2xvcjpbXCIjMDM5QkU1XCIsXCIjRjQ0MzM2XCIsXCIjRkZCMzAwXCIsXCIjNDNBMDQ3XCJdfV19LG9wdGlvbnM6e2xlZ2VuZDp7bGFiZWxzOntib3hXaWR0aDoxMixmb250U2l6ZToxMH19fX0pLHM9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0eXBlQ2hhcnRcIikscj1uZXcgQ2hhcnQocyx7dHlwZTpcImRvdWdobnV0XCIsZGF0YTp7bGFiZWxzOltcIkJ1Z1wiLFwiTmVlZCBJbmZvXCIsXCJJbXByb3ZlbWVudFwiXSxkYXRhc2V0czpbe2RhdGE6W24uYnVnLmNvdW50LG4ubmVlZEluZm8uY291bnQsbi5pbXByb3ZlbWVudC5jb3VudF0sYmFja2dyb3VuZENvbG9yOltcIiNGNDQzMzZcIixcIiMwMzlCRTVcIixcIiNGRkIzMDBcIl0saG92ZXJCYWNrZ3JvdW5kQ29sb3I6W1wiI0Y0NDMzNlwiLFwiIzAzOUJFNVwiLFwiI0ZGQjMwMFwiXX1dfSxvcHRpb25zOntsZWdlbmQ6e2xhYmVsczp7Ym94V2lkdGg6MTIsZm9udFNpemU6MTB9fX19KSxsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJpb3JpdHlDaGFydFwiKSxjPW5ldyBDaGFydChsLHt0eXBlOlwiZG91Z2hudXRcIixkYXRhOntsYWJlbHM6W1wiSGlnaFwiLFwiTWVkaXVtXCIsXCJMb3dcIl0sZGF0YXNldHM6W3tkYXRhOltuLmhpZ2guY291bnQsbi5tZWRpdW0uY291bnQsbi5sb3cuY291bnRdLGJhY2tncm91bmRDb2xvcjpbXCIjRjQ0MzM2XCIsXCIjRkZCMzAwXCIsXCIjNDNBMDQ3XCJdLGhvdmVyQmFja2dyb3VuZENvbG9yOltcIiNGNDQzMzZcIixcIiNGRkIzMDBcIixcIiM0M0EwNDdcIl19XX0sb3B0aW9uczp7bGVnZW5kOntsYWJlbHM6e2JveFdpZHRoOjEyLGZvbnRTaXplOjEwfX19fSk7YW5ndWxhci5lbGVtZW50KG8pLm9uKFwiY2xpY2tcIixmdW5jdGlvbihlKXt2YXIgbj1hLmdldEVsZW1lbnRzQXRFdmVudChlKTtuJiZuLmxlbmd0aD4wJiZuWzBdLl9tb2RlbC5sYWJlbCYmdC5nbyhcImRhc2hib2FyZC10by12aWV3XCIse3R5cGU6XCJzdGF0dXNcIix2YWx1ZTpuWzBdLl9tb2RlbC5sYWJlbH0pfSksYW5ndWxhci5lbGVtZW50KHMpLm9uKFwiY2xpY2tcIixmdW5jdGlvbihlKXt2YXIgbj1yLmdldEVsZW1lbnRzQXRFdmVudChlKTtuJiZuLmxlbmd0aD4wJiZuWzBdLl9tb2RlbC5sYWJlbCYmdC5nbyhcImRhc2hib2FyZC10by12aWV3XCIse3R5cGU6XCJ0eXBlXCIsdmFsdWU6blswXS5fbW9kZWwubGFiZWx9KX0pLGFuZ3VsYXIuZWxlbWVudChsKS5vbihcImNsaWNrXCIsZnVuY3Rpb24oZSl7dmFyIG49Yy5nZXRFbGVtZW50c0F0RXZlbnQoZSk7biYmbi5sZW5ndGg+MCYmblswXS5fbW9kZWwubGFiZWwmJnQuZ28oXCJkYXNoYm9hcmQtdG8tdmlld1wiLHt0eXBlOlwicHJpb3JpdHlcIix2YWx1ZTpuWzBdLl9tb2RlbC5sYWJlbH0pfSl9KS5jYXRjaChmdW5jdGlvbihlKXtuLmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gZmV0Y2ggdGhlIGRhc2hib2FyZCBkYXRhLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLDVlMyl9KX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJEYXNoYm9hcmRUb1ZpZXdDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiWWdOb3RpZnlcIixcIlRpY2tldEZhY3RvcnlcIixmdW5jdGlvbihlLHMsbixvLHQpe2Z1bmN0aW9uIGMoZSl7cmV0dXJuIG5ldyBEYXRlKERhdGUucGFyc2UoZSkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfWZ1bmN0aW9uIGkoZSl7cmV0dXJuIGU/U3RyaW5nKGUpLnJlcGxhY2UoLzxbXj5dKz4vZ20sXCJcIik6XCJcIn1mdW5jdGlvbiByKGUpe3JldHVybiBlP2U6XCJOb25lXCJ9ZS50eXBlPW4udHlwZSxlLnZhbHVlPW4udmFsdWUsZS5jb25maWc9e30sZS5jb25maWcuY29sdW1ucz1bXSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImlkXCIsbmFtZTpcIklEXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJ0aXRsZVwiLG5hbWU6XCJUaXRsZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiZGVzY3JpcHRpb25cIixuYW1lOlwiRGVzY3JpcHRpb25cIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOml9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInR5cGVcIixuYW1lOlwiVHlwZVwiLGNzc0NsYXNzOlwiY29sLW1kLTFcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5Olwic3RhdHVzXCIsbmFtZTpcIlN0YXR1c1wiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwicHJpb3JpdHlcIixuYW1lOlwiUHJpb3JpdHlcIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOnJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImNyZWF0ZWREYXRlXCIsbmFtZTpcIkNyZWF0ZWQgRGF0ZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6Y30pLGUuY29uZmlnLnNvcnRRdWVyeXN0cmluZ1BhcmFtPVwic29ydFwiLGUuY29uZmlnLm9yZGVyUXVlcnlzdHJpbmdQYXJhbT1cIm9yZGVyXCIsZS5jb25maWcucGFnZVF1ZXJ5c3RyaW5nUGFyYW09XCJwYWdlXCIsZS5jb25maWcuc2l6ZVF1ZXJ5c3RyaW5nUGFyYW09XCJzaXplXCIsZS5jb25maWcub25Sb3dDbGljaz1mdW5jdGlvbihlKXtzLmdvKFwidGlja2V0LXZpZXdcIix7aWQ6ZS5pZH0pfSxlLmNvbmZpZy5vYmplY3ROYW1lPVwidGlja2V0c1wiLGUuY29uZmlnLnVybD1cIi9zdXBwb3J0L3RpY2tldHMvXCIrbi50eXBlK1wiL1wiK24udmFsdWV9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiRGVsZXRlQ29tbWVudEN0cmxcIixbXCIkc2NvcGVcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJZZ01vZGFsXCIsXCJBY3Rpb25GYWN0b3J5XCIsZnVuY3Rpb24oZSx0LG4sbyxyKXt2YXIgYz1mdW5jdGlvbihvLGMpe3JldHVybiBmdW5jdGlvbigpe3IuZGVsZXRlQ29tbWVudChvLGMpLnRoZW4oZnVuY3Rpb24obyl7bi5jcmVhdGVGbGFzaE1lc3NhZ2UobyxcIlRoZSBjb21tZW50IHdhcyBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLG8uZGF0YS5lcnJvcnN8fChlLnRpY2tldC5jb21tZW50cz1vLmRhdGEuY29tbWVudHMpfSkuY2F0Y2goZnVuY3Rpb24oZSl7dC5hbGVydChcImRhbmdlclwiLFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGRlbGV0ZSBjb21tZW50LiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLDVlMyl9KX19O2UuZGVsZXRlQ29tbWVudD1mdW5jdGlvbihlLHQpe28uY29uZmlybShjKGUsdCkpLG8ub3BlbihcIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkbyB0aGlzP1wiLFwiVGhpcyB3aWxsIGRlbGV0ZSB0aGUgY29tbWVudCBwZXJtYW5lbnRseVwiKX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiRWRpdFRpY2tldEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiJHN0YXRlXCIsXCJUaWNrZXRGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiSGVscGVyRmFjdG9yeVwiLFwiQXV0aGVudGljYXRpb25cIixmdW5jdGlvbih0LGUsYSxyLGksYyxuKXt0LnRvb2xiYXJDb25maWc9W1tcImgxXCIsXCJwXCIsXCJwcmVcIixcInF1b3RlXCJdLFtcImJvbGRcIixcIml0YWxpY3NcIixcInVuZGVybGluZVwiLFwic3RyaWtlVGhyb3VnaFwiLFwidWxcIixcIm9sXCIsXCJyZWRvXCIsXCJ1bmRvXCIsXCJjbGVhclwiXSxbXSxbXCJpbnNlcnRMaW5rXCJdXSx0LmNhbmNlbD1mdW5jdGlvbigpe2EuZ28oXCJ0aWNrZXQtdmlld1wiLHtpZDp0LnRpY2tldC5pZH0pfSx0LnJlbmRlckRhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBEYXRlKERhdGUucGFyc2UodCkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSxyLmdldFRpY2tldEJ5SWQoZS5pZCkudGhlbihmdW5jdGlvbihlKXtpZihlLmRhdGEuZXJyb3JzKXthLmdvKFwidGlja2V0Lm15LXRpY2tldHNcIik7dmFyIG89Yy5jcmVhdGVFcnJvck1lc3NhZ2UoZS5kYXRhLmVycm9ycyk7by5mb3JFYWNoKGZ1bmN0aW9uKHQpe2kuYWxlcnQoXCJkYW5nZXJcIix0LDVlMyl9KX1lbHNlIHQudGlja2V0PWUuZGF0YS50aWNrZXQsdC50aWNrZXQuY3VycmVudFVzZXI9bi5nZXRVc2VyKCkudXNlcm5hbWUsci5nZXRJbml0aWFsVGlja2V0RGF0YSh0LnRpY2tldC5zdGF0dXMpLnRoZW4oZnVuY3Rpb24oZSl7dC5wcmlvcml0aWVzPWUuZGF0YS5wcmlvcml0aWVzLnZhbHVlcyx0LnR5cGVzPWUuZGF0YS50eXBlcy52YWx1ZXMsdC51c2Vycz1lLmRhdGEudXNlcnMsdC5zdGF0dXNlcz1lLmRhdGEuc3RhdHVzZXN9KS5jYXRjaChmdW5jdGlvbih0KXtjb25zb2xlLmxvZyh0KSxpLmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gZmV0Y2ggdGhlIHN0YXRpYyBkYXRhLlwiLDVlMyl9KX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKHQpLGkuYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBnZXQgdGlja2V0IGRldGFpbHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsNWUzKX0pLHQudXBkYXRlPWZ1bmN0aW9uKCl7ci51cGRhdGVUaWNrZXQodC50aWNrZXQuX2lkLHQudGlja2V0KS50aGVuKGZ1bmN0aW9uKGUpe3QudGlja2V0PWUuZGF0YSxpLmFsZXJ0KFwic3VjY2Vzc1wiLFwiVGlja2V0IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LlwiLDVlMyksYS5nbyhcInRpY2tldC12aWV3XCIse2lkOmUuZGF0YS5pZH0pfSkuY2F0Y2goZnVuY3Rpb24odCl7Y29uc29sZS5sb2codCksaS5hbGVydChcImRhbmdlclwiLFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIHVwZGF0ZSB0aWNrZXQgZGV0YWlscy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiw1ZTMpfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIk5ld1RpY2tldEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiVGlja2V0RmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkNvbW1vbkZhY3RvcnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsaSxjLG4sbyl7bi5nZXRJbml0aWFsU3RhdGljRGF0YSgpLnRoZW4oZnVuY3Rpb24odCl7ZS5uZXdUaWNrZXQudHlwZXM9dC5kYXRhLnR5cGVzLnZhbHVlcyxlLm5ld1RpY2tldC50eXBlPWUubmV3VGlja2V0LnR5cGVzWzBdLnZhbHVlfSksZS5uZXdUaWNrZXQ9e30sZS50b29sYmFyQ29uZmlnPVtbXCJoMVwiLFwicFwiLFwicHJlXCIsXCJxdW90ZVwiXSxbXCJib2xkXCIsXCJpdGFsaWNzXCIsXCJ1bmRlcmxpbmVcIixcInN0cmlrZVRocm91Z2hcIixcInVsXCIsXCJvbFwiLFwicmVkb1wiLFwidW5kb1wiLFwiY2xlYXJcIl0sW10sW1wiaW5zZXJ0TGlua1wiXV0sZS5zYXZlPWZ1bmN0aW9uKCl7cmV0dXJuIGUubmV3VGlja2V0Rm9ybS4kaW52YWxpZD8oZS5uZXdUaWNrZXRGb3JtLnRpdGxlLiR0b3VjaGVkPSEwLHZvaWQoZS5uZXdUaWNrZXRGb3JtLmRlc2NyaXB0aW9uLiR0b3VjaGVkPSEwKSk6dm9pZCBpLmNyZWF0ZU5ld1RpY2tldCh7dGl0bGU6ZS5uZXdUaWNrZXQudGl0bGUsZGVzY3JpcHRpb246ZS5uZXdUaWNrZXQuZGVzY3JpcHRpb24sdHlwZTplLm5ld1RpY2tldC50eXBlfSkudGhlbihmdW5jdGlvbihlKXtvLmNyZWF0ZUZsYXNoTWVzc2FnZShlLFwiVGhlIHRpY2tldCBoYXMgYmVlbiBjcmVhdGVkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2MuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLGUuZGF0YS5pZCYmdC5nbyhcInRpY2tldC12aWV3XCIse2lkOmUuZGF0YS5pZH0pfSxmdW5jdGlvbihlKXtjLmFsZXJ0KFwiZGFuZ2VyXCIsXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gY3JlYXRlIG5ldyB0aWNrZXQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsNWUzKSxjb25zb2xlLmxvZyhlKX0pfX1dKTtcblxuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIlRpY2tldHNDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcImFnU29ydEZhY3RvcnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsbixpKXtlLmlzU3VwcG9ydD0hMTt2YXIgYz1KU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidGlja2V0U3lzdGVtVXNlclwiKSk7YyYmKGMucm9sZS5pbmRleE9mKFwiQWRtaW5cIik+LTF8fGMucm9sZS5pbmRleE9mKFwiU3VwcG9ydFwiKT4tMSkmJihlLmlzU3VwcG9ydD0hMCk7dmFyIHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBEYXRlKERhdGUucGFyc2UoZSkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSxvPWZ1bmN0aW9uKGUpe3JldHVybiBlP1N0cmluZyhlKS5yZXBsYWNlKC88W14+XSs+L2dtLFwiXCIpOlwiXCJ9LHI9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/ZTpcIlVuYXNzaWduZWRcIn07ZS5jb25maWc9e30sZS5jb25maWcuY29sdW1ucz1bXSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImlkXCIsbmFtZTpcIklEXCIsY3NzQ2xhc3M6XCJjb2wtbWQtMVwifSksZS5jb25maWcuY29sdW1ucy5wdXNoKHtrZXk6XCJ0aXRsZVwiLG5hbWU6XCJUaXRsZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiZGVzY3JpcHRpb25cIixuYW1lOlwiRGVzY3JpcHRpb25cIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOm99KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcInR5cGVcIixuYW1lOlwiVHlwZVwiLGNzc0NsYXNzOlwiY29sLW1kLTFcIn0pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiYXNzaWduZWVcIixuYW1lOlwiQXNzaWduZWVcIixjc3NDbGFzczpcImNvbC1tZC0yXCIscmVuZGVyOnJ9KSxlLmNvbmZpZy5jb2x1bW5zLnB1c2goe2tleTpcImNyZWF0ZWREYXRlXCIsbmFtZTpcIkNyZWF0ZWQgRGF0ZVwiLGNzc0NsYXNzOlwiY29sLW1kLTJcIixyZW5kZXI6c30pLGUuY29uZmlnLmNvbHVtbnMucHVzaCh7a2V5OlwiY3JlYXRlZEJ5XCIsbmFtZTpcIkNyZWF0ZWQgQnlcIixjc3NDbGFzczpcImNvbC1tZC0yXCJ9KSxlLmNvbmZpZy5zb3J0UXVlcnlzdHJpbmdQYXJhbT1cInNvcnRcIixlLmNvbmZpZy5vcmRlclF1ZXJ5c3RyaW5nUGFyYW09XCJvcmRlclwiLGUuY29uZmlnLnBhZ2VRdWVyeXN0cmluZ1BhcmFtPVwicGFnZVwiLGUuY29uZmlnLnNpemVRdWVyeXN0cmluZ1BhcmFtPVwic2l6ZVwiLGUuY29uZmlnLm9uUm93Q2xpY2s9ZnVuY3Rpb24oZSl7dC5nbyhcInRpY2tldC12aWV3XCIse2lkOmUuaWR9KX0sZS5jb25maWcub2JqZWN0TmFtZT1cInRpY2tldHNcIixlLmluaXRpYXRlQWxsVGlja2V0PWZ1bmN0aW9uKCl7ZS5jb25maWcudXJsPVwiL3RpY2tldHMvYWxsXCIsZS4kcGFyZW50LmFjdGl2ZT1cImFsbFwifSxlLmluaXRpYXRlTXlUaWNrZXQ9ZnVuY3Rpb24oKXtlLmNvbmZpZy51cmw9XCIvdGlja2V0cy9teVwiLGUuJHBhcmVudC5hY3RpdmU9XCJteVwifSxlLmluaXRpYXRlVG9NZVRpY2tldD1mdW5jdGlvbigpe2UuY29uZmlnLnVybD1cIi90aWNrZXRzL3RvLW1lXCIsZS4kcGFyZW50LmFjdGl2ZT1cInRvbWVcIn19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiVmlld1RpY2tldEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiJHN0YXRlXCIsXCJUaWNrZXRGYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiQXV0aGVudGljYXRpb25cIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQscixpLG4scyxhKXtmdW5jdGlvbiBjKGUsdCl7c3dpdGNoKGU9ZXx8XCJcIix0LnN1Y2Nlc3M9dC5zdWNjZXNzfHxcIlwiLHQud2FybmluZz10Lndhcm5pbmd8fFwiXCIsdC5kYW5nZXI9dC5kYW5nZXJ8fFwiXCIsdC5pbmZvPXQuaW5mb3x8XCJcIixlLnRvTG93ZXJDYXNlKCkpe2Nhc2UgdC5zdWNjZXNzLnRvTG93ZXJDYXNlKCk6cmV0dXJuXCJzdWNjZXNzXCI7Y2FzZSB0Lndhcm5pbmcudG9Mb3dlckNhc2UoKTpyZXR1cm5cIndhcm5pbmdcIjtjYXNlIHQuZGFuZ2VyLnRvTG93ZXJDYXNlKCk6cmV0dXJuXCJkYW5nZXJcIjtjYXNlIHQuaW5mby50b0xvd2VyQ2FzZSgpOnJldHVyblwiaW5mb1wiO2RlZmF1bHQ6cmV0dXJuXCJpbmZvXCJ9fWZ1bmN0aW9uIG8oZSl7cmV0dXJuIGMoZSx7c3VjY2VzczpcImluLXByb2dyZXNzXCIsd2FybmluZzpcIm9wZW5cIixpbmZvOlwibmV3XCIsZGFuZ2VyOlwicmVzb2x2ZWRcIn0pfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIGMoZSx7c3VjY2VzczpcImxvd1wiLHdhcm5pbmc6XCJtZWRpdW1cIixkYW5nZXI6XCJoaWdoXCJ9KX1mdW5jdGlvbiBkKGUpe3JldHVybiBlLmFzc2lnbmVlPT09ZS5jdXJyZW50VXNlcnx8KGUuY3JlYXRlZEJ5PT09ZS5jdXJyZW50VXNlcnx8KCEhYS5pc0N1cnJlbnRVc2VyQWRtaW4oKXx8ISFhLmlzQ3VycmVudFVzZXJTdXBwb3J0KCkpKX1pLmdldFRpY2tldEJ5SWQodC5pZCkudGhlbihmdW5jdGlvbih0KXthLmNyZWF0ZUZsYXNoTWVzc2FnZSh0KS5mb3JFYWNoKGZ1bmN0aW9uKGUpe24uYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLHQuZGF0YS5lcnJvcnN8fChlLnRpY2tldD10LmRhdGEudGlja2V0LGUudGlja2V0LmRlc2NyaXB0aW9uPWEuc3RyaXBIdG1sKGUudGlja2V0LmRlc2NyaXB0aW9uKSxlLnRpY2tldC5hc3NpZ25lZT1lLnRpY2tldC5hc3NpZ25lZT9lLnRpY2tldC5hc3NpZ25lZTpcIlVuYXNzaWduZWRcIixlLnRpY2tldC5jcmVhdGVkRGF0ZT1lLnJlbmRlckRhdGUoZS50aWNrZXQuY3JlYXRlZERhdGUpLGUudGlja2V0LmN1cnJlbnRVc2VyPXMuZ2V0VXNlcigpLnVzZXJuYW1lLGUuc3RhdHVzQ2xhc3M9byhlLnRpY2tldC5zdGF0dXMpLGUudGlja2V0LnByaW9yaXR5PWUudGlja2V0LnByaW9yaXR5fHxcIk4uQVwiLGUucHJpb3JpdHlDbGFzcz11KGUudGlja2V0LnByaW9yaXR5KSxkKGUudGlja2V0KSYmKGUuc2hvd0VkaXQ9ITApKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe24uYWxlcnQoXCJkYW5nZXJcIixcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHRyeWluZyB0byBnZXQgdGlja2V0IGRldGFpbHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsNWUzKX0pLGUudGlja2V0PXt9LGUuZWRpdD1mdW5jdGlvbigpe3IuZ28oXCJ0aWNrZXQtZWRpdFwiLHtpZDplLnRpY2tldC5pZH0pfSxlLnJlbmRlckRhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBEYXRlKERhdGUucGFyc2UoZSkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJDaGFuZ2VQYXNzd29yZEN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiJHN0YXRlUGFyYW1zXCIsXCJVc2VyRmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixmdW5jdGlvbihlLHMsYSxyLG8sdCl7ZS5jaGFuZ2VQYXNzd29yZD17fSxlLmNoYW5nZVBhc3N3b3JkLnRpdGxlPVwiQ2hhbmdlIFBhc3N3b3JkXCIsZS5jaGFuZ2VQYXNzd29yZC5zYXZlVGl0bGU9XCJDaGFuZ2UgUGFzc3dvcmRcIixlLmNoYW5nZVBhc3N3b3JkLmNhbmNlbEhyZWY9XCIjL3VzZXJzL3Byb2ZpbGVcIixlLmNoYW5nZVBhc3N3b3JkLnNhdmU9ZnVuY3Rpb24oYyl7aWYoYy4kaW52YWxpZClyZXR1cm4gYy5wYXNzd29yZDIuJHRvdWNoZWQ9ITAsdm9pZChjLnBhc3N3b3JkMS4kdG91Y2hlZD0hMCk7dmFyIG49YS5pZDtyLmNoYW5nZVBhc3N3b3JkKG4sZS5jaGFuZ2VQYXNzd29yZCkudGhlbihmdW5jdGlvbihlKXtvLmNyZWF0ZUZsYXNoTWVzc2FnZShlLFwiVGhlIHBhc3N3b3JkIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksZS5kYXRhLmVycm9yc3x8cy5nbyhcInVzZXJzLXByb2ZpbGVcIil9KS5jYXRjaChmdW5jdGlvbihlKXt0LmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGUgcmVxdWVzdCBjb3VsZCBub3QgYmVuIG1hZGUgc3VjY2Vzc2Z1bGx5LiBQbGVhc2UgdHJ5IGxhdGVyXCIsNWUzKX0pfX1dKTtcbmFuZ3VsYXIubW9kdWxlKFwidGlja2V0U3lzdGVtXCIpLmNvbnRyb2xsZXIoXCJMb2dpbkN0cmxcIixbXCIkc2NvcGVcIixcIiRzdGF0ZVwiLFwiJHdpbmRvd1wiLFwiVXNlckZhY3RvcnlcIixcIkF1dGhlbnRpY2F0aW9uXCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LG8scixpLG4pe2kuZ2V0VXNlcigpJiZ0LmdvKFwidGlja2V0Lm15LXRpY2tldHNcIiksZS5lcnJvcj0hMSxlLm1lc3NhZ2U9XCJcIixlLmxvZ2luPWZ1bmN0aW9uKCl7ci5sb2dpbihlLnVzZXJuYW1lLGUucGFzc3dvcmQsZS5yZW1lbWJlcikudGhlbihmdW5jdGlvbihvKXtvLmRhdGEuaXNBdXRoZW50aWNhdGVkPyhpLnNldFVzZXIoby5kYXRhLnVzZXIpLGUuJGVtaXQoXCJzdWNjZXNzZnVsLWxvZ2luXCIpLG4uaXNDdXJyZW50VXNlckFkbWluT3JTdXBwb3J0KCk/dC5nbyhcImRhc2hib2FyZFwiKTp0LmdvKFwidGlja2V0Lm15LXRpY2tldHNcIikpOihlLmVycm9yPSEwLGUubWVzc2FnZT1vLmRhdGEubXNnKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2UuZXJyb3I9ITAsZS5tZXNzYWdlPVwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJ5aW5nIHRvIGxvZyB5b3UgaW4uIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXJcIn0pfSxlLmdvb2dsZUxvZ2luPWZ1bmN0aW9uKCl7dmFyIGU9XCJhY2NvdW50cy9hdXRoL2dvb2dsZVwiLHQ9NjAwLHI9NDUwLGk9KHdpbmRvdy5vdXRlckhlaWdodC1yKS8yLG49KHdpbmRvdy5vdXRlcldpZHRoLXQpLzI7by5vcGVuKGUsXCJmYWNlYm9va19sb2dpblwiLFwid2lkdGg9XCIrdCtcIixoZWlnaHQ9XCIrcitcIixzY3JvbGxiYXJzPTAsdG9wPVwiK2krXCIsbGVmdD1cIituKX19XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiTWFpbkxvZ2luQ3RybFwiLFtcIiRyb290U2NvcGVcIixcIiRzY29wZVwiLFwiJHN0YXRlXCIsZnVuY3Rpb24odCxlLG4pe2Uuc3RhdGVuYW1lPW4uY3VycmVudC5uYW1lLHQuJG9uKFwiJHN0YXRlQ2hhbmdlU3RhcnRcIixmdW5jdGlvbih0LG4sYSxvLHIpe2Uuc3RhdGVuYW1lPW4ubmFtZX0pfV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIlByb2ZpbGVDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVcIixcIkF1dGhlbnRpY2F0aW9uXCIsXCJVc2VyRmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixmdW5jdGlvbihlLGEscixzLHQsdSl7ZS51c2VyPXt9LGUuaW5pdD1mdW5jdGlvbigpe3MuZ2V0VXNlckJ5VXNlcm5hbWUoci5nZXRVc2VyKCkudXNlcm5hbWUpLnRoZW4oZnVuY3Rpb24oYSl7dC5jcmVhdGVGbGFzaE1lc3NhZ2UoYSkuZm9yRWFjaChmdW5jdGlvbihlKXt1LmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxhLmRhdGEuZXJyb3JzfHwoZS51c2VyLmZpcnN0bmFtZT1hLmRhdGEudXNlci5maXJzdG5hbWUsZS51c2VyLmxhc3RuYW1lPWEuZGF0YS51c2VyLmxhc3RuYW1lLGUudXNlci51c2VybmFtZT1hLmRhdGEudXNlci51c2VybmFtZSxlLnVzZXIuZW1haWw9YS5kYXRhLnVzZXIuZW1haWwsZS51c2VyLnVzZXJJZD1hLmRhdGEudXNlci5faWQpfSl9LGUudXBkYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIGUucHJvZmlsZUZvcm0uJGludmFsaWQ/KGUucHJvZmlsZUZvcm0uZmlyc3RuYW1lLiR0b3VjaGVkPSEwLGUucHJvZmlsZUZvcm0ubGFzdG5hbWUuJHRvdWNoZWQ9ITAsdm9pZChlLnByb2ZpbGVGb3JtLmVtYWlsLiR0b3VjaGVkPSEwKSk6KHQuc2V0TG9hZGluZyghMCksdm9pZCBzLnVwZGF0ZVByb2ZpbGUoZS51c2VyKS50aGVuKGZ1bmN0aW9uKGEpe3QuY3JlYXRlRmxhc2hNZXNzYWdlKGEsXCJVc2VyIGRldGFpbHMgaGF2ZSBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7dS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksYS5kYXRhLmVycm9yc3x8KGUudXNlci5maXJzdG5hbWU9YS5kYXRhLnVzZXIuZmlyc3RuYW1lLGUudXNlci5sYXN0bmFtZT1hLmRhdGEudXNlci5sYXN0bmFtZSxlLnVzZXIudXNlcm5hbWU9YS5kYXRhLnVzZXIudXNlcm5hbWUsZS51c2VyLmVtYWlsPWEuZGF0YS51c2VyLmVtYWlsLGUudXNlci5yb2xlPWEuZGF0YS51c2VyLnJvbGUsci5zZXRVc2VyKGUudXNlcikpfSkuY2F0Y2goZnVuY3Rpb24oZSl7dS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIHVwZGF0ZSB1c2VyIGRldGFpbHMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyl9KSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIlJlZ2lzdGVyQ3RybFwiLFtcIiRzY29wZVwiLFwiJHN0YXRlXCIsXCJVc2VyRmFjdG9yeVwiLFwiSGVscGVyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixmdW5jdGlvbihlLHIsdCxzLGEpe2UubmV3VXNlcj17fSxlLnJlZ2lzdGVyPWZ1bmN0aW9uKCl7dC5yZWdpc3RlclVzZXIoZS5uZXdVc2VyKS50aGVuKGZ1bmN0aW9uKGUpe3MuY3JlYXRlRmxhc2hNZXNzYWdlKGUsXCJVc2VyIGhhcyBiZWVuIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LiBZb3UgY2FuIG5vdyBsb2dpbi5cIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmRhdGEuZXJyb3JzJiZyLmdvKFwidXNlcnMtbG9naW4ubG9naW5cIil9KS5jYXRjaChmdW5jdGlvbihlKXthLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gY3JlYXRlIHRoZSB1c2VyLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIlNldFVzZXJDdHJsXCIsW1wiJHNjb3BlXCIsXCIkc3RhdGVQYXJhbXNcIixcIiRzdGF0ZVwiLFwiVXNlckZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKGUscyx0LGEscixuKXt2YXIgYz1zLmlkLG89cy5lbWFpbDtlLnNldFVzZXJuYW1lPXt9LGUuc2V0VXNlcm5hbWUuZW1haWw9byxlLnNhdmVVc2VybmFtZT1mdW5jdGlvbigpe2Euc2V0VXNlcm5hbWUoe2lkOmMsdXNlcm5hbWU6ZS5zZXRVc2VybmFtZS51c2VybmFtZX0pLnRoZW4oZnVuY3Rpb24ocyl7SGVscGVyRmFjdG9yeS5jcmVhdGVGbGFzaE1lc3NhZ2UocyxcIlVzZXJuYW1lIGhhcyBiZWVuIHNldCBzdWNjZXNzZnVsbHkuXCIpLmZvckVhY2goZnVuY3Rpb24oZSl7ci5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSkscy5kYXRhLmVycm9yc3x8KG4uc2V0VXNlcihzLmRhdGEudXNlciksZS4kZW1pdChcInN1Y2Nlc3NmdWwtbG9naW5cIiksdC5nbyhcInRpY2tldC5teS10aWNrZXRzXCIpKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe3IuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBzZXQgdGhlIHVzZXJuYW1lLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpfSl9fV0pO1xuYW5ndWxhci5tb2R1bGUoXCJ0aWNrZXRTeXN0ZW1cIikuY29udHJvbGxlcihcIkFjdGlvbnNDdHJsXCIsW1wiJHNjb3BlXCIsXCJBY3Rpb25GYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJVc2VyRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIiRyb290U2NvcGVcIixmdW5jdGlvbihlLHQsYSxzLG4sYyl7ZS5nZXRUYXNrPXQuZ2V0VGFzayxlLnRhc2s9e30scy5nZXRBbGxVc2VyRGV0YWlscygpLnRoZW4oZnVuY3Rpb24odCl7dmFyIGE9dC5kYXRhLnVzZXJzO2UudGFzay5hbGxVc2Vycz1hLGUudGFzay5ub3RpZnlVc2Vycz1bXSxlLnRhc2subXVsdGlzZWxlY3RPcHRpb25zPXtzbWFydEJ1dHRvbk1heEl0ZW1zOjQsZGlzcGxheVByb3A6XCJ1c2VybmFtZVwiLGlkUHJvcDpcInVzZXJuYW1lXCJ9fSkuY2F0Y2goZnVuY3Rpb24oZSl7bi5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGdldCB0aGUgbGlzdCBvZiBhbGwgdGhlIHVzZXJzLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpfSksZS50YXNrLnNob3dUYXNrUGFuZWw9ITEsZS50YXNrLnNob3dNYWluUGFuZWw9ITEsdC5zZXRUYXNrKG51bGwpLGUuc2V0U2F2ZUZuPWZ1bmN0aW9uKHQpe2Uuc2F2ZVRhc2s9dH0sZS5jYW5jZWxUYXNrPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKG51bGwpLGUudGFzay5jb21tZW50PVwiXCIsZS50YXNrLnNob3dUYXNrUGFuZWw9ITEsZS50YXNrLnNob3dNYWluUGFuZWw9ITF9LGUuc2V0U2F2ZUJ0bk5hbWU9ZnVuY3Rpb24odCl7ZS5zYXZlQnRuTmFtZT10fSxlLiR3YXRjaChcImdldFRhc2soKVwiLGZ1bmN0aW9uKHQsYSl7aWYoZS50YXNrLm5hbWU9bnVsbCx0KXN3aXRjaChlLnRhc2suc2hvd1Rhc2tQYW5lbD0hMCxlLnRhc2suc2hvd01haW5QYW5lbD0hMCxlLnRhc2submFtZT1cInRlbXBsYXRlcy9wYXJ0aWFscy9hY3Rpb24vXCIrdCtcIi1hY3Rpb24tcGFydGlhbC5odG1sXCIsdCl7Y2FzZVwiY29tbWVudFwiOmUudGFzay50aXRsZT1cIkFkZCBuZXcgY29tbWVudFwiO2JyZWFrO2Nhc2VcImF3YWl0aW5ndXNlcnNyZXNwb25zZVwiOmUudGFzay50aXRsZT1cIkF3YWl0aW5nIHVzZXJzIHJlc3BvbnNlXCI7YnJlYWs7Y2FzZVwiY2xvc2VcIjplLnRhc2sudGl0bGU9XCJDbG9zZSB0aWNrZXRcIjticmVhaztjYXNlXCJyZW9wZW5cIjplLnRhc2sudGl0bGU9XCJSZW9wZW4gdGlja2V0XCI7YnJlYWs7Y2FzZVwiYWNrbm93bGVkZ2VcIjplLnRhc2sudGl0bGU9XCJBY2tub3dsZWRnZSB0aWNrZXRcIjticmVhaztjYXNlXCJhc3NpZ25cIjplLnRhc2sudGl0bGU9XCJBc3NpZ24gdGlja2V0XCI7YnJlYWs7Y2FzZVwiY2hhbmdlc3RhdHVzXCI6ZS50YXNrLnRpdGxlPVwiQ2hhbmdlIHRpY2tldCBzdGF0dXNcIjticmVhaztjYXNlXCJhc3NpZ250b3NlbGZcIjplLnRhc2sudGl0bGU9XCJBc3NpZ24gdG8gc2VsZlwifX0pfV0pLmNvbnRyb2xsZXIoXCJBc3NpZ25BY3Rpb25DdHJsXCIsW1wiJHNjb3BlXCIsXCJBY3Rpb25GYWN0b3J5XCIsXCJZZ05vdGlmeVwiLFwiSGVscGVyRmFjdG9yeVwiLGZ1bmN0aW9uKGUsdCxhLHMpe2NvbnNvbGUubG9nKFwic2V0IGFzc2lnbmVlXCIpLHQuZ2V0QXNzaWduZWVzKCkudGhlbihmdW5jdGlvbih0KXtlLnVzZXJzPXQuZGF0YS51c2VycyxlLnVzZXJzPXMucmVtb3ZlVXNlckZyb21Vc2VycyhlLnVzZXJzLFtlLnRpY2tldC5jcmVhdGVkQnksZS50aWNrZXQuYXNzaWduZWVdKSxlLmFzc2lnbmVlPWUudXNlcnNbMF0udXNlcm5hbWV9KSxlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZHx8ZS5hY3Rpb25Gb3JtLmFzc2lnbmVlLiRpbnZhbGlkPyhlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCx2b2lkKGUuYWN0aW9uRm9ybS5hc3NpZ25lZS4kdG91Y2hlZD0hMCkpOihjb25zb2xlLmxvZyhlLnRhc2subm90aWZ5VXNlcnMpLHZvaWQgdC5hc3NpZ24oZS50aWNrZXQuaWQsZS5hc3NpZ25lZSxlLnRhc2suY29tbWVudCxlLnRhc2subm90aWZ5VXNlcnMpLnRoZW4oZnVuY3Rpb24odCl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBhc3NpZ25lZSBoYXMgYmVlbiBjaGFuZ2VkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLHQuZGF0YS5jb21tZW50cyYmKGUudGlja2V0LmNvbW1lbnRzPXQuZGF0YS5jb21tZW50cyxlLnRpY2tldC5hc3NpZ25lZT10LmRhdGEuYXNzaWduZWUpLGUuY2FuY2VsVGFzaygpfSkuY2F0Y2goZnVuY3Rpb24odCl7YS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGFzc2lnbiB0aGUgdGlja2V0LiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSkpfSksZS5zZXRTYXZlQnRuTmFtZShcIkFzc2lnbiBUaWNrZXRcIil9XSkuY29udHJvbGxlcihcIkNoYW5nZVN0YXR1c0FjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7dmFyIG49ZS50aWNrZXQuc3RhdHVzO3QuZ2V0QWxsb3dlZFN0YXR1cyhuKS50aGVuKGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKHQuZGF0YSksZS5hbGxvd2VkU3RhdHVzPXQuZGF0YS5zdGF0dXMuYWxsb3dlZCxlLm5ld1N0YXR1cz1lLmFsbG93ZWRTdGF0dXNbMF19KSxlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZHx8ZS5hY3Rpb25Gb3JtLm5ld1N0YXR1cy4kaW52YWxpZD8oZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJHRvdWNoZWQ9ITAsdm9pZChlLmFjdGlvbkZvcm0ubmV3U3RhdHVzLiR0b3VjaGVkPSEwKSk6dm9pZCB0LmNoYW5nZVN0YXR1cyhlLnRpY2tldC5pZCxlLm5ld1N0YXR1cyxlLnRhc2suY29tbWVudCxlLnRhc2subm90aWZ5VXNlcnMpLnRoZW4oZnVuY3Rpb24odCl7ZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLGUudGlja2V0LnN0YXR1cz10LmRhdGEuc3RhdHVzLHMuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgc3RhdHVzIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7YS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksZS5jYW5jZWxUYXNrKCl9KS5jYXRjaChmdW5jdGlvbih0KXthLmFsZXJ0KFwiZGFuZ2VyXCIsXCJUaGVyZSB3YXMgc29tZSBlcnJvciB0cnlpbmcgdG8gY2hhbmdlIHRoZSB0aWNrZXQgc3RhdHVzLiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQ2hhbmdlIFN0YXR1c1wiKX1dKS5jb250cm9sbGVyKFwiQ29tbWVudEFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtyZXR1cm4gZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQ/dm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk6dm9pZCB0LmFkZENvbW1lbnQoZS50aWNrZXQuaWQsZS50YXNrLmNvbW1lbnQpLnRoZW4oZnVuY3Rpb24odCl7ZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLHMuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgY29tbWVudCBoYXMgYmVlbiBhZGRlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBhZGQgY29tbWVudC4gUGxlYXNlIHRyeSBhZ2FpbiBhZnRlciBzb21lIHRpbWUuXCIsNWUzKSxlLmNhbmNlbFRhc2soKX0pfSksZS5zZXRTYXZlQnRuTmFtZShcIkFkZCBDb21tZW50XCIpfV0pLmNvbnRyb2xsZXIoXCJDbG9zZUFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtyZXR1cm4gZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQ/dm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk6dm9pZCB0LmNsb3NlKGUudGlja2V0LmlkLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJDbG9zZVwiKX1dKS5jb250cm9sbGVyKFwiUmVvcGVuQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQucmVvcGVuKGUudGlja2V0LmlkLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJSZW9wZW5cIil9XSkuY29udHJvbGxlcihcIkF3YWl0aW5nQWN0aW9uQ3RybFwiLFtcIiRzY29wZVwiLFwiQWN0aW9uRmFjdG9yeVwiLFwiWWdOb3RpZnlcIixcIkhlbHBlckZhY3RvcnlcIixmdW5jdGlvbihlLHQsYSxzKXtlLnNldFNhdmVGbihmdW5jdGlvbigpe3JldHVybiBlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZD92b2lkKGUuYWN0aW9uRm9ybS5jb21tZW50LiR0b3VjaGVkPSEwKTp2b2lkIHQuYXdhaXRpbmdVc2VyUmVzcG9uc2UoZS50aWNrZXQuaWQsZS50YXNrLmNvbW1lbnQsZS50YXNrLm5vdGlmeVVzZXJzKS50aGVuKGZ1bmN0aW9uKHQpe3MuY3JlYXRlRmxhc2hNZXNzYWdlKHQsXCJUaGUgc3RhdHVzIGhhcyBiZWVuIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5XCIpLmZvckVhY2goZnVuY3Rpb24oZSl7YS5hbGVydChlLmNsYXNzLGUubWVzc2FnZSw1ZTMpfSksdC5kYXRhLmNvbW1lbnRzJiYoZS50aWNrZXQuY29tbWVudHM9dC5kYXRhLmNvbW1lbnRzLGUudGlja2V0LnN0YXR1cz10LmRhdGEuc3RhdHVzKSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJDaGFuZ2UgU3RhdHVzXCIpfV0pLmNvbnRyb2xsZXIoXCJBY2tub3dsZWRnZUFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24oZSx0LGEscyl7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtyZXR1cm4gZS5hY3Rpb25Gb3JtLmNvbW1lbnQuJGludmFsaWQ/dm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk6dm9pZCB0LmFja25vd2xlZGdlVGlja2V0KGUudGlja2V0LmlkLGUudGFzay5jb21tZW50LGUudGFzay5ub3RpZnlVc2VycykudGhlbihmdW5jdGlvbih0KXtlLnRpY2tldC5jb21tZW50cz10LmRhdGEuY29tbWVudHMsZS50aWNrZXQuc3RhdHVzPXQuZGF0YS5zdGF0dXMscy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBzdGF0dXMgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIikuZm9yRWFjaChmdW5jdGlvbihlKXthLmFsZXJ0KGUuY2xhc3MsZS5tZXNzYWdlLDVlMyl9KSxlLmNhbmNlbFRhc2soKX0pLmNhdGNoKGZ1bmN0aW9uKHQpe2EuYWxlcnQoXCJkYW5nZXJcIixcIlRoZXJlIHdhcyBzb21lIGVycm9yIHRyeWluZyB0byBjaGFuZ2UgdGhlIHRpY2tldCBzdGF0dXMuIFBsZWFzZSB0cnkgYWdhaW4gYWZ0ZXIgc29tZSB0aW1lLlwiLDVlMyksZS5jYW5jZWxUYXNrKCl9KX0pLGUuc2V0U2F2ZUJ0bk5hbWUoXCJBY2tub3dsZWRnZSBUaWNrZXRcIil9XSkuY29udHJvbGxlcihcIkFzc2lnblRvU2VsZkFjdGlvbkN0cmxcIixbXCIkc2NvcGVcIixcIkFjdGlvbkZhY3RvcnlcIixcIllnTm90aWZ5XCIsXCJIZWxwZXJGYWN0b3J5XCIsXCJBdXRoZW50aWNhdGlvblwiLGZ1bmN0aW9uKGUsdCxhLHMsbil7ZS5zZXRTYXZlRm4oZnVuY3Rpb24oKXtpZihlLmFjdGlvbkZvcm0uY29tbWVudC4kaW52YWxpZClyZXR1cm4gdm9pZChlLmFjdGlvbkZvcm0uY29tbWVudC4kdG91Y2hlZD0hMCk7dmFyIGM9bi5nZXRVc2VyKCk7Y29uc29sZS5sb2coYyksdC5hc3NpZ24oZS50aWNrZXQuaWQsYy51c2VybmFtZSxlLnRhc2suY29tbWVudCxlLnRhc2subm90aWZ5VXNlcnMpLnRoZW4oZnVuY3Rpb24odCl7cy5jcmVhdGVGbGFzaE1lc3NhZ2UodCxcIlRoZSBhc3NpZ25lZSBoYXMgYmVlbiBjaGFuZ2VkIHN1Y2Nlc3NmdWxseVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2EuYWxlcnQoZS5jbGFzcyxlLm1lc3NhZ2UsNWUzKX0pLHQuZGF0YS5jb21tZW50cyYmKGUudGlja2V0LmNvbW1lbnRzPXQuZGF0YS5jb21tZW50cyxlLnRpY2tldC5hc3NpZ25lZT10LmRhdGEuYXNzaWduZWUpLGUuY2FuY2VsVGFzaygpfSkuY2F0Y2goZnVuY3Rpb24odCl7YS5hbGVydChcImRhbmdlclwiLFwiVGhlcmUgd2FzIHNvbWUgZXJyb3IgdHJ5aW5nIHRvIGFzc2lnbiB0aGUgdGlja2V0LiBQbGVhc2UgdHJ5IGFnYWluIGFmdGVyIHNvbWUgdGltZS5cIiw1ZTMpLGUuY2FuY2VsVGFzaygpfSl9KSxlLnNldFNhdmVCdG5OYW1lKFwiQXNzaWduIFRvIFNlbGZcIil9XSk7XG5hbmd1bGFyLm1vZHVsZShcInRpY2tldFN5c3RlbVwiKS5jb250cm9sbGVyKFwiQnV0dG9uR3JvdXBDdHJsXCIsW1wiJHNjb3BlXCIsXCJBY3Rpb25GYWN0b3J5XCIsXCJIZWxwZXJGYWN0b3J5XCIsZnVuY3Rpb24obyx0LG4pe28uYnV0dG9uZ3JvdXA9e30sby4kd2F0Y2hDb2xsZWN0aW9uKFwidGlja2V0XCIsZnVuY3Rpb24ocyl7cyYmIW4uaXNOdWxsT3JVbmRlZmluZWQocy5pZCkmJihuLmlzQ3VycmVudFVzZXJBZG1pbk9yU3VwcG9ydCgpP3QuZ2V0QWxsb3dlZEJ1dHRvbnMocy5pZCkudGhlbihmdW5jdGlvbih0KXtvLmJ1dHRvbmdyb3VwLnNob3dBc3NpZ249dC5hc3NpZ24sby5idXR0b25ncm91cC5zaG93Q29tbWVudD10LmNvbW1lbnQsby5idXR0b25ncm91cC5zaG93Y2hhbmdlU3RhdHVzPXQuY2hhbmdlU3RhdHVzLG8uYnV0dG9uZ3JvdXAuc2hvd1Jlb3Blbj10LnJlb3BlbixvLmJ1dHRvbmdyb3VwLnNob3dDbG9zZT10LmNsb3NlLG8uYnV0dG9uZ3JvdXAuc2hvd0Fja25vd2xlZGdlPXQuYWNrbm93bGVkZ2Usby5idXR0b25ncm91cC5zaG93QXdhaXRpbmdVc2Vyc1Jlc3BvbnNlPXQuYXdhaXRpbmdVc2VyUmVzcG9uc2Usby5idXR0b25ncm91cC5zaG93QXNzaWduVG9TZWxmPXQuYXNzaWduVG9TZWxmfSk6KG8uYnV0dG9uZ3JvdXAuc2hvd0Fzc2lnbj0hMSxvLmJ1dHRvbmdyb3VwLnNob3dDb21tZW50PSExLG8uYnV0dG9uZ3JvdXAuc2hvd2NoYW5nZVN0YXR1cz0hMSxvLmJ1dHRvbmdyb3VwLnNob3dSZW9wZW49ITEsby5idXR0b25ncm91cC5zaG93Q2xvc2U9ITEsby5idXR0b25ncm91cC5zaG93QWNrbm93bGVkZ2U9ITEsby5idXR0b25ncm91cC5zaG93QXdhaXRpbmdVc2Vyc1Jlc3BvbnNlPSExLG8uYnV0dG9uZ3JvdXAuc2hvd0Fzc2lnblRvU2VsZj0hMSkpfSksby5idXR0b25ncm91cC5jb21tZW50PWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiY29tbWVudFwiKX0sby5idXR0b25ncm91cC5hc3NpZ249ZnVuY3Rpb24oKXt0LnNldFRhc2soXCJhc3NpZ25cIil9LG8uYnV0dG9uZ3JvdXAuY2hhbmdlU3RhdHVzPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiY2hhbmdlc3RhdHVzXCIpfSxvLmJ1dHRvbmdyb3VwLmNsb3NlPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiY2xvc2VcIil9LG8uYnV0dG9uZ3JvdXAucmVvcGVuPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwicmVvcGVuXCIpfSxvLmJ1dHRvbmdyb3VwLmFja25vd2xlZGdlPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiYWNrbm93bGVkZ2VcIil9LG8uYnV0dG9uZ3JvdXAuYXdhaXRpbmd1c2Vyc3Jlc3BvbnNlPWZ1bmN0aW9uKCl7dC5zZXRUYXNrKFwiYXdhaXRpbmd1c2Vyc3Jlc3BvbnNlXCIpfSxvLmJ1dHRvbmdyb3VwLmFzc2lnblRvU2VsZj1mdW5jdGlvbigpe3Quc2V0VGFzayhcImFzc2lnbnRvc2VsZlwiKX19XSk7Il0sImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
